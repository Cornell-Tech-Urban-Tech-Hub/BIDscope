const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["_astro/index.BnauiKoP.js","_astro/webgl-device.DkQLLCya.js","_astro/index.6otl1p8d.js","_astro/index.Bg-cVQ5Q.js","_astro/maplibre-gl.BIyHGNM8.js"])))=>i.map(i=>d[i]);
import{j as nt}from"./jsx-runtime.D_zvdyIk.js";import{g as Sa,r as Re}from"./index.6otl1p8d.js";import"./client.B0vVpQx7.js";/* empty css                       */const Ta="modulepreload",La=function(u){return"/"+u},vr={},vn=function(a,l,c){let o=Promise.resolve();if(l&&l.length>0){let p=function(x){return Promise.all(x.map(w=>Promise.resolve(w).then(N=>({status:"fulfilled",value:N}),N=>({status:"rejected",reason:N}))))};document.getElementsByTagName("link");const g=document.querySelector("meta[property=csp-nonce]"),C=g?.nonce||g?.getAttribute("nonce");o=p(l.map(x=>{if(x=La(x),x in vr)return;vr[x]=!0;const w=x.endsWith(".css"),N=w?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${x}"]${N}`))return;const D=document.createElement("link");if(D.rel=w?"stylesheet":Ta,w||(D.as="script"),D.crossOrigin="",D.href=x,C&&D.setAttribute("nonce",C),document.head.appendChild(D),w)return new Promise((B,b)=>{D.addEventListener("load",B),D.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${x}`)))})}))}function d(p){const g=new Event("vite:preloadError",{cancelable:!0});if(g.payload=p,window.dispatchEvent(g),!g.defaultPrevented)throw p}return o.then(p=>{for(const g of p||[])g.status==="rejected"&&d(g.reason);return a().catch(d)})};var Ge=63710088e-1,Hr={centimeters:Ge*100,centimetres:Ge*100,degrees:360/(2*Math.PI),feet:Ge*3.28084,inches:Ge*39.37,kilometers:Ge/1e3,kilometres:Ge/1e3,meters:Ge,metres:Ge,miles:Ge/1609.344,millimeters:Ge*1e3,millimetres:Ge*1e3,nauticalmiles:Ge/1852,radians:1,yards:Ge*1.0936};function Bt(u,a,l={}){const c={type:"Feature"};return(l.id===0||l.id)&&(c.id=l.id),l.bbox&&(c.bbox=l.bbox),c.properties=a||{},c.geometry=u,c}function Ca(u,a,l={}){if(!u)throw new Error("coordinates is required");if(!Array.isArray(u))throw new Error("coordinates must be an Array");if(u.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!_r(u[0])||!_r(u[1]))throw new Error("coordinates must contain numbers");return Bt({type:"Point",coordinates:u},a,l)}function Ra(u,a,l={}){for(const o of u){if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(o[o.length-1].length!==o[0].length)throw new Error("First and last Position are not equivalent.");for(let d=0;d<o[o.length-1].length;d++)if(o[o.length-1][d]!==o[0][d])throw new Error("First and last Position are not equivalent.")}return Bt({type:"Polygon",coordinates:u},a,l)}function pr(u,a,l={}){if(u.length<2)throw new Error("coordinates must be an array of two or more positions");return Bt({type:"LineString",coordinates:u},a,l)}function ci(u,a={}){const l={type:"FeatureCollection"};return a.id&&(l.id=a.id),a.bbox&&(l.bbox=a.bbox),l.features=u,l}function Oa(u,a,l={}){return Bt({type:"MultiLineString",coordinates:u},a,l)}function ba(u,a,l={}){return Bt({type:"MultiPolygon",coordinates:u},a,l)}function Ma(u,a="kilometers"){const l=Hr[a];if(!l)throw new Error(a+" units is invalid");return u*l}function Pa(u,a="kilometers"){const l=Hr[a];if(!l)throw new Error(a+" units is invalid");return u/l}function _r(u){return!isNaN(u)&&u!==null&&!Array.isArray(u)}function jr(u,a,l){if(u!==null)for(var c,o,d,p,g,C,x,w=0,N=0,D,B=u.type,b=B==="FeatureCollection",Z=B==="Feature",V=b?u.features.length:1,ee=0;ee<V;ee++){x=b?u.features[ee].geometry:Z?u.geometry:u,D=x?x.type==="GeometryCollection":!1,g=D?x.geometries.length:1;for(var q=0;q<g;q++){var U=0,j=0;if(p=D?x.geometries[q]:x,p!==null){C=p.coordinates;var W=p.type;switch(w=0,W){case null:break;case"Point":if(a(C,N,ee,U,j)===!1)return!1;N++,U++;break;case"LineString":case"MultiPoint":for(c=0;c<C.length;c++){if(a(C[c],N,ee,U,j)===!1)return!1;N++,W==="MultiPoint"&&U++}W==="LineString"&&U++;break;case"Polygon":case"MultiLineString":for(c=0;c<C.length;c++){for(o=0;o<C[c].length-w;o++){if(a(C[c][o],N,ee,U,j)===!1)return!1;N++}W==="MultiLineString"&&U++,W==="Polygon"&&j++}W==="Polygon"&&U++;break;case"MultiPolygon":for(c=0;c<C.length;c++){for(j=0,o=0;o<C[c].length;o++){for(d=0;d<C[c][o].length-w;d++){if(a(C[c][o][d],N,ee,U,j)===!1)return!1;N++}j++}U++}break;case"GeometryCollection":for(c=0;c<p.geometries.length;c++)if(jr(p.geometries[c],a)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function xr(u,a){if(u.type==="Feature")a(u,0);else if(u.type==="FeatureCollection")for(var l=0;l<u.features.length&&a(u.features[l],l)!==!1;l++);}function ki(u,a){var l,c,o,d,p,g,C,x,w,N,D=0,B=u.type==="FeatureCollection",b=u.type==="Feature",Z=B?u.features.length:1;for(l=0;l<Z;l++){for(g=B?u.features[l].geometry:b?u.geometry:u,x=B?u.features[l].properties:b?u.properties:{},w=B?u.features[l].bbox:b?u.bbox:void 0,N=B?u.features[l].id:b?u.id:void 0,C=g?g.type==="GeometryCollection":!1,p=C?g.geometries.length:1,o=0;o<p;o++){if(d=C?g.geometries[o]:g,d===null){if(a(null,D,x,w,N)===!1)return!1;continue}switch(d.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(a(d,D,x,w,N)===!1)return!1;break}case"GeometryCollection":{for(c=0;c<d.geometries.length;c++)if(a(d.geometries[c],D,x,w,N)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}D++}}function Aa(u,a={}){if(u.bbox!=null&&a.recompute!==!0)return u.bbox;const l=[1/0,1/0,-1/0,-1/0];return jr(u,c=>{l[0]>c[0]&&(l[0]=c[0]),l[1]>c[1]&&(l[1]=c[1]),l[2]<c[0]&&(l[2]=c[0]),l[3]<c[1]&&(l[3]=c[1])}),l}function Da(u,a={}){const l=Aa(u),c=(l[0]+l[2])/2,o=(l[1]+l[3])/2;return Ca([c,o],a.properties,a)}var Tn={exports:{}},Fa=Tn.exports,Er;function Ga(){return Er||(Er=1,function(u,a){(function(l,c){u.exports=c()})(Fa,function(){function l(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,n=Array(e);t<e;t++)n[t]=i[t];return n}function c(i,e,t){return e=w(e),function(n,r){if(r&&(typeof r=="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}(n)}(i,D()?Reflect.construct(e,t||[],w(i).constructor):e.apply(i,t))}function o(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function d(i,e,t){if(D())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,e);var r=new(i.bind.apply(i,n));return t&&B(r,t.prototype),r}function p(i,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(i,V(n.key),n)}}function g(i,e,t){return e&&p(i.prototype,e),t&&p(i,t),Object.defineProperty(i,"prototype",{writable:!1}),i}function C(i,e){var t=typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(!t){if(Array.isArray(i)||(t=ee(i))||e){t&&(i=t);var n=0,r=function(){};return{s:r,n:function(){return n>=i.length?{done:!0}:{done:!1,value:i[n++]}},e:function(m){throw m},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s,h=!0,f=!1;return{s:function(){t=t.call(i)},n:function(){var m=t.next();return h=m.done,m},e:function(m){f=!0,s=m},f:function(){try{h||t.return==null||t.return()}finally{if(f)throw s}}}}function x(){return x=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(i,e,t){var n=function(s,h){for(;!{}.hasOwnProperty.call(s,h)&&(s=w(s))!==null;);return s}(i,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(arguments.length<3?i:t):r.value}},x.apply(null,arguments)}function w(i){return w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},w(i)}function N(i,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),e&&B(i,e)}function D(){try{var i=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(D=function(){return!!i})()}function B(i,e){return B=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},B(i,e)}function b(i,e,t,n){var r=x(w(1&n?i.prototype:i),e,t);return 2&n&&typeof r=="function"?function(s){return r.apply(t,s)}:r}function Z(i){return function(e){if(Array.isArray(e))return l(e)}(i)||function(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}(i)||ee(i)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function V(i){var e=function(t,n){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(i,"string");return typeof e=="symbol"?e:e+""}function ee(i,e){if(i){if(typeof i=="string")return l(i,e);var t={}.toString.call(i).slice(8,-1);return t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set"?Array.from(i):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?l(i,e):void 0}}function q(i){var e=typeof Map=="function"?new Map:void 0;return q=function(t){if(t===null||!function(r){try{return Function.toString.call(r).indexOf("[native code]")!==-1}catch{return typeof r=="function"}}(t))return t;if(typeof t!="function")throw new TypeError("Super expression must either be null or a function");if(e!==void 0){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return d(t,arguments,w(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),B(n,t)},q(i)}var U=function(){function i(){o(this,i),i.constructor_.apply(this,arguments)}return g(i,[{key:"getEndCapStyle",value:function(){return this._endCapStyle}},{key:"isSingleSided",value:function(){return this._isSingleSided}},{key:"setQuadrantSegments",value:function(e){this._quadrantSegments=e,this._quadrantSegments===0&&(this._joinStyle=i.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=i.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),e<=0&&(this._quadrantSegments=1),this._joinStyle!==i.JOIN_ROUND&&(this._quadrantSegments=i.DEFAULT_QUADRANT_SEGMENTS)}},{key:"getJoinStyle",value:function(){return this._joinStyle}},{key:"setJoinStyle",value:function(e){this._joinStyle=e}},{key:"setSimplifyFactor",value:function(e){this._simplifyFactor=e<0?0:e}},{key:"getSimplifyFactor",value:function(){return this._simplifyFactor}},{key:"getQuadrantSegments",value:function(){return this._quadrantSegments}},{key:"setEndCapStyle",value:function(e){this._endCapStyle=e}},{key:"getMitreLimit",value:function(){return this._mitreLimit}},{key:"setMitreLimit",value:function(e){this._mitreLimit=e}},{key:"setSingleSided",value:function(e){this._isSingleSided=e}}],[{key:"constructor_",value:function(){if(this._quadrantSegments=i.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=i.CAP_ROUND,this._joinStyle=i.JOIN_ROUND,this._mitreLimit=i.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=i.DEFAULT_SIMPLIFY_FACTOR,arguments.length!==0){if(arguments.length===1){var e=arguments[0];this.setQuadrantSegments(e)}else if(arguments.length===2){var t=arguments[0],n=arguments[1];this.setQuadrantSegments(t),this.setEndCapStyle(n)}else if(arguments.length===4){var r=arguments[0],s=arguments[1],h=arguments[2],f=arguments[3];this.setQuadrantSegments(r),this.setEndCapStyle(s),this.setJoinStyle(h),this.setMitreLimit(f)}}}},{key:"bufferDistanceError",value:function(e){var t=Math.PI/2/e;return 1-Math.cos(t/2)}}])}();U.CAP_ROUND=1,U.CAP_FLAT=2,U.CAP_SQUARE=3,U.JOIN_ROUND=1,U.JOIN_MITRE=2,U.JOIN_BEVEL=3,U.DEFAULT_QUADRANT_SEGMENTS=8,U.DEFAULT_MITRE_LIMIT=5,U.DEFAULT_SIMPLIFY_FACTOR=.01;var j=function(i){function e(t){var n;return o(this,e),(n=c(this,e,[t])).name=Object.keys({Exception:e})[0],n}return N(e,i),g(e,[{key:"toString",value:function(){return this.message}}])}(q(Error)),W=function(i){function e(t){var n;return o(this,e),(n=c(this,e,[t])).name=Object.keys({IllegalArgumentException:e})[0],n}return N(e,i),g(e)}(j),K=function(){return g(function i(){o(this,i)},[{key:"filter",value:function(i){}}])}();function ie(){}function y(){}function v(){}var E,A,T,M,S,k,L,O,R=function(){return g(function i(){o(this,i)},null,[{key:"equalsWithTolerance",value:function(i,e,t){return Math.abs(i-e)<=t}}])}(),Y=function(){return g(function i(e,t){o(this,i),this.low=t||0,this.high=e||0},null,[{key:"toBinaryString",value:function(i){var e,t="";for(e=2147483648;e>0;e>>>=1)t+=(i.high&e)===e?"1":"0";for(e=2147483648;e>0;e>>>=1)t+=(i.low&e)===e?"1":"0";return t}}])}();function z(){}function X(){}z.NaN=NaN,z.isNaN=function(i){return Number.isNaN(i)},z.isInfinite=function(i){return!Number.isFinite(i)},z.MAX_VALUE=Number.MAX_VALUE,z.POSITIVE_INFINITY=Number.POSITIVE_INFINITY,z.NEGATIVE_INFINITY=Number.NEGATIVE_INFINITY,typeof Float64Array=="function"&&typeof Int32Array=="function"?(k=2146435072,L=new Float64Array(1),O=new Int32Array(L.buffer),z.doubleToLongBits=function(i){L[0]=i;var e=0|O[0],t=0|O[1];return(t&k)===k&&1048575&t&&e!==0&&(e=0,t=2146959360),new Y(t,e)},z.longBitsToDouble=function(i){return O[0]=i.low,O[1]=i.high,L[0]}):(E=1023,A=Math.log2,T=Math.floor,M=Math.pow,S=function(){for(var i=53;i>0;i--){var e=M(2,i)-1;if(T(A(e))+1===i)return e}return 0}(),z.doubleToLongBits=function(i){var e,t,n,r,s,h,f,m,_;if(i<0||1/i===Number.NEGATIVE_INFINITY?(h=1<<31,i=-i):h=0,i===0)return new Y(m=h,_=0);if(i===1/0)return new Y(m=2146435072|h,_=0);if(i!=i)return new Y(m=2146959360,_=0);if(r=0,_=0,(e=T(i))>1)if(e<=S)(r=T(A(e)))<=20?(_=0,m=e<<20-r&1048575):(_=e%(t=M(2,n=r-20))<<32-n,m=e/t&1048575);else for(n=e,_=0;(n=T(t=n/2))!==0;)r++,_>>>=1,_|=(1&m)<<31,m>>>=1,t!==n&&(m|=524288);if(f=r+E,s=e===0,e=i-e,r<52&&e!==0)for(n=0;;){if((t=2*e)>=1?(e=t-1,s?(f--,s=!1):(n<<=1,n|=1,r++)):(e=t,s?--f==0&&(r++,s=!1):(n<<=1,r++)),r===20)m|=n,n=0;else if(r===52){_|=n;break}if(t===1){r<20?m|=n<<20-r:r<52&&(_|=n<<52-r);break}}return m|=f<<20,new Y(m|=h,_)},z.longBitsToDouble=function(i){var e,t,n,r,s=i.high,h=i.low,f=s&1<<31?-1:1;for(n=((2146435072&s)>>20)-E,r=0,t=1<<19,e=1;e<=20;e++)s&t&&(r+=M(2,-e)),t>>>=1;for(t=1<<31,e=21;e<=52;e++)h&t&&(r+=M(2,-e)),t>>>=1;if(n===-1023){if(r===0)return 0*f;n=-1022}else{if(n===1024)return r===0?f/0:NaN;r+=1}return f*r*M(2,n)});var te=function(i){function e(t){var n;return o(this,e),(n=c(this,e,[t])).name=Object.keys({RuntimeException:e})[0],n}return N(e,i),g(e)}(j),oe=function(i){function e(){var t;return o(this,e),t=c(this,e),e.constructor_.apply(t,arguments),t}return N(e,i),g(e,null,[{key:"constructor_",value:function(){if(arguments.length===0)te.constructor_.call(this);else if(arguments.length===1){var t=arguments[0];te.constructor_.call(this,t)}}}])}(te),ne=function(){function i(){o(this,i)}return g(i,null,[{key:"shouldNeverReachHere",value:function(){if(arguments.length===0)i.shouldNeverReachHere(null);else if(arguments.length===1){var e=arguments[0];throw new oe("Should never reach here"+(e!==null?": "+e:""))}}},{key:"isTrue",value:function(){if(arguments.length===1){var e=arguments[0];i.isTrue(e,null)}else if(arguments.length===2){var t=arguments[1];if(!arguments[0])throw t===null?new oe:new oe(t)}}},{key:"equals",value:function(){if(arguments.length===2){var e=arguments[0],t=arguments[1];i.equals(e,t,null)}else if(arguments.length===3){var n=arguments[0],r=arguments[1],s=arguments[2];if(!r.equals(n))throw new oe("Expected "+n+" but encountered "+r+(s!==null?": "+s:""))}}}])}(),ce=new ArrayBuffer(8),xe=new Float64Array(ce),Oe=new Int32Array(ce),F=function(){function i(){o(this,i),i.constructor_.apply(this,arguments)}return g(i,[{key:"getM",value:function(){return z.NaN}},{key:"setOrdinate",value:function(e,t){switch(e){case i.X:this.x=t;break;case i.Y:this.y=t;break;case i.Z:this.setZ(t);break;default:throw new W("Invalid ordinate index: "+e)}}},{key:"equals2D",value:function(){if(arguments.length===1){var e=arguments[0];return this.x===e.x&&this.y===e.y}if(arguments.length===2){var t=arguments[0],n=arguments[1];return!!R.equalsWithTolerance(this.x,t.x,n)&&!!R.equalsWithTolerance(this.y,t.y,n)}}},{key:"setM",value:function(e){throw new W("Invalid ordinate index: "+i.M)}},{key:"getZ",value:function(){return this.z}},{key:"getOrdinate",value:function(e){switch(e){case i.X:return this.x;case i.Y:return this.y;case i.Z:return this.getZ()}throw new W("Invalid ordinate index: "+e)}},{key:"equals3D",value:function(e){return this.x===e.x&&this.y===e.y&&(this.getZ()===e.getZ()||z.isNaN(this.getZ())&&z.isNaN(e.getZ()))}},{key:"equals",value:function(e){return e instanceof i&&this.equals2D(e)}},{key:"equalInZ",value:function(e,t){return R.equalsWithTolerance(this.getZ(),e.getZ(),t)}},{key:"setX",value:function(e){this.x=e}},{key:"compareTo",value:function(e){var t=e;return this.x<t.x?-1:this.x>t.x?1:this.y<t.y?-1:this.y>t.y?1:0}},{key:"getX",value:function(){return this.x}},{key:"setZ",value:function(e){this.z=e}},{key:"clone",value:function(){try{return null}catch(e){if(e instanceof CloneNotSupportedException)return ne.shouldNeverReachHere("this shouldn't happen because this class is Cloneable"),null;throw e}}},{key:"copy",value:function(){return new i(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+", "+this.getZ()+")"}},{key:"distance3D",value:function(e){var t=this.x-e.x,n=this.y-e.y,r=this.getZ()-e.getZ();return Math.sqrt(t*t+n*n+r*r)}},{key:"getY",value:function(){return this.y}},{key:"setY",value:function(e){this.y=e}},{key:"distance",value:function(e){var t=this.x-e.x,n=this.y-e.y;return Math.sqrt(t*t+n*n)}},{key:"hashCode",value:function(){var e=17;return e=37*(e=37*e+i.hashCode(this.x))+i.hashCode(this.y)}},{key:"setCoordinate",value:function(e){this.x=e.x,this.y=e.y,this.z=e.getZ()}},{key:"interfaces_",get:function(){return[ie,y,v]}}],[{key:"constructor_",value:function(){if(this.x=null,this.y=null,this.z=null,arguments.length===0)i.constructor_.call(this,0,0);else if(arguments.length===1){var e=arguments[0];i.constructor_.call(this,e.x,e.y,e.getZ())}else if(arguments.length===2){var t=arguments[0],n=arguments[1];i.constructor_.call(this,t,n,i.NULL_ORDINATE)}else if(arguments.length===3){var r=arguments[0],s=arguments[1],h=arguments[2];this.x=r,this.y=s,this.z=h}}},{key:"hashCode",value:function(e){return xe[0]=e,Oe[0]^Oe[1]}}])}(),Yt=function(){function i(){o(this,i),i.constructor_.apply(this,arguments)}return g(i,[{key:"compare",value:function(e,t){var n=i.compare(e.x,t.x);if(n!==0)return n;var r=i.compare(e.y,t.y);return r!==0?r:this._dimensionsToTest<=2?0:i.compare(e.getZ(),t.getZ())}},{key:"interfaces_",get:function(){return[X]}}],[{key:"constructor_",value:function(){if(this._dimensionsToTest=2,arguments.length===0)i.constructor_.call(this,2);else if(arguments.length===1){var e=arguments[0];if(e!==2&&e!==3)throw new W("only 2 or 3 dimensions may be specified");this._dimensionsToTest=e}}},{key:"compare",value:function(e,t){return e<t?-1:e>t?1:z.isNaN(e)?z.isNaN(t)?0:-1:z.isNaN(t)?1:0}}])}();F.DimensionalComparator=Yt,F.NULL_ORDINATE=z.NaN,F.X=0,F.Y=1,F.Z=2,F.M=3;var Ee=function(){function i(){o(this,i),i.constructor_.apply(this,arguments)}return g(i,[{key:"getArea",value:function(){return this.getWidth()*this.getHeight()}},{key:"equals",value:function(e){if(!(e instanceof i))return!1;var t=e;return this.isNull()?t.isNull():this._maxx===t.getMaxX()&&this._maxy===t.getMaxY()&&this._minx===t.getMinX()&&this._miny===t.getMinY()}},{key:"intersection",value:function(e){if(this.isNull()||e.isNull()||!this.intersects(e))return new i;var t=this._minx>e._minx?this._minx:e._minx,n=this._miny>e._miny?this._miny:e._miny;return new i(t,this._maxx<e._maxx?this._maxx:e._maxx,n,this._maxy<e._maxy?this._maxy:e._maxy)}},{key:"isNull",value:function(){return this._maxx<this._minx}},{key:"getMaxX",value:function(){return this._maxx}},{key:"covers",value:function(){if(arguments.length===1){if(arguments[0]instanceof F){var e=arguments[0];return this.covers(e.x,e.y)}if(arguments[0]instanceof i){var t=arguments[0];return!this.isNull()&&!t.isNull()&&t.getMinX()>=this._minx&&t.getMaxX()<=this._maxx&&t.getMinY()>=this._miny&&t.getMaxY()<=this._maxy}}else if(arguments.length===2){var n=arguments[0],r=arguments[1];return!this.isNull()&&n>=this._minx&&n<=this._maxx&&r>=this._miny&&r<=this._maxy}}},{key:"intersects",value:function(){if(arguments.length===1){if(arguments[0]instanceof i){var e=arguments[0];return!this.isNull()&&!e.isNull()&&!(e._minx>this._maxx||e._maxx<this._minx||e._miny>this._maxy||e._maxy<this._miny)}if(arguments[0]instanceof F){var t=arguments[0];return this.intersects(t.x,t.y)}}else if(arguments.length===2){if(arguments[0]instanceof F&&arguments[1]instanceof F){var n=arguments[0],r=arguments[1];return!this.isNull()&&!((n.x<r.x?n.x:r.x)>this._maxx)&&!((n.x>r.x?n.x:r.x)<this._minx)&&!((n.y<r.y?n.y:r.y)>this._maxy)&&!((n.y>r.y?n.y:r.y)<this._miny)}if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var s=arguments[0],h=arguments[1];return!this.isNull()&&!(s>this._maxx||s<this._minx||h>this._maxy||h<this._miny)}}}},{key:"getMinY",value:function(){return this._miny}},{key:"getDiameter",value:function(){if(this.isNull())return 0;var e=this.getWidth(),t=this.getHeight();return Math.sqrt(e*e+t*t)}},{key:"getMinX",value:function(){return this._minx}},{key:"expandToInclude",value:function(){if(arguments.length===1){if(arguments[0]instanceof F){var e=arguments[0];this.expandToInclude(e.x,e.y)}else if(arguments[0]instanceof i){var t=arguments[0];if(t.isNull())return null;this.isNull()?(this._minx=t.getMinX(),this._maxx=t.getMaxX(),this._miny=t.getMinY(),this._maxy=t.getMaxY()):(t._minx<this._minx&&(this._minx=t._minx),t._maxx>this._maxx&&(this._maxx=t._maxx),t._miny<this._miny&&(this._miny=t._miny),t._maxy>this._maxy&&(this._maxy=t._maxy))}}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this.isNull()?(this._minx=n,this._maxx=n,this._miny=r,this._maxy=r):(n<this._minx&&(this._minx=n),n>this._maxx&&(this._maxx=n),r<this._miny&&(this._miny=r),r>this._maxy&&(this._maxy=r))}}},{key:"minExtent",value:function(){if(this.isNull())return 0;var e=this.getWidth(),t=this.getHeight();return e<t?e:t}},{key:"getWidth",value:function(){return this.isNull()?0:this._maxx-this._minx}},{key:"compareTo",value:function(e){var t=e;return this.isNull()?t.isNull()?0:-1:t.isNull()?1:this._minx<t._minx?-1:this._minx>t._minx?1:this._miny<t._miny?-1:this._miny>t._miny?1:this._maxx<t._maxx?-1:this._maxx>t._maxx?1:this._maxy<t._maxy?-1:this._maxy>t._maxy?1:0}},{key:"translate",value:function(e,t){if(this.isNull())return null;this.init(this.getMinX()+e,this.getMaxX()+e,this.getMinY()+t,this.getMaxY()+t)}},{key:"copy",value:function(){return new i(this)}},{key:"toString",value:function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"}},{key:"setToNull",value:function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1}},{key:"disjoint",value:function(e){return!(!this.isNull()&&!e.isNull())||e._minx>this._maxx||e._maxx<this._minx||e._miny>this._maxy||e._maxy<this._miny}},{key:"getHeight",value:function(){return this.isNull()?0:this._maxy-this._miny}},{key:"maxExtent",value:function(){if(this.isNull())return 0;var e=this.getWidth(),t=this.getHeight();return e>t?e:t}},{key:"expandBy",value:function(){if(arguments.length===1){var e=arguments[0];this.expandBy(e,e)}else if(arguments.length===2){var t=arguments[0],n=arguments[1];if(this.isNull())return null;this._minx-=t,this._maxx+=t,this._miny-=n,this._maxy+=n,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}}},{key:"contains",value:function(){if(arguments.length===1){if(arguments[0]instanceof i){var e=arguments[0];return this.covers(e)}if(arguments[0]instanceof F){var t=arguments[0];return this.covers(t)}}else if(arguments.length===2){var n=arguments[0],r=arguments[1];return this.covers(n,r)}}},{key:"centre",value:function(){return this.isNull()?null:new F((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)}},{key:"init",value:function(){if(arguments.length===0)this.setToNull();else if(arguments.length===1){if(arguments[0]instanceof F){var e=arguments[0];this.init(e.x,e.x,e.y,e.y)}else if(arguments[0]instanceof i){var t=arguments[0];this._minx=t._minx,this._maxx=t._maxx,this._miny=t._miny,this._maxy=t._maxy}}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this.init(n.x,r.x,n.y,r.y)}else if(arguments.length===4){var s=arguments[0],h=arguments[1],f=arguments[2],m=arguments[3];s<h?(this._minx=s,this._maxx=h):(this._minx=h,this._maxx=s),f<m?(this._miny=f,this._maxy=m):(this._miny=m,this._maxy=f)}}},{key:"getMaxY",value:function(){return this._maxy}},{key:"distance",value:function(e){if(this.intersects(e))return 0;var t=0;this._maxx<e._minx?t=e._minx-this._maxx:this._minx>e._maxx&&(t=this._minx-e._maxx);var n=0;return this._maxy<e._miny?n=e._miny-this._maxy:this._miny>e._maxy&&(n=this._miny-e._maxy),t===0?n:n===0?t:Math.sqrt(t*t+n*n)}},{key:"hashCode",value:function(){var e=17;return e=37*(e=37*(e=37*(e=37*e+F.hashCode(this._minx))+F.hashCode(this._maxx))+F.hashCode(this._miny))+F.hashCode(this._maxy)}},{key:"interfaces_",get:function(){return[ie,v]}}],[{key:"constructor_",value:function(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,arguments.length===0)this.init();else if(arguments.length===1){if(arguments[0]instanceof F){var e=arguments[0];this.init(e.x,e.x,e.y,e.y)}else if(arguments[0]instanceof i){var t=arguments[0];this.init(t)}}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this.init(n.x,r.x,n.y,r.y)}else if(arguments.length===4){var s=arguments[0],h=arguments[1],f=arguments[2],m=arguments[3];this.init(s,h,f,m)}}},{key:"intersects",value:function(){if(arguments.length===3){var e=arguments[0],t=arguments[1],n=arguments[2];return n.x>=(e.x<t.x?e.x:t.x)&&n.x<=(e.x>t.x?e.x:t.x)&&n.y>=(e.y<t.y?e.y:t.y)&&n.y<=(e.y>t.y?e.y:t.y)}if(arguments.length===4){var r=arguments[0],s=arguments[1],h=arguments[2],f=arguments[3],m=Math.min(h.x,f.x),_=Math.max(h.x,f.x),P=Math.min(r.x,s.x),G=Math.max(r.x,s.x);return!(P>_)&&!(G<m)&&(m=Math.min(h.y,f.y),_=Math.max(h.y,f.y),P=Math.min(r.y,s.y),G=Math.max(r.y,s.y),!(P>_)&&!(G<m))}}}])}(),re=function(){function i(){o(this,i),i.constructor_.apply(this,arguments)}return g(i,[{key:"isGeometryCollection",value:function(){return this.getTypeCode()===i.TYPECODE_GEOMETRYCOLLECTION}},{key:"getFactory",value:function(){return this._factory}},{key:"getGeometryN",value:function(e){return this}},{key:"getArea",value:function(){return 0}},{key:"isRectangle",value:function(){return!1}},{key:"equalsExact",value:function(e){return this===e||this.equalsExact(e,0)}},{key:"geometryChanged",value:function(){this.apply(i.geometryChangedFilter)}},{key:"geometryChangedAction",value:function(){this._envelope=null}},{key:"equalsNorm",value:function(e){return e!==null&&this.norm().equalsExact(e.norm())}},{key:"getLength",value:function(){return 0}},{key:"getNumGeometries",value:function(){return 1}},{key:"compareTo",value:function(){var e;if(arguments.length===1){var t=arguments[0];return e=t,this.getTypeCode()!==e.getTypeCode()?this.getTypeCode()-e.getTypeCode():this.isEmpty()&&e.isEmpty()?0:this.isEmpty()?-1:e.isEmpty()?1:this.compareToSameClass(t)}if(arguments.length===2){var n=arguments[0],r=arguments[1];return e=n,this.getTypeCode()!==e.getTypeCode()?this.getTypeCode()-e.getTypeCode():this.isEmpty()&&e.isEmpty()?0:this.isEmpty()?-1:e.isEmpty()?1:this.compareToSameClass(n,r)}}},{key:"getUserData",value:function(){return this._userData}},{key:"getSRID",value:function(){return this._SRID}},{key:"getEnvelope",value:function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())}},{key:"checkNotGeometryCollection",value:function(e){if(e.getTypeCode()===i.TYPECODE_GEOMETRYCOLLECTION)throw new W("This method does not support GeometryCollection arguments")}},{key:"equal",value:function(e,t,n){return n===0?e.equals(t):e.distance(t)<=n}},{key:"norm",value:function(){var e=this.copy();return e.normalize(),e}},{key:"reverse",value:function(){var e=this.reverseInternal();return this.envelope!=null&&(e.envelope=this.envelope.copy()),e.setSRID(this.getSRID()),e}},{key:"copy",value:function(){var e=this.copyInternal();return e.envelope=this._envelope==null?null:this._envelope.copy(),e._SRID=this._SRID,e._userData=this._userData,e}},{key:"getPrecisionModel",value:function(){return this._factory.getPrecisionModel()}},{key:"getEnvelopeInternal",value:function(){return this._envelope===null&&(this._envelope=this.computeEnvelopeInternal()),new Ee(this._envelope)}},{key:"setSRID",value:function(e){this._SRID=e}},{key:"setUserData",value:function(e){this._userData=e}},{key:"compare",value:function(e,t){for(var n=e.iterator(),r=t.iterator();n.hasNext()&&r.hasNext();){var s=n.next(),h=r.next(),f=s.compareTo(h);if(f!==0)return f}return n.hasNext()?1:r.hasNext()?-1:0}},{key:"hashCode",value:function(){return this.getEnvelopeInternal().hashCode()}},{key:"isEquivalentClass",value:function(e){return this.getClass()===e.getClass()}},{key:"isGeometryCollectionOrDerived",value:function(){return this.getTypeCode()===i.TYPECODE_GEOMETRYCOLLECTION||this.getTypeCode()===i.TYPECODE_MULTIPOINT||this.getTypeCode()===i.TYPECODE_MULTILINESTRING||this.getTypeCode()===i.TYPECODE_MULTIPOLYGON}},{key:"interfaces_",get:function(){return[y,ie,v]}},{key:"getClass",value:function(){return i}}],[{key:"hasNonEmptyElements",value:function(e){for(var t=0;t<e.length;t++)if(!e[t].isEmpty())return!0;return!1}},{key:"hasNullElements",value:function(e){for(var t=0;t<e.length;t++)if(e[t]===null)return!0;return!1}}])}();re.constructor_=function(i){i&&(this._envelope=null,this._userData=null,this._factory=i,this._SRID=i.getSRID())},re.TYPECODE_POINT=0,re.TYPECODE_MULTIPOINT=1,re.TYPECODE_LINESTRING=2,re.TYPECODE_LINEARRING=3,re.TYPECODE_MULTILINESTRING=4,re.TYPECODE_POLYGON=5,re.TYPECODE_MULTIPOLYGON=6,re.TYPECODE_GEOMETRYCOLLECTION=7,re.TYPENAME_POINT="Point",re.TYPENAME_MULTIPOINT="MultiPoint",re.TYPENAME_LINESTRING="LineString",re.TYPENAME_LINEARRING="LinearRing",re.TYPENAME_MULTILINESTRING="MultiLineString",re.TYPENAME_POLYGON="Polygon",re.TYPENAME_MULTIPOLYGON="MultiPolygon",re.TYPENAME_GEOMETRYCOLLECTION="GeometryCollection",re.geometryChangedFilter={get interfaces_(){return[K]},filter:function(i){i.geometryChangedAction()}};var I=function(){function i(){o(this,i)}return g(i,null,[{key:"toLocationSymbol",value:function(e){switch(e){case i.EXTERIOR:return"e";case i.BOUNDARY:return"b";case i.INTERIOR:return"i";case i.NONE:return"-"}throw new W("Unknown location value: "+e)}}])}();I.INTERIOR=0,I.BOUNDARY=1,I.EXTERIOR=2,I.NONE=-1;var we=function(){return g(function i(){o(this,i)},[{key:"add",value:function(){}},{key:"addAll",value:function(){}},{key:"isEmpty",value:function(){}},{key:"iterator",value:function(){}},{key:"size",value:function(){}},{key:"toArray",value:function(){}},{key:"remove",value:function(){}}])}(),Ce=function(i){function e(t){var n;return o(this,e),(n=c(this,e,[t])).name=Object.keys({NoSuchElementException:e})[0],n}return N(e,i),g(e)}(j),pe=function(i){function e(t){var n;return o(this,e),(n=c(this,e,[t])).name=Object.keys({UnsupportedOperationException:e})[0],n}return N(e,i),g(e)}(j),Ii=function(i){function e(){return o(this,e),c(this,e,arguments)}return N(e,i),g(e,[{key:"contains",value:function(){}}])}(we),Bn=function(i){function e(t){var n;return o(this,e),(n=c(this,e)).map=new Map,t instanceof we&&n.addAll(t),n}return N(e,i),g(e,[{key:"contains",value:function(t){var n=t.hashCode?t.hashCode():t;return!!this.map.has(n)}},{key:"add",value:function(t){var n=t.hashCode?t.hashCode():t;return!this.map.has(n)&&!!this.map.set(n,t)}},{key:"addAll",value:function(t){var n,r=C(t);try{for(r.s();!(n=r.n()).done;){var s=n.value;this.add(s)}}catch(h){r.e(h)}finally{r.f()}return!0}},{key:"remove",value:function(){throw new pe}},{key:"size",value:function(){return this.map.size}},{key:"isEmpty",value:function(){return this.map.size===0}},{key:"toArray",value:function(){return Array.from(this.map.values())}},{key:"iterator",value:function(){return new xs(this.map)}},{key:Symbol.iterator,value:function(){return this.map}}])}(Ii),xs=function(){return g(function i(e){o(this,i),this.iterator=e.values();var t=this.iterator.next(),n=t.done,r=t.value;this.done=n,this.value=r},[{key:"next",value:function(){if(this.done)throw new Ce;var i=this.value,e=this.iterator.next(),t=e.done,n=e.value;return this.done=t,this.value=n,i}},{key:"hasNext",value:function(){return!this.done}},{key:"remove",value:function(){throw new pe}}])}(),H=function(){function i(){o(this,i)}return g(i,null,[{key:"opposite",value:function(e){return e===i.LEFT?i.RIGHT:e===i.RIGHT?i.LEFT:e}}])}();H.ON=0,H.LEFT=1,H.RIGHT=2;var Ni=function(i){function e(t){var n;return o(this,e),(n=c(this,e,[t])).name=Object.keys({EmptyStackException:e})[0],n}return N(e,i),g(e)}(j),wi=function(i){function e(t){var n;return o(this,e),(n=c(this,e,[t])).name=Object.keys({IndexOutOfBoundsException:e})[0],n}return N(e,i),g(e)}(j),xt=function(i){function e(){return o(this,e),c(this,e,arguments)}return N(e,i),g(e,[{key:"get",value:function(){}},{key:"set",value:function(){}},{key:"isEmpty",value:function(){}}])}(we),Es=function(i){function e(){var t;return o(this,e),(t=c(this,e)).array=[],t}return N(e,i),g(e,[{key:"add",value:function(t){return this.array.push(t),!0}},{key:"get",value:function(t){if(t<0||t>=this.size())throw new wi;return this.array[t]}},{key:"push",value:function(t){return this.array.push(t),t}},{key:"pop",value:function(){if(this.array.length===0)throw new Ni;return this.array.pop()}},{key:"peek",value:function(){if(this.array.length===0)throw new Ni;return this.array[this.array.length-1]}},{key:"empty",value:function(){return this.array.length===0}},{key:"isEmpty",value:function(){return this.empty()}},{key:"search",value:function(t){return this.array.indexOf(t)}},{key:"size",value:function(){return this.array.length}},{key:"toArray",value:function(){return this.array.slice()}}])}(xt);function ge(i,e){return i.interfaces_&&i.interfaces_.indexOf(e)>-1}var Ut=function(){return g(function i(e){o(this,i),this.str=e},[{key:"append",value:function(i){this.str+=i}},{key:"setCharAt",value:function(i,e){this.str=this.str.substr(0,i)+e+this.str.substr(i+1)}},{key:"toString",value:function(){return this.str}}])}(),an=function(){function i(e){o(this,i),this.value=e}return g(i,[{key:"intValue",value:function(){return this.value}},{key:"compareTo",value:function(e){return this.value<e?-1:this.value>e?1:0}}],[{key:"compare",value:function(e,t){return e<t?-1:e>t?1:0}},{key:"isNan",value:function(e){return Number.isNaN(e)}},{key:"valueOf",value:function(e){return new i(e)}}])}(),zn=function(){return g(function i(){o(this,i)},null,[{key:"isWhitespace",value:function(i){return i<=32&&i>=0||i===127}},{key:"toUpperCase",value:function(i){return i.toUpperCase()}}])}(),le=function(){function i(){o(this,i),i.constructor_.apply(this,arguments)}return g(i,[{key:"le",value:function(e){return this._hi<e._hi||this._hi===e._hi&&this._lo<=e._lo}},{key:"extractSignificantDigits",value:function(e,t){var n=this.abs(),r=i.magnitude(n._hi),s=i.TEN.pow(r);(n=n.divide(s)).gt(i.TEN)?(n=n.divide(i.TEN),r+=1):n.lt(i.ONE)&&(n=n.multiply(i.TEN),r-=1);for(var h=r+1,f=new Ut,m=i.MAX_PRINT_DIGITS-1,_=0;_<=m;_++){e&&_===h&&f.append(".");var P=Math.trunc(n._hi);if(P<0)break;var G=!1,$=0;P>9?(G=!0,$="9"):$="0"+P,f.append($),n=n.subtract(i.valueOf(P)).multiply(i.TEN),G&&n.selfAdd(i.TEN);var Q=!0,se=i.magnitude(n._hi);if(se<0&&Math.abs(se)>=m-_&&(Q=!1),!Q)break}return t[0]=r,f.toString()}},{key:"sqr",value:function(){return this.multiply(this)}},{key:"doubleValue",value:function(){return this._hi+this._lo}},{key:"subtract",value:function(){if(arguments[0]instanceof i){var e=arguments[0];return this.add(e.negate())}if(typeof arguments[0]=="number"){var t=arguments[0];return this.add(-t)}}},{key:"equals",value:function(){if(arguments.length===1&&arguments[0]instanceof i){var e=arguments[0];return this._hi===e._hi&&this._lo===e._lo}}},{key:"isZero",value:function(){return this._hi===0&&this._lo===0}},{key:"selfSubtract",value:function(){if(arguments[0]instanceof i){var e=arguments[0];return this.isNaN()?this:this.selfAdd(-e._hi,-e._lo)}if(typeof arguments[0]=="number"){var t=arguments[0];return this.isNaN()?this:this.selfAdd(-t,0)}}},{key:"getSpecialNumberString",value:function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null}},{key:"min",value:function(e){return this.le(e)?this:e}},{key:"selfDivide",value:function(){if(arguments.length===1){if(arguments[0]instanceof i){var e=arguments[0];return this.selfDivide(e._hi,e._lo)}if(typeof arguments[0]=="number"){var t=arguments[0];return this.selfDivide(t,0)}}else if(arguments.length===2){var n,r,s,h,f=arguments[0],m=arguments[1],_=null,P=null,G=null,$=null;return s=this._hi/f,$=(_=(G=i.SPLIT*s)-(_=G-s))*(P=($=i.SPLIT*f)-(P=$-f))-(h=s*f)+_*(r=f-P)+(n=s-_)*P+n*r,$=s+(G=(this._hi-h-$+this._lo-s*m)/f),this._hi=$,this._lo=s-$+G,this}}},{key:"dump",value:function(){return"DD<"+this._hi+", "+this._lo+">"}},{key:"divide",value:function(){if(arguments[0]instanceof i){var e,t,n,r,s=arguments[0],h=null,f=null,m=null,_=null;return e=(n=this._hi/s._hi)-(h=(m=i.SPLIT*n)-(h=m-n)),_=h*(f=(_=i.SPLIT*s._hi)-(f=_-s._hi))-(r=n*s._hi)+h*(t=s._hi-f)+e*f+e*t,new i(_=n+(m=(this._hi-r-_+this._lo-n*s._lo)/s._hi),n-_+m)}if(typeof arguments[0]=="number"){var P=arguments[0];return z.isNaN(P)?i.createNaN():i.copy(this).selfDivide(P,0)}}},{key:"ge",value:function(e){return this._hi>e._hi||this._hi===e._hi&&this._lo>=e._lo}},{key:"pow",value:function(e){if(e===0)return i.valueOf(1);var t=new i(this),n=i.valueOf(1),r=Math.abs(e);if(r>1)for(;r>0;)r%2==1&&n.selfMultiply(t),(r/=2)>0&&(t=t.sqr());else n=t;return e<0?n.reciprocal():n}},{key:"ceil",value:function(){if(this.isNaN())return i.NaN;var e=Math.ceil(this._hi),t=0;return e===this._hi&&(t=Math.ceil(this._lo)),new i(e,t)}},{key:"compareTo",value:function(e){var t=e;return this._hi<t._hi?-1:this._hi>t._hi?1:this._lo<t._lo?-1:this._lo>t._lo?1:0}},{key:"rint",value:function(){return this.isNaN()?this:this.add(.5).floor()}},{key:"setValue",value:function(){if(arguments[0]instanceof i){var e=arguments[0];return this.init(e),this}if(typeof arguments[0]=="number"){var t=arguments[0];return this.init(t),this}}},{key:"max",value:function(e){return this.ge(e)?this:e}},{key:"sqrt",value:function(){if(this.isZero())return i.valueOf(0);if(this.isNegative())return i.NaN;var e=1/Math.sqrt(this._hi),t=this._hi*e,n=i.valueOf(t),r=this.subtract(n.sqr())._hi*(.5*e);return n.add(r)}},{key:"selfAdd",value:function(){if(arguments.length===1){if(arguments[0]instanceof i){var e=arguments[0];return this.selfAdd(e._hi,e._lo)}if(typeof arguments[0]=="number"){var t,n,r,s,h,f=arguments[0],m=null;return m=(r=this._hi+f)-(s=r-this._hi),n=(h=(m=f-s+(this._hi-m))+this._lo)+(r-(t=r+h)),this._hi=t+n,this._lo=n+(t-this._hi),this}}else if(arguments.length===2){var _,P,G,$,Q=arguments[0],se=arguments[1],ae=null,de=null,me=null;G=this._hi+Q,P=this._lo+se,de=G-(me=G-this._hi),ae=P-($=P-this._lo);var ke=(_=G+(me=(de=Q-me+(this._hi-de))+P))+(me=(ae=se-$+(this._lo-ae))+(me+(G-_))),Pe=me+(_-ke);return this._hi=ke,this._lo=Pe,this}}},{key:"selfMultiply",value:function(){if(arguments.length===1){if(arguments[0]instanceof i){var e=arguments[0];return this.selfMultiply(e._hi,e._lo)}if(typeof arguments[0]=="number"){var t=arguments[0];return this.selfMultiply(t,0)}}else if(arguments.length===2){var n,r,s=arguments[0],h=arguments[1],f=null,m=null,_=null,P=null;f=(_=i.SPLIT*this._hi)-this._hi,P=i.SPLIT*s,f=_-f,n=this._hi-f,m=P-s;var G=(_=this._hi*s)+(P=f*(m=P-m)-_+f*(r=s-m)+n*m+n*r+(this._hi*h+this._lo*s)),$=P+(f=_-G);return this._hi=G,this._lo=$,this}}},{key:"selfSqr",value:function(){return this.selfMultiply(this)}},{key:"floor",value:function(){if(this.isNaN())return i.NaN;var e=Math.floor(this._hi),t=0;return e===this._hi&&(t=Math.floor(this._lo)),new i(e,t)}},{key:"negate",value:function(){return this.isNaN()?this:new i(-this._hi,-this._lo)}},{key:"clone",value:function(){try{return null}catch(e){if(e instanceof CloneNotSupportedException)return null;throw e}}},{key:"multiply",value:function(){if(arguments[0]instanceof i){var e=arguments[0];return e.isNaN()?i.createNaN():i.copy(this).selfMultiply(e)}if(typeof arguments[0]=="number"){var t=arguments[0];return z.isNaN(t)?i.createNaN():i.copy(this).selfMultiply(t,0)}}},{key:"isNaN",value:function(){return z.isNaN(this._hi)}},{key:"intValue",value:function(){return Math.trunc(this._hi)}},{key:"toString",value:function(){var e=i.magnitude(this._hi);return e>=-3&&e<=20?this.toStandardNotation():this.toSciNotation()}},{key:"toStandardNotation",value:function(){var e=this.getSpecialNumberString();if(e!==null)return e;var t=new Array(1).fill(null),n=this.extractSignificantDigits(!0,t),r=t[0]+1,s=n;if(n.charAt(0)===".")s="0"+n;else if(r<0)s="0."+i.stringOfChar("0",-r)+n;else if(n.indexOf(".")===-1){var h=r-n.length;s=n+i.stringOfChar("0",h)+".0"}return this.isNegative()?"-"+s:s}},{key:"reciprocal",value:function(){var e,t,n,r,s=null,h=null,f=null,m=null;e=(n=1/this._hi)-(s=(f=i.SPLIT*n)-(s=f-n)),h=(m=i.SPLIT*this._hi)-this._hi;var _=n+(f=(1-(r=n*this._hi)-(m=s*(h=m-h)-r+s*(t=this._hi-h)+e*h+e*t)-n*this._lo)/this._hi);return new i(_,n-_+f)}},{key:"toSciNotation",value:function(){if(this.isZero())return i.SCI_NOT_ZERO;var e=this.getSpecialNumberString();if(e!==null)return e;var t=new Array(1).fill(null),n=this.extractSignificantDigits(!1,t),r=i.SCI_NOT_EXPONENT_CHAR+t[0];if(n.charAt(0)==="0")throw new IllegalStateException("Found leading zero: "+n);var s="";n.length>1&&(s=n.substring(1));var h=n.charAt(0)+"."+s;return this.isNegative()?"-"+h+r:h+r}},{key:"abs",value:function(){return this.isNaN()?i.NaN:this.isNegative()?this.negate():new i(this)}},{key:"isPositive",value:function(){return this._hi>0||this._hi===0&&this._lo>0}},{key:"lt",value:function(e){return this._hi<e._hi||this._hi===e._hi&&this._lo<e._lo}},{key:"add",value:function(){if(arguments[0]instanceof i){var e=arguments[0];return i.copy(this).selfAdd(e)}if(typeof arguments[0]=="number"){var t=arguments[0];return i.copy(this).selfAdd(t)}}},{key:"init",value:function(){if(arguments.length===1){if(typeof arguments[0]=="number"){var e=arguments[0];this._hi=e,this._lo=0}else if(arguments[0]instanceof i){var t=arguments[0];this._hi=t._hi,this._lo=t._lo}}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this._hi=n,this._lo=r}}},{key:"gt",value:function(e){return this._hi>e._hi||this._hi===e._hi&&this._lo>e._lo}},{key:"isNegative",value:function(){return this._hi<0||this._hi===0&&this._lo<0}},{key:"trunc",value:function(){return this.isNaN()?i.NaN:this.isPositive()?this.floor():this.ceil()}},{key:"signum",value:function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0}},{key:"interfaces_",get:function(){return[v,ie,y]}}],[{key:"constructor_",value:function(){if(this._hi=0,this._lo=0,arguments.length===0)this.init(0);else if(arguments.length===1){if(typeof arguments[0]=="number"){var e=arguments[0];this.init(e)}else if(arguments[0]instanceof i){var t=arguments[0];this.init(t)}else if(typeof arguments[0]=="string"){var n=arguments[0];i.constructor_.call(this,i.parse(n))}}else if(arguments.length===2){var r=arguments[0],s=arguments[1];this.init(r,s)}}},{key:"determinant",value:function(){if(typeof arguments[3]=="number"&&typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var e=arguments[0],t=arguments[1],n=arguments[2],r=arguments[3];return i.determinant(i.valueOf(e),i.valueOf(t),i.valueOf(n),i.valueOf(r))}if(arguments[3]instanceof i&&arguments[2]instanceof i&&arguments[0]instanceof i&&arguments[1]instanceof i){var s=arguments[1],h=arguments[2],f=arguments[3];return arguments[0].multiply(f).selfSubtract(s.multiply(h))}}},{key:"sqr",value:function(e){return i.valueOf(e).selfMultiply(e)}},{key:"valueOf",value:function(){if(typeof arguments[0]=="string"){var e=arguments[0];return i.parse(e)}if(typeof arguments[0]=="number")return new i(arguments[0])}},{key:"sqrt",value:function(e){return i.valueOf(e).sqrt()}},{key:"parse",value:function(e){for(var t=0,n=e.length;zn.isWhitespace(e.charAt(t));)t++;var r=!1;if(t<n){var s=e.charAt(t);s!=="-"&&s!=="+"||(t++,s==="-"&&(r=!0))}for(var h=new i,f=0,m=0,_=0,P=!1;!(t>=n);){var G=e.charAt(t);if(t++,zn.isDigit(G)){var $=G-"0";h.selfMultiply(i.TEN),h.selfAdd($),f++}else{if(G!=="."){if(G==="e"||G==="E"){var Q=e.substring(t);try{_=an.parseInt(Q)}catch(ke){throw ke instanceof NumberFormatException?new NumberFormatException("Invalid exponent "+Q+" in string "+e):ke}break}throw new NumberFormatException("Unexpected character '"+G+"' at position "+t+" in string "+e)}m=f,P=!0}}var se=h;P||(m=f);var ae=f-m-_;if(ae===0)se=h;else if(ae>0){var de=i.TEN.pow(ae);se=h.divide(de)}else if(ae<0){var me=i.TEN.pow(-ae);se=h.multiply(me)}return r?se.negate():se}},{key:"createNaN",value:function(){return new i(z.NaN,z.NaN)}},{key:"copy",value:function(e){return new i(e)}},{key:"magnitude",value:function(e){var t=Math.abs(e),n=Math.log(t)/Math.log(10),r=Math.trunc(Math.floor(n));return 10*Math.pow(10,r)<=t&&(r+=1),r}},{key:"stringOfChar",value:function(e,t){for(var n=new Ut,r=0;r<t;r++)n.append(e);return n.toString()}}])}();le.PI=new le(3.141592653589793,12246467991473532e-32),le.TWO_PI=new le(6.283185307179586,24492935982947064e-32),le.PI_2=new le(1.5707963267948966,6123233995736766e-32),le.E=new le(2.718281828459045,14456468917292502e-32),le.NaN=new le(z.NaN,z.NaN),le.EPS=123259516440783e-46,le.SPLIT=134217729,le.MAX_PRINT_DIGITS=32,le.TEN=le.valueOf(10),le.ONE=le.valueOf(1),le.SCI_NOT_EXPONENT_CHAR="E",le.SCI_NOT_ZERO="0.0E0";var Yn=function(){function i(){o(this,i)}return g(i,null,[{key:"orientationIndex",value:function(e,t,n){var r=i.orientationIndexFilter(e,t,n);if(r<=1)return r;var s=le.valueOf(t.x).selfAdd(-e.x),h=le.valueOf(t.y).selfAdd(-e.y),f=le.valueOf(n.x).selfAdd(-t.x),m=le.valueOf(n.y).selfAdd(-t.y);return s.selfMultiply(m).selfSubtract(h.selfMultiply(f)).signum()}},{key:"signOfDet2x2",value:function(){if(arguments[3]instanceof le&&arguments[2]instanceof le&&arguments[0]instanceof le&&arguments[1]instanceof le){var e=arguments[1],t=arguments[2],n=arguments[3];return arguments[0].multiply(n).selfSubtract(e.multiply(t)).signum()}if(typeof arguments[3]=="number"&&typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var r=arguments[0],s=arguments[1],h=arguments[2],f=arguments[3],m=le.valueOf(r),_=le.valueOf(s),P=le.valueOf(h),G=le.valueOf(f);return m.multiply(G).selfSubtract(_.multiply(P)).signum()}}},{key:"intersection",value:function(e,t,n,r){var s=new le(e.y).selfSubtract(t.y),h=new le(t.x).selfSubtract(e.x),f=new le(e.x).selfMultiply(t.y).selfSubtract(new le(t.x).selfMultiply(e.y)),m=new le(n.y).selfSubtract(r.y),_=new le(r.x).selfSubtract(n.x),P=new le(n.x).selfMultiply(r.y).selfSubtract(new le(r.x).selfMultiply(n.y)),G=h.multiply(P).selfSubtract(_.multiply(f)),$=m.multiply(f).selfSubtract(s.multiply(P)),Q=s.multiply(_).selfSubtract(m.multiply(h)),se=G.selfDivide(Q).doubleValue(),ae=$.selfDivide(Q).doubleValue();return z.isNaN(se)||z.isInfinite(se)||z.isNaN(ae)||z.isInfinite(ae)?null:new F(se,ae)}},{key:"orientationIndexFilter",value:function(e,t,n){var r=null,s=(e.x-n.x)*(t.y-n.y),h=(e.y-n.y)*(t.x-n.x),f=s-h;if(s>0){if(h<=0)return i.signum(f);r=s+h}else{if(!(s<0)||h>=0)return i.signum(f);r=-s-h}var m=i.DP_SAFE_EPSILON*r;return f>=m||-f>=m?i.signum(f):2}},{key:"signum",value:function(e){return e>0?1:e<0?-1:0}}])}();Yn.DP_SAFE_EPSILON=1e-15;var ye=function(){return g(function i(){o(this,i)},[{key:"getM",value:function(i){if(this.hasM()){var e=this.getDimension()-this.getMeasures();return this.getOrdinate(i,e)}return z.NaN}},{key:"setOrdinate",value:function(i,e,t){}},{key:"getZ",value:function(i){return this.hasZ()?this.getOrdinate(i,2):z.NaN}},{key:"size",value:function(){}},{key:"getOrdinate",value:function(i,e){}},{key:"getCoordinate",value:function(){}},{key:"getCoordinateCopy",value:function(i){}},{key:"createCoordinate",value:function(){}},{key:"getDimension",value:function(){}},{key:"hasM",value:function(){return this.getMeasures()>0}},{key:"getX",value:function(i){}},{key:"hasZ",value:function(){return this.getDimension()-this.getMeasures()>2}},{key:"getMeasures",value:function(){return 0}},{key:"expandEnvelope",value:function(i){}},{key:"copy",value:function(){}},{key:"getY",value:function(i){}},{key:"toCoordinateArray",value:function(){}},{key:"interfaces_",get:function(){return[y]}}])}();ye.X=0,ye.Y=1,ye.Z=2,ye.M=3;var he=function(){function i(){o(this,i)}return g(i,null,[{key:"index",value:function(e,t,n){return Yn.orientationIndex(e,t,n)}},{key:"isCCW",value:function(){if(arguments[0]instanceof Array){var e=arguments[0],t=e.length-1;if(t<3)throw new W("Ring has fewer than 4 points, so orientation cannot be determined");for(var n=e[0],r=0,s=1;s<=t;s++){var h=e[s];h.y>n.y&&(n=h,r=s)}var f=r;do(f-=1)<0&&(f=t);while(e[f].equals2D(n)&&f!==r);var m=r;do m=(m+1)%t;while(e[m].equals2D(n)&&m!==r);var _=e[f],P=e[m];if(_.equals2D(n)||P.equals2D(n)||_.equals2D(P))return!1;var G=i.index(_,n,P);return G===0?_.x>P.x:G>0}if(ge(arguments[0],ye)){var $=arguments[0],Q=$.size()-1;if(Q<3)throw new W("Ring has fewer than 4 points, so orientation cannot be determined");for(var se=$.getCoordinate(0),ae=0,de=1;de<=Q;de++){var me=$.getCoordinate(de);me.y>se.y&&(se=me,ae=de)}var ke=null,Pe=ae;do(Pe-=1)<0&&(Pe=Q),ke=$.getCoordinate(Pe);while(ke.equals2D(se)&&Pe!==ae);var Ae=null,Tt=ae;do Tt=(Tt+1)%Q,Ae=$.getCoordinate(Tt);while(Ae.equals2D(se)&&Tt!==ae);if(ke.equals2D(se)||Ae.equals2D(se)||ke.equals2D(Ae))return!1;var Kt=i.index(ke,se,Ae);return Kt===0?ke.x>Ae.x:Kt>0}}}])}();he.CLOCKWISE=-1,he.RIGHT=he.CLOCKWISE,he.COUNTERCLOCKWISE=1,he.LEFT=he.COUNTERCLOCKWISE,he.COLLINEAR=0,he.STRAIGHT=he.COLLINEAR;var ks=function(){return g(function i(){o(this,i),i.constructor_.apply(this,arguments)},[{key:"getCoordinate",value:function(){return this._minCoord}},{key:"getRightmostSide",value:function(i,e){var t=this.getRightmostSideOfSegment(i,e);return t<0&&(t=this.getRightmostSideOfSegment(i,e-1)),t<0&&(this._minCoord=null,this.checkForRightmostCoordinate(i)),t}},{key:"findRightmostEdgeAtVertex",value:function(){var i=this._minDe.getEdge().getCoordinates();ne.isTrue(this._minIndex>0&&this._minIndex<i.length,"rightmost point expected to be interior vertex of edge");var e=i[this._minIndex-1],t=i[this._minIndex+1],n=he.index(this._minCoord,t,e),r=!1;(e.y<this._minCoord.y&&t.y<this._minCoord.y&&n===he.COUNTERCLOCKWISE||e.y>this._minCoord.y&&t.y>this._minCoord.y&&n===he.CLOCKWISE)&&(r=!0),r&&(this._minIndex=this._minIndex-1)}},{key:"getRightmostSideOfSegment",value:function(i,e){var t=i.getEdge().getCoordinates();if(e<0||e+1>=t.length||t[e].y===t[e+1].y)return-1;var n=H.LEFT;return t[e].y<t[e+1].y&&(n=H.RIGHT),n}},{key:"getEdge",value:function(){return this._orientedDe}},{key:"checkForRightmostCoordinate",value:function(i){for(var e=i.getEdge().getCoordinates(),t=0;t<e.length-1;t++)(this._minCoord===null||e[t].x>this._minCoord.x)&&(this._minDe=i,this._minIndex=t,this._minCoord=e[t])}},{key:"findRightmostEdgeAtNode",value:function(){var i=this._minDe.getNode().getEdges();this._minDe=i.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)}},{key:"findEdge",value:function(i){for(var e=i.iterator();e.hasNext();){var t=e.next();t.isForward()&&this.checkForRightmostCoordinate(t)}ne.isTrue(this._minIndex!==0||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),this._minIndex===0?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===H.LEFT&&(this._orientedDe=this._minDe.getSym())}}],[{key:"constructor_",value:function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null}}])}(),ct=function(i){function e(t,n){var r;return o(this,e),(r=c(this,e,[n?t+" [ "+n+" ]":t])).pt=n?new F(n):void 0,r.name=Object.keys({TopologyException:e})[0],r}return N(e,i),g(e,[{key:"getCoordinate",value:function(){return this.pt}}])}(te),Is=function(){return g(function i(){o(this,i),this.array=[]},[{key:"addLast",value:function(i){this.array.push(i)}},{key:"removeFirst",value:function(){return this.array.shift()}},{key:"isEmpty",value:function(){return this.array.length===0}}])}(),ue=function(i){function e(t){var n;return o(this,e),(n=c(this,e)).array=[],t instanceof we&&n.addAll(t),n}return N(e,i),g(e,[{key:"interfaces_",get:function(){return[xt,we]}},{key:"ensureCapacity",value:function(){}},{key:"add",value:function(t){return arguments.length===1?this.array.push(t):this.array.splice(arguments[0],0,arguments[1]),!0}},{key:"clear",value:function(){this.array=[]}},{key:"addAll",value:function(t){var n,r=C(t);try{for(r.s();!(n=r.n()).done;){var s=n.value;this.array.push(s)}}catch(h){r.e(h)}finally{r.f()}}},{key:"set",value:function(t,n){var r=this.array[t];return this.array[t]=n,r}},{key:"iterator",value:function(){return new Ns(this)}},{key:"get",value:function(t){if(t<0||t>=this.size())throw new wi;return this.array[t]}},{key:"isEmpty",value:function(){return this.array.length===0}},{key:"sort",value:function(t){t?this.array.sort(function(n,r){return t.compare(n,r)}):this.array.sort()}},{key:"size",value:function(){return this.array.length}},{key:"toArray",value:function(){return this.array.slice()}},{key:"remove",value:function(t){for(var n=0,r=this.array.length;n<r;n++)if(this.array[n]===t)return!!this.array.splice(n,1);return!1}},{key:Symbol.iterator,value:function(){return this.array.values()}}])}(xt),Ns=function(){return g(function i(e){o(this,i),this.arrayList=e,this.position=0},[{key:"next",value:function(){if(this.position===this.arrayList.size())throw new Ce;return this.arrayList.get(this.position++)}},{key:"hasNext",value:function(){return this.position<this.arrayList.size()}},{key:"set",value:function(i){return this.arrayList.set(this.position-1,i)}},{key:"remove",value:function(){this.arrayList.remove(this.arrayList.get(this.position))}}])}(),ws=function(){return g(function i(){o(this,i),i.constructor_.apply(this,arguments)},[{key:"clearVisitedEdges",value:function(){for(var i=this._dirEdgeList.iterator();i.hasNext();)i.next().setVisited(!1)}},{key:"getRightmostCoordinate",value:function(){return this._rightMostCoord}},{key:"computeNodeDepth",value:function(i){for(var e=null,t=i.getEdges().iterator();t.hasNext();){var n=t.next();if(n.isVisited()||n.getSym().isVisited()){e=n;break}}if(e===null)throw new ct("unable to find edge to compute depths at "+i.getCoordinate());i.getEdges().computeDepths(e);for(var r=i.getEdges().iterator();r.hasNext();){var s=r.next();s.setVisited(!0),this.copySymDepths(s)}}},{key:"computeDepth",value:function(i){this.clearVisitedEdges();var e=this._finder.getEdge();e.getNode(),e.getLabel(),e.setEdgeDepths(H.RIGHT,i),this.copySymDepths(e),this.computeDepths(e)}},{key:"create",value:function(i){this.addReachable(i),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()}},{key:"findResultEdges",value:function(){for(var i=this._dirEdgeList.iterator();i.hasNext();){var e=i.next();e.getDepth(H.RIGHT)>=1&&e.getDepth(H.LEFT)<=0&&!e.isInteriorAreaEdge()&&e.setInResult(!0)}}},{key:"computeDepths",value:function(i){var e=new Bn,t=new Is,n=i.getNode();for(t.addLast(n),e.add(n),i.setVisited(!0);!t.isEmpty();){var r=t.removeFirst();e.add(r),this.computeNodeDepth(r);for(var s=r.getEdges().iterator();s.hasNext();){var h=s.next().getSym();if(!h.isVisited()){var f=h.getNode();e.contains(f)||(t.addLast(f),e.add(f))}}}}},{key:"compareTo",value:function(i){var e=i;return this._rightMostCoord.x<e._rightMostCoord.x?-1:this._rightMostCoord.x>e._rightMostCoord.x?1:0}},{key:"getEnvelope",value:function(){if(this._env===null){for(var i=new Ee,e=this._dirEdgeList.iterator();e.hasNext();)for(var t=e.next().getEdge().getCoordinates(),n=0;n<t.length-1;n++)i.expandToInclude(t[n]);this._env=i}return this._env}},{key:"addReachable",value:function(i){var e=new Es;for(e.add(i);!e.empty();){var t=e.pop();this.add(t,e)}}},{key:"copySymDepths",value:function(i){var e=i.getSym();e.setDepth(H.LEFT,i.getDepth(H.RIGHT)),e.setDepth(H.RIGHT,i.getDepth(H.LEFT))}},{key:"add",value:function(i,e){i.setVisited(!0),this._nodes.add(i);for(var t=i.getEdges().iterator();t.hasNext();){var n=t.next();this._dirEdgeList.add(n);var r=n.getSym().getNode();r.isVisited()||e.push(r)}}},{key:"getNodes",value:function(){return this._nodes}},{key:"getDirectedEdges",value:function(){return this._dirEdgeList}},{key:"interfaces_",get:function(){return[ie]}}],[{key:"constructor_",value:function(){this._finder=null,this._dirEdgeList=new ue,this._nodes=new ue,this._rightMostCoord=null,this._env=null,this._finder=new ks}}])}(),Un=function(){return g(function i(){o(this,i)},null,[{key:"intersection",value:function(i,e,t,n){var r=i.x<e.x?i.x:e.x,s=i.y<e.y?i.y:e.y,h=i.x>e.x?i.x:e.x,f=i.y>e.y?i.y:e.y,m=t.x<n.x?t.x:n.x,_=t.y<n.y?t.y:n.y,P=t.x>n.x?t.x:n.x,G=t.y>n.y?t.y:n.y,$=((r>m?r:m)+(h<P?h:P))/2,Q=((s>_?s:_)+(f<G?f:G))/2,se=i.x-$,ae=i.y-Q,de=e.x-$,me=e.y-Q,ke=t.x-$,Pe=t.y-Q,Ae=n.x-$,Tt=n.y-Q,Kt=ae-me,cr=de-se,fr=se*me-de*ae,gr=Pe-Tt,mr=Ae-ke,yr=ke*Tt-Ae*Pe,dr=Kt*mr-gr*cr,si=(cr*yr-mr*fr)/dr,ai=(gr*fr-Kt*yr)/dr;return z.isNaN(si)||z.isInfinite(si)||z.isNaN(ai)||z.isInfinite(ai)?null:new F(si+$,ai+Q)}}])}(),Xe=function(){return g(function i(){o(this,i)},null,[{key:"arraycopy",value:function(i,e,t,n,r){for(var s=0,h=e;h<e+r;h++)t[n+s]=i[h],s++}},{key:"getProperty",value:function(i){return{"line.separator":`
`}[i]}}])}(),Xt=function(){function i(){o(this,i)}return g(i,null,[{key:"log10",value:function(e){var t=Math.log(e);return z.isInfinite(t)||z.isNaN(t)?t:t/i.LOG_10}},{key:"min",value:function(e,t,n,r){var s=e;return t<s&&(s=t),n<s&&(s=n),r<s&&(s=r),s}},{key:"clamp",value:function(){if(typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var e=arguments[0],t=arguments[1],n=arguments[2];return e<t?t:e>n?n:e}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var r=arguments[0],s=arguments[1],h=arguments[2];return r<s?s:r>h?h:r}}},{key:"wrap",value:function(e,t){return e<0?t- -e%t:e%t}},{key:"max",value:function(){if(arguments.length===3){var e=arguments[1],t=arguments[2],n=arguments[0];return e>n&&(n=e),t>n&&(n=t),n}if(arguments.length===4){var r=arguments[1],s=arguments[2],h=arguments[3],f=arguments[0];return r>f&&(f=r),s>f&&(f=s),h>f&&(f=h),f}}},{key:"average",value:function(e,t){return(e+t)/2}}])}();Xt.LOG_10=Math.log(10);var it=function(){function i(){o(this,i)}return g(i,null,[{key:"segmentToSegment",value:function(e,t,n,r){if(e.equals(t))return i.pointToSegment(e,n,r);if(n.equals(r))return i.pointToSegment(r,e,t);var s=!1;if(Ee.intersects(e,t,n,r)){var h=(t.x-e.x)*(r.y-n.y)-(t.y-e.y)*(r.x-n.x);if(h===0)s=!0;else{var f=(e.y-n.y)*(r.x-n.x)-(e.x-n.x)*(r.y-n.y),m=((e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y))/h,_=f/h;(_<0||_>1||m<0||m>1)&&(s=!0)}}else s=!0;return s?Xt.min(i.pointToSegment(e,n,r),i.pointToSegment(t,n,r),i.pointToSegment(n,e,t),i.pointToSegment(r,e,t)):0}},{key:"pointToSegment",value:function(e,t,n){if(t.x===n.x&&t.y===n.y)return e.distance(t);var r=(n.x-t.x)*(n.x-t.x)+(n.y-t.y)*(n.y-t.y),s=((e.x-t.x)*(n.x-t.x)+(e.y-t.y)*(n.y-t.y))/r;if(s<=0)return e.distance(t);if(s>=1)return e.distance(n);var h=((t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y))/r;return Math.abs(h)*Math.sqrt(r)}},{key:"pointToLinePerpendicular",value:function(e,t,n){var r=(n.x-t.x)*(n.x-t.x)+(n.y-t.y)*(n.y-t.y),s=((t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y))/r;return Math.abs(s)*Math.sqrt(r)}},{key:"pointToSegmentString",value:function(e,t){if(t.length===0)throw new W("Line array must contain at least one vertex");for(var n=e.distance(t[0]),r=0;r<t.length-1;r++){var s=i.pointToSegment(e,t[r],t[r+1]);s<n&&(n=s)}return n}}])}(),Si=function(){return g(function i(){o(this,i)},[{key:"create",value:function(){if(arguments.length===1)arguments[0]instanceof Array||ge(arguments[0],ye);else if(arguments.length!==2){if(arguments.length===3){var i=arguments[0],e=arguments[1];return this.create(i,e)}}}}])}(),on=function(){return g(function i(){o(this,i)},[{key:"filter",value:function(i){}}])}(),Ss=function(){return g(function i(){o(this,i)},null,[{key:"ofLine",value:function(i){var e=i.size();if(e<=1)return 0;var t=0,n=new F;i.getCoordinate(0,n);for(var r=n.x,s=n.y,h=1;h<e;h++){i.getCoordinate(h,n);var f=n.x,m=n.y,_=f-r,P=m-s;t+=Math.sqrt(_*_+P*P),r=f,s=m}return t}}])}(),Ti=g(function i(){o(this,i)}),Et=function(){function i(){o(this,i)}return g(i,null,[{key:"copyCoord",value:function(e,t,n,r){for(var s=Math.min(e.getDimension(),n.getDimension()),h=0;h<s;h++)n.setOrdinate(r,h,e.getOrdinate(t,h))}},{key:"isRing",value:function(e){var t=e.size();return t===0||!(t<=3)&&e.getOrdinate(0,ye.X)===e.getOrdinate(t-1,ye.X)&&e.getOrdinate(0,ye.Y)===e.getOrdinate(t-1,ye.Y)}},{key:"scroll",value:function(){if(arguments.length===2){if(ge(arguments[0],ye)&&Number.isInteger(arguments[1])){var e=arguments[0],t=arguments[1];i.scroll(e,t,i.isRing(e))}else if(ge(arguments[0],ye)&&arguments[1]instanceof F){var n=arguments[0],r=arguments[1],s=i.indexOf(r,n);if(s<=0)return null;i.scroll(n,s)}}else if(arguments.length===3){var h=arguments[0],f=arguments[1],m=arguments[2];if(f<=0)return null;for(var _=h.copy(),P=m?h.size()-1:h.size(),G=0;G<P;G++)for(var $=0;$<h.getDimension();$++)h.setOrdinate(G,$,_.getOrdinate((f+G)%P,$));if(m)for(var Q=0;Q<h.getDimension();Q++)h.setOrdinate(P,Q,h.getOrdinate(0,Q))}}},{key:"isEqual",value:function(e,t){var n=e.size();if(n!==t.size())return!1;for(var r=Math.min(e.getDimension(),t.getDimension()),s=0;s<n;s++)for(var h=0;h<r;h++){var f=e.getOrdinate(s,h),m=t.getOrdinate(s,h);if(e.getOrdinate(s,h)!==t.getOrdinate(s,h)&&(!z.isNaN(f)||!z.isNaN(m)))return!1}return!0}},{key:"minCoordinateIndex",value:function(){if(arguments.length===1){var e=arguments[0];return i.minCoordinateIndex(e,0,e.size()-1)}if(arguments.length===3){for(var t=arguments[0],n=arguments[2],r=-1,s=null,h=arguments[1];h<=n;h++){var f=t.getCoordinate(h);(s===null||s.compareTo(f)>0)&&(s=f,r=h)}return r}}},{key:"extend",value:function(e,t,n){var r=e.create(n,t.getDimension()),s=t.size();if(i.copy(t,0,r,0,s),s>0)for(var h=s;h<n;h++)i.copy(t,s-1,r,h,1);return r}},{key:"reverse",value:function(e){for(var t=e.size()-1,n=Math.trunc(t/2),r=0;r<=n;r++)i.swap(e,r,t-r)}},{key:"swap",value:function(e,t,n){if(t===n)return null;for(var r=0;r<e.getDimension();r++){var s=e.getOrdinate(t,r);e.setOrdinate(t,r,e.getOrdinate(n,r)),e.setOrdinate(n,r,s)}}},{key:"copy",value:function(e,t,n,r,s){for(var h=0;h<s;h++)i.copyCoord(e,t+h,n,r+h)}},{key:"ensureValidRing",value:function(e,t){var n=t.size();return n===0?t:n<=3?i.createClosedRing(e,t,4):t.getOrdinate(0,ye.X)===t.getOrdinate(n-1,ye.X)&&t.getOrdinate(0,ye.Y)===t.getOrdinate(n-1,ye.Y)?t:i.createClosedRing(e,t,n+1)}},{key:"indexOf",value:function(e,t){for(var n=0;n<t.size();n++)if(e.x===t.getOrdinate(n,ye.X)&&e.y===t.getOrdinate(n,ye.Y))return n;return-1}},{key:"createClosedRing",value:function(e,t,n){var r=e.create(n,t.getDimension()),s=t.size();i.copy(t,0,r,0,s);for(var h=s;h<n;h++)i.copy(t,0,r,h,1);return r}},{key:"minCoordinate",value:function(e){for(var t=null,n=0;n<e.size();n++){var r=e.getCoordinate(n);(t===null||t.compareTo(r)>0)&&(t=r)}return t}}])}(),J=function(){function i(){o(this,i)}return g(i,null,[{key:"toDimensionSymbol",value:function(e){switch(e){case i.FALSE:return i.SYM_FALSE;case i.TRUE:return i.SYM_TRUE;case i.DONTCARE:return i.SYM_DONTCARE;case i.P:return i.SYM_P;case i.L:return i.SYM_L;case i.A:return i.SYM_A}throw new W("Unknown dimension value: "+e)}},{key:"toDimensionValue",value:function(e){switch(zn.toUpperCase(e)){case i.SYM_FALSE:return i.FALSE;case i.SYM_TRUE:return i.TRUE;case i.SYM_DONTCARE:return i.DONTCARE;case i.SYM_P:return i.P;case i.SYM_L:return i.L;case i.SYM_A:return i.A}throw new W("Unknown dimension symbol: "+e)}}])}();J.P=0,J.L=1,J.A=2,J.FALSE=-1,J.TRUE=-2,J.DONTCARE=-3,J.SYM_FALSE="F",J.SYM_TRUE="T",J.SYM_DONTCARE="*",J.SYM_P="0",J.SYM_L="1",J.SYM_A="2";var un=function(){return g(function i(){o(this,i)},[{key:"filter",value:function(i){}}])}(),ln=function(){return g(function i(){o(this,i)},[{key:"filter",value:function(i,e){}},{key:"isDone",value:function(){}},{key:"isGeometryChanged",value:function(){}}])}(),Vt=function(i){function e(){var t;return o(this,e),t=c(this,e),e.constructor_.apply(t,arguments),t}return N(e,i),g(e,[{key:"computeEnvelopeInternal",value:function(){return this.isEmpty()?new Ee:this._points.expandEnvelope(new Ee)}},{key:"isRing",value:function(){return this.isClosed()&&this.isSimple()}},{key:"getCoordinates",value:function(){return this._points.toCoordinateArray()}},{key:"copyInternal",value:function(){return new e(this._points.copy(),this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof re){var t=arguments[0],n=arguments[1];if(!this.isEquivalentClass(t))return!1;var r=t;if(this._points.size()!==r._points.size())return!1;for(var s=0;s<this._points.size();s++)if(!this.equal(this._points.getCoordinate(s),r._points.getCoordinate(s),n))return!1;return!0}return b(e,"equalsExact",this,1).apply(this,arguments)}},{key:"normalize",value:function(){for(var t=0;t<Math.trunc(this._points.size()/2);t++){var n=this._points.size()-1-t;if(!this._points.getCoordinate(t).equals(this._points.getCoordinate(n))){if(this._points.getCoordinate(t).compareTo(this._points.getCoordinate(n))>0){var r=this._points.copy();Et.reverse(r),this._points=r}return null}}}},{key:"getCoordinate",value:function(){return this.isEmpty()?null:this._points.getCoordinate(0)}},{key:"getBoundaryDimension",value:function(){return this.isClosed()?J.FALSE:0}},{key:"isClosed",value:function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))}},{key:"reverseInternal",value:function(){var t=this._points.copy();return Et.reverse(t),this.getFactory().createLineString(t)}},{key:"getEndPoint",value:function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)}},{key:"getTypeCode",value:function(){return re.TYPECODE_LINESTRING}},{key:"getDimension",value:function(){return 1}},{key:"getLength",value:function(){return Ss.ofLine(this._points)}},{key:"getNumPoints",value:function(){return this._points.size()}},{key:"compareToSameClass",value:function(){if(arguments.length===1){for(var t=arguments[0],n=0,r=0;n<this._points.size()&&r<t._points.size();){var s=this._points.getCoordinate(n).compareTo(t._points.getCoordinate(r));if(s!==0)return s;n++,r++}return n<this._points.size()?1:r<t._points.size()?-1:0}if(arguments.length===2){var h=arguments[0];return arguments[1].compare(this._points,h._points)}}},{key:"apply",value:function(){if(ge(arguments[0],on))for(var t=arguments[0],n=0;n<this._points.size();n++)t.filter(this._points.getCoordinate(n));else if(ge(arguments[0],ln)){var r=arguments[0];if(this._points.size()===0)return null;for(var s=0;s<this._points.size()&&(r.filter(this._points,s),!r.isDone());s++);r.isGeometryChanged()&&this.geometryChanged()}else ge(arguments[0],un)?arguments[0].filter(this):ge(arguments[0],K)&&arguments[0].filter(this)}},{key:"getBoundary",value:function(){throw new pe}},{key:"isEquivalentClass",value:function(t){return t instanceof e}},{key:"getCoordinateN",value:function(t){return this._points.getCoordinate(t)}},{key:"getGeometryType",value:function(){return re.TYPENAME_LINESTRING}},{key:"getCoordinateSequence",value:function(){return this._points}},{key:"isEmpty",value:function(){return this._points.size()===0}},{key:"init",value:function(t){if(t===null&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),t.size()===1)throw new W("Invalid number of points in LineString (found "+t.size()+" - must be 0 or >= 2)");this._points=t}},{key:"isCoordinate",value:function(t){for(var n=0;n<this._points.size();n++)if(this._points.getCoordinate(n).equals(t))return!0;return!1}},{key:"getStartPoint",value:function(){return this.isEmpty()?null:this.getPointN(0)}},{key:"getPointN",value:function(t){return this.getFactory().createPoint(this._points.getCoordinate(t))}},{key:"interfaces_",get:function(){return[Ti]}}],[{key:"constructor_",value:function(){if(this._points=null,arguments.length!==0){if(arguments.length===2){var t=arguments[0],n=arguments[1];re.constructor_.call(this,n),this.init(t)}}}}])}(re),Li=g(function i(){o(this,i)}),Xn=function(i){function e(){var t;return o(this,e),t=c(this,e),e.constructor_.apply(t,arguments),t}return N(e,i),g(e,[{key:"computeEnvelopeInternal",value:function(){if(this.isEmpty())return new Ee;var t=new Ee;return t.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),t}},{key:"getCoordinates",value:function(){return this.isEmpty()?[]:[this.getCoordinate()]}},{key:"copyInternal",value:function(){return new e(this._coordinates.copy(),this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof re){var t=arguments[0],n=arguments[1];return!!this.isEquivalentClass(t)&&(!(!this.isEmpty()||!t.isEmpty())||this.isEmpty()===t.isEmpty()&&this.equal(t.getCoordinate(),this.getCoordinate(),n))}return b(e,"equalsExact",this,1).apply(this,arguments)}},{key:"normalize",value:function(){}},{key:"getCoordinate",value:function(){return this._coordinates.size()!==0?this._coordinates.getCoordinate(0):null}},{key:"getBoundaryDimension",value:function(){return J.FALSE}},{key:"reverseInternal",value:function(){return this.getFactory().createPoint(this._coordinates.copy())}},{key:"getTypeCode",value:function(){return re.TYPECODE_POINT}},{key:"getDimension",value:function(){return 0}},{key:"getNumPoints",value:function(){return this.isEmpty()?0:1}},{key:"getX",value:function(){if(this.getCoordinate()===null)throw new IllegalStateException("getX called on empty Point");return this.getCoordinate().x}},{key:"compareToSameClass",value:function(){if(arguments.length===1){var t=arguments[0];return this.getCoordinate().compareTo(t.getCoordinate())}if(arguments.length===2){var n=arguments[0];return arguments[1].compare(this._coordinates,n._coordinates)}}},{key:"apply",value:function(){if(ge(arguments[0],on)){var t=arguments[0];if(this.isEmpty())return null;t.filter(this.getCoordinate())}else if(ge(arguments[0],ln)){var n=arguments[0];if(this.isEmpty())return null;n.filter(this._coordinates,0),n.isGeometryChanged()&&this.geometryChanged()}else ge(arguments[0],un)?arguments[0].filter(this):ge(arguments[0],K)&&arguments[0].filter(this)}},{key:"getBoundary",value:function(){return this.getFactory().createGeometryCollection()}},{key:"getGeometryType",value:function(){return re.TYPENAME_POINT}},{key:"getCoordinateSequence",value:function(){return this._coordinates}},{key:"getY",value:function(){if(this.getCoordinate()===null)throw new IllegalStateException("getY called on empty Point");return this.getCoordinate().y}},{key:"isEmpty",value:function(){return this._coordinates.size()===0}},{key:"init",value:function(t){t===null&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),ne.isTrue(t.size()<=1),this._coordinates=t}},{key:"isSimple",value:function(){return!0}},{key:"interfaces_",get:function(){return[Li]}}],[{key:"constructor_",value:function(){this._coordinates=null;var t=arguments[0],n=arguments[1];re.constructor_.call(this,n),this.init(t)}}])}(re),Ci=function(){function i(){o(this,i)}return g(i,null,[{key:"ofRing",value:function(){if(arguments[0]instanceof Array){var e=arguments[0];return Math.abs(i.ofRingSigned(e))}if(ge(arguments[0],ye)){var t=arguments[0];return Math.abs(i.ofRingSigned(t))}}},{key:"ofRingSigned",value:function(){if(arguments[0]instanceof Array){var e=arguments[0];if(e.length<3)return 0;for(var t=0,n=e[0].x,r=1;r<e.length-1;r++){var s=e[r].x-n,h=e[r+1].y;t+=s*(e[r-1].y-h)}return t/2}if(ge(arguments[0],ye)){var f=arguments[0],m=f.size();if(m<3)return 0;var _=new F,P=new F,G=new F;f.getCoordinate(0,P),f.getCoordinate(1,G);var $=P.x;G.x-=$;for(var Q=0,se=1;se<m-1;se++)_.y=P.y,P.x=G.x,P.y=G.y,f.getCoordinate(se+1,G),G.x-=$,Q+=P.x*(_.y-G.y);return Q/2}}}])}(),kt=function(){return g(function i(){o(this,i)},null,[{key:"sort",value:function(){var i=arguments,e=arguments[0];if(arguments.length===1)e.sort(function($,Q){return $.compareTo(Q)});else if(arguments.length===2)e.sort(function($,Q){return i[1].compare($,Q)});else if(arguments.length===3){var t=e.slice(arguments[1],arguments[2]);t.sort();var n=e.slice(0,arguments[1]).concat(t,e.slice(arguments[2],e.length));e.splice(0,e.length);var r,s=C(n);try{for(s.s();!(r=s.n()).done;){var h=r.value;e.push(h)}}catch($){s.e($)}finally{s.f()}}else if(arguments.length===4){var f=e.slice(arguments[1],arguments[2]);f.sort(function($,Q){return i[3].compare($,Q)});var m=e.slice(0,arguments[1]).concat(f,e.slice(arguments[2],e.length));e.splice(0,e.length);var _,P=C(m);try{for(P.s();!(_=P.n()).done;){var G=_.value;e.push(G)}}catch($){P.e($)}finally{P.f()}}}},{key:"asList",value:function(i){var e,t=new ue,n=C(i);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.add(r)}}catch(s){n.e(s)}finally{n.f()}return t}},{key:"copyOf",value:function(i,e){return i.slice(0,e)}}])}(),Ri=g(function i(){o(this,i)}),hn=function(i){function e(){var t;return o(this,e),t=c(this,e),e.constructor_.apply(t,arguments),t}return N(e,i),g(e,[{key:"computeEnvelopeInternal",value:function(){return this._shell.getEnvelopeInternal()}},{key:"getCoordinates",value:function(){if(this.isEmpty())return[];for(var t=new Array(this.getNumPoints()).fill(null),n=-1,r=this._shell.getCoordinates(),s=0;s<r.length;s++)t[++n]=r[s];for(var h=0;h<this._holes.length;h++)for(var f=this._holes[h].getCoordinates(),m=0;m<f.length;m++)t[++n]=f[m];return t}},{key:"getArea",value:function(){var t=0;t+=Ci.ofRing(this._shell.getCoordinateSequence());for(var n=0;n<this._holes.length;n++)t-=Ci.ofRing(this._holes[n].getCoordinateSequence());return t}},{key:"copyInternal",value:function(){for(var t=this._shell.copy(),n=new Array(this._holes.length).fill(null),r=0;r<this._holes.length;r++)n[r]=this._holes[r].copy();return new e(t,n,this._factory)}},{key:"isRectangle",value:function(){if(this.getNumInteriorRing()!==0||this._shell===null||this._shell.getNumPoints()!==5)return!1;for(var t=this._shell.getCoordinateSequence(),n=this.getEnvelopeInternal(),r=0;r<5;r++){var s=t.getX(r);if(s!==n.getMinX()&&s!==n.getMaxX())return!1;var h=t.getY(r);if(h!==n.getMinY()&&h!==n.getMaxY())return!1}for(var f=t.getX(0),m=t.getY(0),_=1;_<=4;_++){var P=t.getX(_),G=t.getY(_);if(P!==f==(G!==m))return!1;f=P,m=G}return!0}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof re){var t=arguments[0],n=arguments[1];if(!this.isEquivalentClass(t))return!1;var r=t,s=this._shell,h=r._shell;if(!s.equalsExact(h,n)||this._holes.length!==r._holes.length)return!1;for(var f=0;f<this._holes.length;f++)if(!this._holes[f].equalsExact(r._holes[f],n))return!1;return!0}return b(e,"equalsExact",this,1).apply(this,arguments)}},{key:"normalize",value:function(){if(arguments.length===0){this._shell=this.normalized(this._shell,!0);for(var t=0;t<this._holes.length;t++)this._holes[t]=this.normalized(this._holes[t],!1);kt.sort(this._holes)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];if(n.isEmpty())return null;var s=n.getCoordinateSequence(),h=Et.minCoordinateIndex(s,0,s.size()-2);Et.scroll(s,h,!0),he.isCCW(s)===r&&Et.reverse(s)}}},{key:"getCoordinate",value:function(){return this._shell.getCoordinate()}},{key:"getNumInteriorRing",value:function(){return this._holes.length}},{key:"getBoundaryDimension",value:function(){return 1}},{key:"reverseInternal",value:function(){for(var t=this.getExteriorRing().reverse(),n=new Array(this.getNumInteriorRing()).fill(null),r=0;r<n.length;r++)n[r]=this.getInteriorRingN(r).reverse();return this.getFactory().createPolygon(t,n)}},{key:"getTypeCode",value:function(){return re.TYPECODE_POLYGON}},{key:"getDimension",value:function(){return 2}},{key:"getLength",value:function(){var t=0;t+=this._shell.getLength();for(var n=0;n<this._holes.length;n++)t+=this._holes[n].getLength();return t}},{key:"getNumPoints",value:function(){for(var t=this._shell.getNumPoints(),n=0;n<this._holes.length;n++)t+=this._holes[n].getNumPoints();return t}},{key:"convexHull",value:function(){return this.getExteriorRing().convexHull()}},{key:"normalized",value:function(t,n){var r=t.copy();return this.normalize(r,n),r}},{key:"compareToSameClass",value:function(){if(arguments.length===1){var t=arguments[0],n=this._shell,r=t._shell;return n.compareToSameClass(r)}if(arguments.length===2){var s=arguments[1],h=arguments[0],f=this._shell,m=h._shell,_=f.compareToSameClass(m,s);if(_!==0)return _;for(var P=this.getNumInteriorRing(),G=h.getNumInteriorRing(),$=0;$<P&&$<G;){var Q=this.getInteriorRingN($),se=h.getInteriorRingN($),ae=Q.compareToSameClass(se,s);if(ae!==0)return ae;$++}return $<P?1:$<G?-1:0}}},{key:"apply",value:function(){if(ge(arguments[0],on)){var t=arguments[0];this._shell.apply(t);for(var n=0;n<this._holes.length;n++)this._holes[n].apply(t)}else if(ge(arguments[0],ln)){var r=arguments[0];if(this._shell.apply(r),!r.isDone())for(var s=0;s<this._holes.length&&(this._holes[s].apply(r),!r.isDone());s++);r.isGeometryChanged()&&this.geometryChanged()}else if(ge(arguments[0],un))arguments[0].filter(this);else if(ge(arguments[0],K)){var h=arguments[0];h.filter(this),this._shell.apply(h);for(var f=0;f<this._holes.length;f++)this._holes[f].apply(h)}}},{key:"getBoundary",value:function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var t=new Array(this._holes.length+1).fill(null);t[0]=this._shell;for(var n=0;n<this._holes.length;n++)t[n+1]=this._holes[n];return t.length<=1?this.getFactory().createLinearRing(t[0].getCoordinateSequence()):this.getFactory().createMultiLineString(t)}},{key:"getGeometryType",value:function(){return re.TYPENAME_POLYGON}},{key:"getExteriorRing",value:function(){return this._shell}},{key:"isEmpty",value:function(){return this._shell.isEmpty()}},{key:"getInteriorRingN",value:function(t){return this._holes[t]}},{key:"interfaces_",get:function(){return[Ri]}}],[{key:"constructor_",value:function(){this._shell=null,this._holes=null;var t=arguments[0],n=arguments[1],r=arguments[2];if(re.constructor_.call(this,r),t===null&&(t=this.getFactory().createLinearRing()),n===null&&(n=[]),re.hasNullElements(n))throw new W("holes must not contain null elements");if(t.isEmpty()&&re.hasNonEmptyElements(n))throw new W("shell is empty but holes are not");this._shell=t,this._holes=n}}])}(re),Ts=function(i){function e(){return o(this,e),c(this,e,arguments)}return N(e,i),g(e)}(Ii),Oi=function(i){function e(t){var n;return o(this,e),(n=c(this,e)).array=[],t instanceof we&&n.addAll(t),n}return N(e,i),g(e,[{key:"contains",value:function(t){var n,r=C(this.array);try{for(r.s();!(n=r.n()).done;)if(n.value.compareTo(t)===0)return!0}catch(s){r.e(s)}finally{r.f()}return!1}},{key:"add",value:function(t){if(this.contains(t))return!1;for(var n=0,r=this.array.length;n<r;n++)if(this.array[n].compareTo(t)===1)return!!this.array.splice(n,0,t);return this.array.push(t),!0}},{key:"addAll",value:function(t){var n,r=C(t);try{for(r.s();!(n=r.n()).done;){var s=n.value;this.add(s)}}catch(h){r.e(h)}finally{r.f()}return!0}},{key:"remove",value:function(){throw new pe}},{key:"size",value:function(){return this.array.length}},{key:"isEmpty",value:function(){return this.array.length===0}},{key:"toArray",value:function(){return this.array.slice()}},{key:"iterator",value:function(){return new Ls(this.array)}}])}(Ts),Ls=function(){return g(function i(e){o(this,i),this.array=e,this.position=0},[{key:"next",value:function(){if(this.position===this.array.length)throw new Ce;return this.array[this.position++]}},{key:"hasNext",value:function(){return this.position<this.array.length}},{key:"remove",value:function(){throw new pe}}])}(),Be=function(i){function e(){var t;return o(this,e),t=c(this,e),e.constructor_.apply(t,arguments),t}return N(e,i),g(e,[{key:"computeEnvelopeInternal",value:function(){for(var t=new Ee,n=0;n<this._geometries.length;n++)t.expandToInclude(this._geometries[n].getEnvelopeInternal());return t}},{key:"getGeometryN",value:function(t){return this._geometries[t]}},{key:"getCoordinates",value:function(){for(var t=new Array(this.getNumPoints()).fill(null),n=-1,r=0;r<this._geometries.length;r++)for(var s=this._geometries[r].getCoordinates(),h=0;h<s.length;h++)t[++n]=s[h];return t}},{key:"getArea",value:function(){for(var t=0,n=0;n<this._geometries.length;n++)t+=this._geometries[n].getArea();return t}},{key:"copyInternal",value:function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof re){var t=arguments[0],n=arguments[1];if(!this.isEquivalentClass(t))return!1;var r=t;if(this._geometries.length!==r._geometries.length)return!1;for(var s=0;s<this._geometries.length;s++)if(!this._geometries[s].equalsExact(r._geometries[s],n))return!1;return!0}return b(e,"equalsExact",this,1).apply(this,arguments)}},{key:"normalize",value:function(){for(var t=0;t<this._geometries.length;t++)this._geometries[t].normalize();kt.sort(this._geometries)}},{key:"getCoordinate",value:function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()}},{key:"getBoundaryDimension",value:function(){for(var t=J.FALSE,n=0;n<this._geometries.length;n++)t=Math.max(t,this._geometries[n].getBoundaryDimension());return t}},{key:"reverseInternal",value:function(){for(var t=this._geometries.length,n=new ue(t),r=0;r<t;r++)n.add(this._geometries[r].reverse());return this.getFactory().buildGeometry(n)}},{key:"getTypeCode",value:function(){return re.TYPECODE_GEOMETRYCOLLECTION}},{key:"getDimension",value:function(){for(var t=J.FALSE,n=0;n<this._geometries.length;n++)t=Math.max(t,this._geometries[n].getDimension());return t}},{key:"getLength",value:function(){for(var t=0,n=0;n<this._geometries.length;n++)t+=this._geometries[n].getLength();return t}},{key:"getNumPoints",value:function(){for(var t=0,n=0;n<this._geometries.length;n++)t+=this._geometries[n].getNumPoints();return t}},{key:"getNumGeometries",value:function(){return this._geometries.length}},{key:"compareToSameClass",value:function(){if(arguments.length===1){var t=arguments[0],n=new Oi(kt.asList(this._geometries)),r=new Oi(kt.asList(t._geometries));return this.compare(n,r)}if(arguments.length===2){for(var s=arguments[1],h=arguments[0],f=this.getNumGeometries(),m=h.getNumGeometries(),_=0;_<f&&_<m;){var P=this.getGeometryN(_),G=h.getGeometryN(_),$=P.compareToSameClass(G,s);if($!==0)return $;_++}return _<f?1:_<m?-1:0}}},{key:"apply",value:function(){if(ge(arguments[0],on))for(var t=arguments[0],n=0;n<this._geometries.length;n++)this._geometries[n].apply(t);else if(ge(arguments[0],ln)){var r=arguments[0];if(this._geometries.length===0)return null;for(var s=0;s<this._geometries.length&&(this._geometries[s].apply(r),!r.isDone());s++);r.isGeometryChanged()&&this.geometryChanged()}else if(ge(arguments[0],un)){var h=arguments[0];h.filter(this);for(var f=0;f<this._geometries.length;f++)this._geometries[f].apply(h)}else if(ge(arguments[0],K)){var m=arguments[0];m.filter(this);for(var _=0;_<this._geometries.length;_++)this._geometries[_].apply(m)}}},{key:"getBoundary",value:function(){return re.checkNotGeometryCollection(this),ne.shouldNeverReachHere(),null}},{key:"getGeometryType",value:function(){return re.TYPENAME_GEOMETRYCOLLECTION}},{key:"isEmpty",value:function(){for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isEmpty())return!1;return!0}}],[{key:"constructor_",value:function(){if(this._geometries=null,arguments.length!==0){if(arguments.length===2){var t=arguments[0],n=arguments[1];if(re.constructor_.call(this,n),t===null&&(t=[]),re.hasNullElements(t))throw new W("geometries must not contain null elements");this._geometries=t}}}}])}(re),Vn=function(i){function e(){var t;return o(this,e),t=c(this,e),e.constructor_.apply(t,arguments),t}return N(e,i),g(e,[{key:"copyInternal",value:function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)}},{key:"isValid",value:function(){return!0}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof re){var t=arguments[0],n=arguments[1];return!!this.isEquivalentClass(t)&&b(e,"equalsExact",this,1).call(this,t,n)}return b(e,"equalsExact",this,1).apply(this,arguments)}},{key:"getCoordinate",value:function(){if(arguments.length===1&&Number.isInteger(arguments[0])){var t=arguments[0];return this._geometries[t].getCoordinate()}return b(e,"getCoordinate",this,1).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return J.FALSE}},{key:"getTypeCode",value:function(){return re.TYPECODE_MULTIPOINT}},{key:"getDimension",value:function(){return 0}},{key:"getBoundary",value:function(){return this.getFactory().createGeometryCollection()}},{key:"getGeometryType",value:function(){return re.TYPENAME_MULTIPOINT}},{key:"interfaces_",get:function(){return[Li]}}],[{key:"constructor_",value:function(){var t=arguments[0],n=arguments[1];Be.constructor_.call(this,t,n)}}])}(Be),$t=function(i){function e(){var t;return o(this,e),t=c(this,e),e.constructor_.apply(t,arguments),t}return N(e,i),g(e,[{key:"copyInternal",value:function(){return new e(this._points.copy(),this._factory)}},{key:"getBoundaryDimension",value:function(){return J.FALSE}},{key:"isClosed",value:function(){return!!this.isEmpty()||b(e,"isClosed",this,1).call(this)}},{key:"reverseInternal",value:function(){var t=this._points.copy();return Et.reverse(t),this.getFactory().createLinearRing(t)}},{key:"getTypeCode",value:function(){return re.TYPECODE_LINEARRING}},{key:"validateConstruction",value:function(){if(!this.isEmpty()&&!b(e,"isClosed",this,1).call(this))throw new W("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<e.MINIMUM_VALID_SIZE)throw new W("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")}},{key:"getGeometryType",value:function(){return re.TYPENAME_LINEARRING}}],[{key:"constructor_",value:function(){var t=arguments[0],n=arguments[1];Vt.constructor_.call(this,t,n),this.validateConstruction()}}])}(Vt);$t.MINIMUM_VALID_SIZE=4;var It=function(i){function e(){var t;return o(this,e),t=c(this,e),e.constructor_.apply(t,arguments),t}return N(e,i),g(e,[{key:"setOrdinate",value:function(t,n){switch(t){case e.X:this.x=n;break;case e.Y:this.y=n;break;default:throw new W("Invalid ordinate index: "+t)}}},{key:"getZ",value:function(){return F.NULL_ORDINATE}},{key:"getOrdinate",value:function(t){switch(t){case e.X:return this.x;case e.Y:return this.y}throw new W("Invalid ordinate index: "+t)}},{key:"setZ",value:function(t){throw new W("CoordinateXY dimension 2 does not support z-ordinate")}},{key:"copy",value:function(){return new e(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+")"}},{key:"setCoordinate",value:function(t){this.x=t.x,this.y=t.y,this.z=t.getZ()}}],[{key:"constructor_",value:function(){if(arguments.length===0)F.constructor_.call(this);else if(arguments.length===1){if(arguments[0]instanceof e){var t=arguments[0];F.constructor_.call(this,t.x,t.y)}else if(arguments[0]instanceof F){var n=arguments[0];F.constructor_.call(this,n.x,n.y)}}else if(arguments.length===2){var r=arguments[0],s=arguments[1];F.constructor_.call(this,r,s,F.NULL_ORDINATE)}}}])}(F);It.X=0,It.Y=1,It.Z=-1,It.M=-1;var Nt=function(i){function e(){var t;return o(this,e),t=c(this,e),e.constructor_.apply(t,arguments),t}return N(e,i),g(e,[{key:"getM",value:function(){return this._m}},{key:"setOrdinate",value:function(t,n){switch(t){case e.X:this.x=n;break;case e.Y:this.y=n;break;case e.M:this._m=n;break;default:throw new W("Invalid ordinate index: "+t)}}},{key:"setM",value:function(t){this._m=t}},{key:"getZ",value:function(){return F.NULL_ORDINATE}},{key:"getOrdinate",value:function(t){switch(t){case e.X:return this.x;case e.Y:return this.y;case e.M:return this._m}throw new W("Invalid ordinate index: "+t)}},{key:"setZ",value:function(t){throw new W("CoordinateXY dimension 2 does not support z-ordinate")}},{key:"copy",value:function(){return new e(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+" m="+this.getM()+")"}},{key:"setCoordinate",value:function(t){this.x=t.x,this.y=t.y,this.z=t.getZ(),this._m=t.getM()}}],[{key:"constructor_",value:function(){if(this._m=null,arguments.length===0)F.constructor_.call(this),this._m=0;else if(arguments.length===1){if(arguments[0]instanceof e){var t=arguments[0];F.constructor_.call(this,t.x,t.y),this._m=t._m}else if(arguments[0]instanceof F){var n=arguments[0];F.constructor_.call(this,n.x,n.y),this._m=this.getM()}}else if(arguments.length===3){var r=arguments[0],s=arguments[1],h=arguments[2];F.constructor_.call(this,r,s,F.NULL_ORDINATE),this._m=h}}}])}(F);Nt.X=0,Nt.Y=1,Nt.Z=-1,Nt.M=2;var $n=function(i){function e(){var t;return o(this,e),t=c(this,e),e.constructor_.apply(t,arguments),t}return N(e,i),g(e,[{key:"getM",value:function(){return this._m}},{key:"setOrdinate",value:function(t,n){switch(t){case F.X:this.x=n;break;case F.Y:this.y=n;break;case F.Z:this.z=n;break;case F.M:this._m=n;break;default:throw new W("Invalid ordinate index: "+t)}}},{key:"setM",value:function(t){this._m=t}},{key:"getOrdinate",value:function(t){switch(t){case F.X:return this.x;case F.Y:return this.y;case F.Z:return this.getZ();case F.M:return this.getM()}throw new W("Invalid ordinate index: "+t)}},{key:"copy",value:function(){return new e(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+", "+this.getZ()+" m="+this.getM()+")"}},{key:"setCoordinate",value:function(t){this.x=t.x,this.y=t.y,this.z=t.getZ(),this._m=t.getM()}}],[{key:"constructor_",value:function(){if(this._m=null,arguments.length===0)F.constructor_.call(this),this._m=0;else if(arguments.length===1){if(arguments[0]instanceof e){var t=arguments[0];F.constructor_.call(this,t),this._m=t._m}else if(arguments[0]instanceof F){var n=arguments[0];F.constructor_.call(this,n),this._m=this.getM()}}else if(arguments.length===4){var r=arguments[0],s=arguments[1],h=arguments[2],f=arguments[3];F.constructor_.call(this,r,s,h),this._m=f}}}])}(F),cn=function(){function i(){o(this,i)}return g(i,null,[{key:"measures",value:function(e){return e instanceof It?0:e instanceof Nt||e instanceof $n?1:0}},{key:"dimension",value:function(e){return e instanceof It?2:e instanceof Nt?3:e instanceof $n?4:3}},{key:"create",value:function(){if(arguments.length===1){var e=arguments[0];return i.create(e,0)}if(arguments.length===2){var t=arguments[0],n=arguments[1];return t===2?new It:t===3&&n===0?new F:t===3&&n===1?new Nt:t===4&&n===1?new $n:new F}}}])}(),Ht=function(i){function e(){var t;return o(this,e),t=c(this,e),e.constructor_.apply(t,arguments),t}return N(e,i),g(e,[{key:"getCoordinate",value:function(t){return this.get(t)}},{key:"addAll",value:function(){if(arguments.length===2&&typeof arguments[1]=="boolean"&&ge(arguments[0],we)){for(var t=arguments[1],n=!1,r=arguments[0].iterator();r.hasNext();)this.add(r.next(),t),n=!0;return n}return b(e,"addAll",this,1).apply(this,arguments)}},{key:"clone",value:function(){for(var t=b(e,"clone",this,1).call(this),n=0;n<this.size();n++)t.add(n,this.get(n).clone());return t}},{key:"toCoordinateArray",value:function(){if(arguments.length===0)return this.toArray(e.coordArrayType);if(arguments.length===1){if(arguments[0])return this.toArray(e.coordArrayType);for(var t=this.size(),n=new Array(t).fill(null),r=0;r<t;r++)n[r]=this.get(t-r-1);return n}}},{key:"add",value:function(){if(arguments.length===1){var t=arguments[0];return b(e,"add",this,1).call(this,t)}if(arguments.length===2){if(arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var n=arguments[0],r=arguments[1];return this.add(n,r,!0),!0}if(arguments[0]instanceof F&&typeof arguments[1]=="boolean"){var s=arguments[0];if(!arguments[1]&&this.size()>=1&&this.get(this.size()-1).equals2D(s))return null;b(e,"add",this,1).call(this,s)}else if(arguments[0]instanceof Object&&typeof arguments[1]=="boolean"){var h=arguments[0],f=arguments[1];return this.add(h,f),!0}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var m=arguments[0],_=arguments[1];if(arguments[2])for(var P=0;P<m.length;P++)this.add(m[P],_);else for(var G=m.length-1;G>=0;G--)this.add(m[G],_);return!0}if(typeof arguments[2]=="boolean"&&Number.isInteger(arguments[0])&&arguments[1]instanceof F){var $=arguments[0],Q=arguments[1];if(!arguments[2]){var se=this.size();if(se>0&&($>0&&this.get($-1).equals2D(Q)||$<se&&this.get($).equals2D(Q)))return null}b(e,"add",this,1).call(this,$,Q)}}else if(arguments.length===4){var ae=arguments[0],de=arguments[1],me=arguments[2],ke=arguments[3],Pe=1;me>ke&&(Pe=-1);for(var Ae=me;Ae!==ke;Ae+=Pe)this.add(ae[Ae],de);return!0}}},{key:"closeRing",value:function(){if(this.size()>0){var t=this.get(0).copy();this.add(t,!1)}}}],[{key:"constructor_",value:function(){if(arguments.length!==0){if(arguments.length===1){var t=arguments[0];this.ensureCapacity(t.length),this.add(t,!0)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this.ensureCapacity(n.length),this.add(n,r)}}}}])}(ue);Ht.coordArrayType=new Array(0).fill(null);var be=function(){function i(){o(this,i)}return g(i,null,[{key:"isRing",value:function(e){return!(e.length<4)&&!!e[0].equals2D(e[e.length-1])}},{key:"ptNotInList",value:function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(i.indexOf(r,t)<0)return r}return null}},{key:"scroll",value:function(e,t){var n=i.indexOf(t,e);if(n<0)return null;var r=new Array(e.length).fill(null);Xe.arraycopy(e,n,r,0,e.length-n),Xe.arraycopy(e,0,r,e.length-n,n),Xe.arraycopy(r,0,e,0,e.length)}},{key:"equals",value:function(){if(arguments.length===2){var e=arguments[0],t=arguments[1];if(e===t)return!0;if(e===null||t===null||e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!e[n].equals(t[n]))return!1;return!0}if(arguments.length===3){var r=arguments[0],s=arguments[1],h=arguments[2];if(r===s)return!0;if(r===null||s===null||r.length!==s.length)return!1;for(var f=0;f<r.length;f++)if(h.compare(r[f],s[f])!==0)return!1;return!0}}},{key:"intersection",value:function(e,t){for(var n=new Ht,r=0;r<e.length;r++)t.intersects(e[r])&&n.add(e[r],!0);return n.toCoordinateArray()}},{key:"measures",value:function(e){if(e===null||e.length===0)return 0;var t,n=0,r=C(e);try{for(r.s();!(t=r.n()).done;){var s=t.value;n=Math.max(n,cn.measures(s))}}catch(h){r.e(h)}finally{r.f()}return n}},{key:"hasRepeatedPoints",value:function(e){for(var t=1;t<e.length;t++)if(e[t-1].equals(e[t]))return!0;return!1}},{key:"removeRepeatedPoints",value:function(e){return i.hasRepeatedPoints(e)?new Ht(e,!1).toCoordinateArray():e}},{key:"reverse",value:function(e){for(var t=e.length-1,n=Math.trunc(t/2),r=0;r<=n;r++){var s=e[r];e[r]=e[t-r],e[t-r]=s}}},{key:"removeNull",value:function(e){for(var t=0,n=0;n<e.length;n++)e[n]!==null&&t++;var r=new Array(t).fill(null);if(t===0)return r;for(var s=0,h=0;h<e.length;h++)e[h]!==null&&(r[s++]=e[h]);return r}},{key:"copyDeep",value:function(){if(arguments.length===1){for(var e=arguments[0],t=new Array(e.length).fill(null),n=0;n<e.length;n++)t[n]=e[n].copy();return t}if(arguments.length===5)for(var r=arguments[0],s=arguments[1],h=arguments[2],f=arguments[3],m=arguments[4],_=0;_<m;_++)h[f+_]=r[s+_].copy()}},{key:"isEqualReversed",value:function(e,t){for(var n=0;n<e.length;n++){var r=e[n],s=t[e.length-n-1];if(r.compareTo(s)!==0)return!1}return!0}},{key:"envelope",value:function(e){for(var t=new Ee,n=0;n<e.length;n++)t.expandToInclude(e[n]);return t}},{key:"toCoordinateArray",value:function(e){return e.toArray(i.coordArrayType)}},{key:"dimension",value:function(e){if(e===null||e.length===0)return 3;var t,n=0,r=C(e);try{for(r.s();!(t=r.n()).done;){var s=t.value;n=Math.max(n,cn.dimension(s))}}catch(h){r.e(h)}finally{r.f()}return n}},{key:"atLeastNCoordinatesOrNothing",value:function(e,t){return t.length>=e?t:[]}},{key:"indexOf",value:function(e,t){for(var n=0;n<t.length;n++)if(e.equals(t[n]))return n;return-1}},{key:"increasingDirection",value:function(e){for(var t=0;t<Math.trunc(e.length/2);t++){var n=e.length-1-t,r=e[t].compareTo(e[n]);if(r!==0)return r}return 1}},{key:"compare",value:function(e,t){for(var n=0;n<e.length&&n<t.length;){var r=e[n].compareTo(t[n]);if(r!==0)return r;n++}return n<t.length?-1:n<e.length?1:0}},{key:"minCoordinate",value:function(e){for(var t=null,n=0;n<e.length;n++)(t===null||t.compareTo(e[n])>0)&&(t=e[n]);return t}},{key:"extract",value:function(e,t,n){t=Xt.clamp(t,0,e.length);var r=(n=Xt.clamp(n,-1,e.length))-t+1;n<0&&(r=0),t>=e.length&&(r=0),n<t&&(r=0);var s=new Array(r).fill(null);if(r===0)return s;for(var h=0,f=t;f<=n;f++)s[h++]=e[f];return s}}])}(),Cs=function(){return g(function i(){o(this,i)},[{key:"compare",value:function(i,e){var t=i,n=e;return be.compare(t,n)}},{key:"interfaces_",get:function(){return[X]}}])}(),Rs=function(){return g(function i(){o(this,i)},[{key:"compare",value:function(i,e){var t=i,n=e;if(t.length<n.length)return-1;if(t.length>n.length)return 1;if(t.length===0)return 0;var r=be.compare(t,n);return be.isEqualReversed(t,n)?0:r}},{key:"OLDcompare",value:function(i,e){var t=i,n=e;if(t.length<n.length)return-1;if(t.length>n.length)return 1;if(t.length===0)return 0;for(var r=be.increasingDirection(t),s=be.increasingDirection(n),h=r>0?0:t.length-1,f=s>0?0:t.length-1,m=0;m<t.length;m++){var _=t[h].compareTo(n[f]);if(_!==0)return _;h+=r,f+=s}return 0}},{key:"interfaces_",get:function(){return[X]}}])}();be.ForwardComparator=Cs,be.BidirectionalComparator=Rs,be.coordArrayType=new Array(0).fill(null);var fn=function(){return g(function i(e){o(this,i),this.str=e},[{key:"append",value:function(i){this.str+=i}},{key:"setCharAt",value:function(i,e){this.str=this.str.substr(0,i)+e+this.str.substr(i+1)}},{key:"toString",value:function(){return this.str}}])}(),jt=function(){function i(){o(this,i),i.constructor_.apply(this,arguments)}return g(i,[{key:"getM",value:function(e){return this.hasM()?this._coordinates[e].getM():z.NaN}},{key:"setOrdinate",value:function(e,t,n){switch(t){case ye.X:this._coordinates[e].x=n;break;case ye.Y:this._coordinates[e].y=n;break;default:this._coordinates[e].setOrdinate(t,n)}}},{key:"getZ",value:function(e){return this.hasZ()?this._coordinates[e].getZ():z.NaN}},{key:"size",value:function(){return this._coordinates.length}},{key:"getOrdinate",value:function(e,t){switch(t){case ye.X:return this._coordinates[e].x;case ye.Y:return this._coordinates[e].y;default:return this._coordinates[e].getOrdinate(t)}}},{key:"getCoordinate",value:function(){if(arguments.length===1){var e=arguments[0];return this._coordinates[e]}if(arguments.length===2){var t=arguments[0];arguments[1].setCoordinate(this._coordinates[t])}}},{key:"getCoordinateCopy",value:function(e){var t=this.createCoordinate();return t.setCoordinate(this._coordinates[e]),t}},{key:"createCoordinate",value:function(){return cn.create(this.getDimension(),this.getMeasures())}},{key:"getDimension",value:function(){return this._dimension}},{key:"getX",value:function(e){return this._coordinates[e].x}},{key:"getMeasures",value:function(){return this._measures}},{key:"expandEnvelope",value:function(e){for(var t=0;t<this._coordinates.length;t++)e.expandToInclude(this._coordinates[t]);return e}},{key:"copy",value:function(){for(var e=new Array(this.size()).fill(null),t=0;t<this._coordinates.length;t++){var n=this.createCoordinate();n.setCoordinate(this._coordinates[t]),e[t]=n}return new i(e,this._dimension,this._measures)}},{key:"toString",value:function(){if(this._coordinates.length>0){var e=new fn(17*this._coordinates.length);e.append("("),e.append(this._coordinates[0]);for(var t=1;t<this._coordinates.length;t++)e.append(", "),e.append(this._coordinates[t]);return e.append(")"),e.toString()}return"()"}},{key:"getY",value:function(e){return this._coordinates[e].y}},{key:"toCoordinateArray",value:function(){return this._coordinates}},{key:"interfaces_",get:function(){return[ye,v]}}],[{key:"constructor_",value:function(){if(this._dimension=3,this._measures=0,this._coordinates=null,arguments.length===1){if(arguments[0]instanceof Array){var e=arguments[0];i.constructor_.call(this,e,be.dimension(e),be.measures(e))}else if(Number.isInteger(arguments[0])){var t=arguments[0];this._coordinates=new Array(t).fill(null);for(var n=0;n<t;n++)this._coordinates[n]=new F}else if(ge(arguments[0],ye)){var r=arguments[0];if(r===null)return this._coordinates=new Array(0).fill(null),null;this._dimension=r.getDimension(),this._measures=r.getMeasures(),this._coordinates=new Array(r.size()).fill(null);for(var s=0;s<this._coordinates.length;s++)this._coordinates[s]=r.getCoordinateCopy(s)}}else if(arguments.length===2){if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var h=arguments[0],f=arguments[1];i.constructor_.call(this,h,f,be.measures(h))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var m=arguments[0],_=arguments[1];this._coordinates=new Array(m).fill(null),this._dimension=_;for(var P=0;P<m;P++)this._coordinates[P]=cn.create(_)}}else if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var G=arguments[0],$=arguments[1],Q=arguments[2];this._dimension=$,this._measures=Q,this._coordinates=G===null?new Array(0).fill(null):G}else if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var se=arguments[0],ae=arguments[1],de=arguments[2];this._coordinates=new Array(se).fill(null),this._dimension=ae,this._measures=de;for(var me=0;me<se;me++)this._coordinates[me]=this.createCoordinate()}}}}])}(),Hn=function(){function i(){o(this,i)}return g(i,[{key:"readResolve",value:function(){return i.instance()}},{key:"create",value:function(){if(arguments.length===1){if(arguments[0]instanceof Array)return new jt(arguments[0]);if(ge(arguments[0],ye))return new jt(arguments[0])}else{if(arguments.length===2){var e=arguments[1];return e>3&&(e=3),e<2&&(e=2),new jt(arguments[0],e)}if(arguments.length===3){var t=arguments[2],n=arguments[1]-t;return t>1&&(t=1),n>3&&(n=3),n<2&&(n=2),new jt(arguments[0],n+t,t)}}}},{key:"interfaces_",get:function(){return[Si,v]}}],[{key:"instance",value:function(){return i.instanceObject}}])}();Hn.instanceObject=new Hn;var jn=function(i){function e(){var t;return o(this,e),t=c(this,e),e.constructor_.apply(t,arguments),t}return N(e,i),g(e,[{key:"copyInternal",value:function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof re){var t=arguments[0],n=arguments[1];return!!this.isEquivalentClass(t)&&b(e,"equalsExact",this,1).call(this,t,n)}return b(e,"equalsExact",this,1).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return 1}},{key:"getTypeCode",value:function(){return re.TYPECODE_MULTIPOLYGON}},{key:"getDimension",value:function(){return 2}},{key:"getBoundary",value:function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var t=new ue,n=0;n<this._geometries.length;n++)for(var r=this._geometries[n].getBoundary(),s=0;s<r.getNumGeometries();s++)t.add(r.getGeometryN(s));var h=new Array(t.size()).fill(null);return this.getFactory().createMultiLineString(t.toArray(h))}},{key:"getGeometryType",value:function(){return re.TYPENAME_MULTIPOLYGON}},{key:"interfaces_",get:function(){return[Ri]}}],[{key:"constructor_",value:function(){var t=arguments[0],n=arguments[1];Be.constructor_.call(this,t,n)}}])}(Be),bi=function(){return g(function i(){o(this,i)},[{key:"get",value:function(){}},{key:"put",value:function(){}},{key:"size",value:function(){}},{key:"values",value:function(){}},{key:"entrySet",value:function(){}}])}(),Os=function(i){function e(){var t;return o(this,e),(t=c(this,e)).map=new Map,t}return N(e,i),g(e,[{key:"get",value:function(t){return this.map.get(t)||null}},{key:"put",value:function(t,n){return this.map.set(t,n),n}},{key:"values",value:function(){for(var t=new ue,n=this.map.values(),r=n.next();!r.done;)t.add(r.value),r=n.next();return t}},{key:"entrySet",value:function(){var t=new Bn;return this.map.entries().forEach(function(n){return t.add(n)}),t}},{key:"size",value:function(){return this.map.size()}}])}(bi),Qe=function(){function i(){o(this,i),i.constructor_.apply(this,arguments)}return g(i,[{key:"equals",value:function(e){if(!(e instanceof i))return!1;var t=e;return this._modelType===t._modelType&&this._scale===t._scale}},{key:"compareTo",value:function(e){var t=e,n=this.getMaximumSignificantDigits(),r=t.getMaximumSignificantDigits();return an.compare(n,r)}},{key:"getScale",value:function(){return this._scale}},{key:"isFloating",value:function(){return this._modelType===i.FLOATING||this._modelType===i.FLOATING_SINGLE}},{key:"getType",value:function(){return this._modelType}},{key:"toString",value:function(){var e="UNKNOWN";return this._modelType===i.FLOATING?e="Floating":this._modelType===i.FLOATING_SINGLE?e="Floating-Single":this._modelType===i.FIXED&&(e="Fixed (Scale="+this.getScale()+")"),e}},{key:"makePrecise",value:function(){if(typeof arguments[0]=="number"){var e=arguments[0];return z.isNaN(e)||this._modelType===i.FLOATING_SINGLE?e:this._modelType===i.FIXED?Math.round(e*this._scale)/this._scale:e}if(arguments[0]instanceof F){var t=arguments[0];if(this._modelType===i.FLOATING)return null;t.x=this.makePrecise(t.x),t.y=this.makePrecise(t.y)}}},{key:"getMaximumSignificantDigits",value:function(){var e=16;return this._modelType===i.FLOATING?e=16:this._modelType===i.FLOATING_SINGLE?e=6:this._modelType===i.FIXED&&(e=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),e}},{key:"setScale",value:function(e){this._scale=Math.abs(e)}},{key:"interfaces_",get:function(){return[v,ie]}}],[{key:"constructor_",value:function(){if(this._modelType=null,this._scale=null,arguments.length===0)this._modelType=i.FLOATING;else if(arguments.length===1){if(arguments[0]instanceof Rt){var e=arguments[0];this._modelType=e,e===i.FIXED&&this.setScale(1)}else if(typeof arguments[0]=="number"){var t=arguments[0];this._modelType=i.FIXED,this.setScale(t)}else if(arguments[0]instanceof i){var n=arguments[0];this._modelType=n._modelType,this._scale=n._scale}}}},{key:"mostPrecise",value:function(e,t){return e.compareTo(t)>=0?e:t}}])}(),Rt=function(){function i(){o(this,i),i.constructor_.apply(this,arguments)}return g(i,[{key:"readResolve",value:function(){return i.nameToTypeMap.get(this._name)}},{key:"toString",value:function(){return this._name}},{key:"interfaces_",get:function(){return[v]}}],[{key:"constructor_",value:function(){this._name=null;var e=arguments[0];this._name=e,i.nameToTypeMap.put(e,this)}}])}();Rt.nameToTypeMap=new Os,Qe.Type=Rt,Qe.FIXED=new Rt("FIXED"),Qe.FLOATING=new Rt("FLOATING"),Qe.FLOATING_SINGLE=new Rt("FLOATING SINGLE"),Qe.maximumPreciseValue=9007199254740992;var Zn=function(i){function e(){var t;return o(this,e),t=c(this,e),e.constructor_.apply(t,arguments),t}return N(e,i),g(e,[{key:"copyInternal",value:function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof re){var t=arguments[0],n=arguments[1];return!!this.isEquivalentClass(t)&&b(e,"equalsExact",this,1).call(this,t,n)}return b(e,"equalsExact",this,1).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return this.isClosed()?J.FALSE:0}},{key:"isClosed",value:function(){if(this.isEmpty())return!1;for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isClosed())return!1;return!0}},{key:"getTypeCode",value:function(){return re.TYPECODE_MULTILINESTRING}},{key:"getDimension",value:function(){return 1}},{key:"getBoundary",value:function(){throw new pe}},{key:"getGeometryType",value:function(){return re.TYPENAME_MULTILINESTRING}},{key:"interfaces_",get:function(){return[Ti]}}],[{key:"constructor_",value:function(){var t=arguments[0],n=arguments[1];Be.constructor_.call(this,t,n)}}])}(Be),Ot=function(){function i(){o(this,i),i.constructor_.apply(this,arguments)}return g(i,[{key:"createEmpty",value:function(e){switch(e){case-1:return this.createGeometryCollection();case 0:return this.createPoint();case 1:return this.createLineString();case 2:return this.createPolygon();default:throw new W("Invalid dimension: "+e)}}},{key:"toGeometry",value:function(e){return e.isNull()?this.createPoint():e.getMinX()===e.getMaxX()&&e.getMinY()===e.getMaxY()?this.createPoint(new F(e.getMinX(),e.getMinY())):e.getMinX()===e.getMaxX()||e.getMinY()===e.getMaxY()?this.createLineString([new F(e.getMinX(),e.getMinY()),new F(e.getMaxX(),e.getMaxY())]):this.createPolygon(this.createLinearRing([new F(e.getMinX(),e.getMinY()),new F(e.getMinX(),e.getMaxY()),new F(e.getMaxX(),e.getMaxY()),new F(e.getMaxX(),e.getMinY()),new F(e.getMinX(),e.getMinY())]),null)}},{key:"createLineString",value:function(){if(arguments.length===0)return this.createLineString(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var e=arguments[0];return this.createLineString(e!==null?this.getCoordinateSequenceFactory().create(e):null)}if(ge(arguments[0],ye))return new Vt(arguments[0],this)}}},{key:"createMultiLineString",value:function(){return arguments.length===0?new Zn(null,this):arguments.length===1?new Zn(arguments[0],this):void 0}},{key:"buildGeometry",value:function(e){for(var t=null,n=!1,r=!1,s=e.iterator();s.hasNext();){var h=s.next(),f=h.getTypeCode();t===null&&(t=f),f!==t&&(n=!0),h instanceof Be&&(r=!0)}if(t===null)return this.createGeometryCollection();if(n||r)return this.createGeometryCollection(i.toGeometryArray(e));var m=e.iterator().next();if(e.size()>1){if(m instanceof hn)return this.createMultiPolygon(i.toPolygonArray(e));if(m instanceof Vt)return this.createMultiLineString(i.toLineStringArray(e));if(m instanceof Xn)return this.createMultiPoint(i.toPointArray(e));ne.shouldNeverReachHere("Unhandled geometry type: "+m.getGeometryType())}return m}},{key:"createMultiPointFromCoords",value:function(e){return this.createMultiPoint(e!==null?this.getCoordinateSequenceFactory().create(e):null)}},{key:"createPoint",value:function(){if(arguments.length===0)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof F){var e=arguments[0];return this.createPoint(e!==null?this.getCoordinateSequenceFactory().create([e]):null)}if(ge(arguments[0],ye))return new Xn(arguments[0],this)}}},{key:"getCoordinateSequenceFactory",value:function(){return this._coordinateSequenceFactory}},{key:"createPolygon",value:function(){if(arguments.length===0)return this.createPolygon(null,null);if(arguments.length===1){if(ge(arguments[0],ye)){var e=arguments[0];return this.createPolygon(this.createLinearRing(e))}if(arguments[0]instanceof Array){var t=arguments[0];return this.createPolygon(this.createLinearRing(t))}if(arguments[0]instanceof $t){var n=arguments[0];return this.createPolygon(n,null)}}else if(arguments.length===2)return new hn(arguments[0],arguments[1],this)}},{key:"getSRID",value:function(){return this._SRID}},{key:"createGeometryCollection",value:function(){return arguments.length===0?new Be(null,this):arguments.length===1?new Be(arguments[0],this):void 0}},{key:"getPrecisionModel",value:function(){return this._precisionModel}},{key:"createLinearRing",value:function(){if(arguments.length===0)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var e=arguments[0];return this.createLinearRing(e!==null?this.getCoordinateSequenceFactory().create(e):null)}if(ge(arguments[0],ye))return new $t(arguments[0],this)}}},{key:"createMultiPolygon",value:function(){return arguments.length===0?new jn(null,this):arguments.length===1?new jn(arguments[0],this):void 0}},{key:"createMultiPoint",value:function(){if(arguments.length===0)return new Vn(null,this);if(arguments.length===1){if(arguments[0]instanceof Array)return new Vn(arguments[0],this);if(ge(arguments[0],ye)){var e=arguments[0];if(e===null)return this.createMultiPoint(new Array(0).fill(null));for(var t=new Array(e.size()).fill(null),n=0;n<e.size();n++){var r=this.getCoordinateSequenceFactory().create(1,e.getDimension(),e.getMeasures());Et.copy(e,n,r,0,1),t[n]=this.createPoint(r)}return this.createMultiPoint(t)}}}},{key:"interfaces_",get:function(){return[v]}}],[{key:"constructor_",value:function(){if(this._precisionModel=null,this._coordinateSequenceFactory=null,this._SRID=null,arguments.length===0)i.constructor_.call(this,new Qe,0);else if(arguments.length===1){if(ge(arguments[0],Si)){var e=arguments[0];i.constructor_.call(this,new Qe,0,e)}else if(arguments[0]instanceof Qe){var t=arguments[0];i.constructor_.call(this,t,0,i.getDefaultCoordinateSequenceFactory())}}else if(arguments.length===2){var n=arguments[0],r=arguments[1];i.constructor_.call(this,n,r,i.getDefaultCoordinateSequenceFactory())}else if(arguments.length===3){var s=arguments[0],h=arguments[1],f=arguments[2];this._precisionModel=s,this._coordinateSequenceFactory=f,this._SRID=h}}},{key:"toMultiPolygonArray",value:function(e){var t=new Array(e.size()).fill(null);return e.toArray(t)}},{key:"toGeometryArray",value:function(e){if(e===null)return null;var t=new Array(e.size()).fill(null);return e.toArray(t)}},{key:"getDefaultCoordinateSequenceFactory",value:function(){return Hn.instance()}},{key:"toMultiLineStringArray",value:function(e){var t=new Array(e.size()).fill(null);return e.toArray(t)}},{key:"toLineStringArray",value:function(e){var t=new Array(e.size()).fill(null);return e.toArray(t)}},{key:"toMultiPointArray",value:function(e){var t=new Array(e.size()).fill(null);return e.toArray(t)}},{key:"toLinearRingArray",value:function(e){var t=new Array(e.size()).fill(null);return e.toArray(t)}},{key:"toPointArray",value:function(e){var t=new Array(e.size()).fill(null);return e.toArray(t)}},{key:"toPolygonArray",value:function(e){var t=new Array(e.size()).fill(null);return e.toArray(t)}},{key:"createPointFromInternalCoord",value:function(e,t){return t.getPrecisionModel().makePrecise(e),t.getFactory().createPoint(e)}}])}(),Wn="XY",bs="XYZ",Ms="XYM",Ps="XYZM",Mi={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"},Pi="EMPTY",gn=1,ft=2,dt=3,Ai=4,bt=5,As=6;for(var Ds in Mi)Mi[Ds].toUpperCase();var Fs=function(){return g(function i(e){o(this,i),this.wkt=e,this.index_=-1},[{key:"isAlpha_",value:function(i){return i>="a"&&i<="z"||i>="A"&&i<="Z"}},{key:"isNumeric_",value:function(i,e){return i>="0"&&i<="9"||i=="."&&!(e!==void 0&&e)}},{key:"isWhiteSpace_",value:function(i){return i==" "||i=="	"||i=="\r"||i==`
`}},{key:"nextChar_",value:function(){return this.wkt.charAt(++this.index_)}},{key:"nextToken",value:function(){var i,e=this.nextChar_(),t=this.index_,n=e;if(e=="(")i=ft;else if(e==",")i=bt;else if(e==")")i=dt;else if(this.isNumeric_(e)||e=="-")i=Ai,n=this.readNumber_();else if(this.isAlpha_(e))i=gn,n=this.readText_();else{if(this.isWhiteSpace_(e))return this.nextToken();if(e!=="")throw new Error("Unexpected character: "+e);i=As}return{position:t,value:n,type:i}}},{key:"readNumber_",value:function(){var i,e=this.index_,t=!1,n=!1;do i=="."?t=!0:i!="e"&&i!="E"||(n=!0),i=this.nextChar_();while(this.isNumeric_(i,t)||!n&&(i=="e"||i=="E")||n&&(i=="-"||i=="+"));return parseFloat(this.wkt.substring(e,this.index_--))}},{key:"readText_",value:function(){var i,e=this.index_;do i=this.nextChar_();while(this.isAlpha_(i));return this.wkt.substring(e,this.index_--).toUpperCase()}}])}(),Gs=function(){return g(function i(e,t){o(this,i),this.lexer_=e,this.token_,this.layout_=Wn,this.factory=t},[{key:"consume_",value:function(){this.token_=this.lexer_.nextToken()}},{key:"isTokenType",value:function(i){return this.token_.type==i}},{key:"match",value:function(i){var e=this.isTokenType(i);return e&&this.consume_(),e}},{key:"parse",value:function(){return this.consume_(),this.parseGeometry_()}},{key:"parseGeometryLayout_",value:function(){var i=Wn,e=this.token_;if(this.isTokenType(gn)){var t=e.value;t==="Z"?i=bs:t==="M"?i=Ms:t==="ZM"&&(i=Ps),i!==Wn&&this.consume_()}return i}},{key:"parseGeometryCollectionText_",value:function(){if(this.match(ft)){var i=[];do i.push(this.parseGeometry_());while(this.match(bt));if(this.match(dt))return i}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parsePointText_",value:function(){if(this.match(ft)){var i=this.parsePoint_();if(this.match(dt))return i}else if(this.isEmptyGeometry_())return null;throw new Error(this.formatErrorMessage_())}},{key:"parseLineStringText_",value:function(){if(this.match(ft)){var i=this.parsePointList_();if(this.match(dt))return i}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parsePolygonText_",value:function(){if(this.match(ft)){var i=this.parseLineStringTextList_();if(this.match(dt))return i}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parseMultiPointText_",value:function(){var i;if(this.match(ft)){if(i=this.token_.type==ft?this.parsePointTextList_():this.parsePointList_(),this.match(dt))return i}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parseMultiLineStringText_",value:function(){if(this.match(ft)){var i=this.parseLineStringTextList_();if(this.match(dt))return i}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parseMultiPolygonText_",value:function(){if(this.match(ft)){var i=this.parsePolygonTextList_();if(this.match(dt))return i}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parsePoint_",value:function(){for(var i=[],e=this.layout_.length,t=0;t<e;++t){var n=this.token_;if(!this.match(Ai))break;i.push(n.value)}if(i.length==e)return i;throw new Error(this.formatErrorMessage_())}},{key:"parsePointList_",value:function(){for(var i=[this.parsePoint_()];this.match(bt);)i.push(this.parsePoint_());return i}},{key:"parsePointTextList_",value:function(){for(var i=[this.parsePointText_()];this.match(bt);)i.push(this.parsePointText_());return i}},{key:"parseLineStringTextList_",value:function(){for(var i=[this.parseLineStringText_()];this.match(bt);)i.push(this.parseLineStringText_());return i}},{key:"parsePolygonTextList_",value:function(){for(var i=[this.parsePolygonText_()];this.match(bt);)i.push(this.parsePolygonText_());return i}},{key:"isEmptyGeometry_",value:function(){var i=this.isTokenType(gn)&&this.token_.value==Pi;return i&&this.consume_(),i}},{key:"formatErrorMessage_",value:function(){return"Unexpected `"+this.token_.value+"` at position "+this.token_.position+" in `"+this.lexer_.wkt+"`"}},{key:"parseGeometry_",value:function(){var i=this.factory,e=function(ae){return d(F,Z(ae))},t=function(ae){var de=ae.map(function(me){return i.createLinearRing(me.map(e))});return de.length>1?i.createPolygon(de[0],de.slice(1)):i.createPolygon(de[0])},n=this.token_;if(this.match(gn)){var r=n.value;if(this.layout_=this.parseGeometryLayout_(),r=="GEOMETRYCOLLECTION"){var s=this.parseGeometryCollectionText_();return i.createGeometryCollection(s)}switch(r){case"POINT":var h=this.parsePointText_();return h?i.createPoint(d(F,Z(h))):i.createPoint();case"LINESTRING":var f=this.parseLineStringText_().map(e);return i.createLineString(f);case"LINEARRING":var m=this.parseLineStringText_().map(e);return i.createLinearRing(m);case"POLYGON":var _=this.parsePolygonText_();return _&&_.length!==0?t(_):i.createPolygon();case"MULTIPOINT":var P=this.parseMultiPointText_();if(!P||P.length===0)return i.createMultiPoint();var G=P.map(e).map(function(ae){return i.createPoint(ae)});return i.createMultiPoint(G);case"MULTILINESTRING":var $=this.parseMultiLineStringText_().map(function(ae){return i.createLineString(ae.map(e))});return i.createMultiLineString($);case"MULTIPOLYGON":var Q=this.parseMultiPolygonText_();if(!Q||Q.length===0)return i.createMultiPolygon();var se=Q.map(t);return i.createMultiPolygon(se);default:throw new Error("Invalid geometry type: "+r)}}throw new Error(this.formatErrorMessage_())}}])}();function Di(i){if(i.isEmpty())return"";var e=i.getCoordinate(),t=[e.x,e.y];return e.z===void 0||Number.isNaN(e.z)||t.push(e.z),e.m===void 0||Number.isNaN(e.m)||t.push(e.m),t.join(" ")}function Zt(i){for(var e=i.getCoordinates().map(function(s){var h=[s.x,s.y];return s.z===void 0||Number.isNaN(s.z)||h.push(s.z),s.m===void 0||Number.isNaN(s.m)||h.push(s.m),h}),t=[],n=0,r=e.length;n<r;++n)t.push(e[n].join(" "));return t.join(", ")}function Fi(i){var e=[];e.push("("+Zt(i.getExteriorRing())+")");for(var t=0,n=i.getNumInteriorRing();t<n;++t)e.push("("+Zt(i.getInteriorRingN(t))+")");return e.join(", ")}var qs={Point:Di,LineString:Zt,LinearRing:Zt,Polygon:Fi,MultiPoint:function(i){for(var e=[],t=0,n=i.getNumGeometries();t<n;++t)e.push("("+Di(i.getGeometryN(t))+")");return e.join(", ")},MultiLineString:function(i){for(var e=[],t=0,n=i.getNumGeometries();t<n;++t)e.push("("+Zt(i.getGeometryN(t))+")");return e.join(", ")},MultiPolygon:function(i){for(var e=[],t=0,n=i.getNumGeometries();t<n;++t)e.push("("+Fi(i.getGeometryN(t))+")");return e.join(", ")},GeometryCollection:function(i){for(var e=[],t=0,n=i.getNumGeometries();t<n;++t)e.push(Gi(i.getGeometryN(t)));return e.join(", ")}};function Gi(i){var e=i.getGeometryType(),t=qs[e];e=e.toUpperCase();var n=function(r){var s="";if(r.isEmpty())return s;var h=r.getCoordinate();return h.z===void 0||Number.isNaN(h.z)||(s+="Z"),h.m===void 0||Number.isNaN(h.m)||(s+="M"),s}(i);return n.length>0&&(e+=" "+n),i.isEmpty()?e+" "+Pi:e+" ("+t(i)+")"}var Bs=function(){return g(function i(e){o(this,i),this.geometryFactory=e||new Ot,this.precisionModel=this.geometryFactory.getPrecisionModel()},[{key:"read",value:function(i){var e=new Fs(i);return new Gs(e,this.geometryFactory).parse()}},{key:"write",value:function(i){return Gi(i)}}])}(),Jn=function(){return g(function i(e){o(this,i),this.parser=new Bs(e)},[{key:"write",value:function(i){return this.parser.write(i)}}],[{key:"toLineString",value:function(i,e){if(arguments.length!==2)throw new Error("Not implemented");return"LINESTRING ( "+i.x+" "+i.y+", "+e.x+" "+e.y+" )"}}])}(),Ie=function(){function i(){o(this,i),i.constructor_.apply(this,arguments)}return g(i,[{key:"getIndexAlongSegment",value:function(e,t){return this.computeIntLineIndex(),this._intLineIndex[e][t]}},{key:"getTopologySummary",value:function(){var e=new fn;return this.isEndPoint()&&e.append(" endpoint"),this._isProper&&e.append(" proper"),this.isCollinear()&&e.append(" collinear"),e.toString()}},{key:"computeIntersection",value:function(e,t,n,r){this._inputLines[0][0]=e,this._inputLines[0][1]=t,this._inputLines[1][0]=n,this._inputLines[1][1]=r,this._result=this.computeIntersect(e,t,n,r)}},{key:"getIntersectionNum",value:function(){return this._result}},{key:"computeIntLineIndex",value:function(){if(arguments.length===0)this._intLineIndex===null&&(this._intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(arguments.length===1){var e=arguments[0];this.getEdgeDistance(e,0)>this.getEdgeDistance(e,1)?(this._intLineIndex[e][0]=0,this._intLineIndex[e][1]=1):(this._intLineIndex[e][0]=1,this._intLineIndex[e][1]=0)}}},{key:"isProper",value:function(){return this.hasIntersection()&&this._isProper}},{key:"setPrecisionModel",value:function(e){this._precisionModel=e}},{key:"isInteriorIntersection",value:function(){if(arguments.length===0)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(arguments.length===1){for(var e=arguments[0],t=0;t<this._result;t++)if(!this._intPt[t].equals2D(this._inputLines[e][0])&&!this._intPt[t].equals2D(this._inputLines[e][1]))return!0;return!1}}},{key:"getIntersection",value:function(e){return this._intPt[e]}},{key:"isEndPoint",value:function(){return this.hasIntersection()&&!this._isProper}},{key:"hasIntersection",value:function(){return this._result!==i.NO_INTERSECTION}},{key:"getEdgeDistance",value:function(e,t){return i.computeEdgeDistance(this._intPt[t],this._inputLines[e][0],this._inputLines[e][1])}},{key:"isCollinear",value:function(){return this._result===i.COLLINEAR_INTERSECTION}},{key:"toString",value:function(){return Jn.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+Jn.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()}},{key:"getEndpoint",value:function(e,t){return this._inputLines[e][t]}},{key:"isIntersection",value:function(e){for(var t=0;t<this._result;t++)if(this._intPt[t].equals2D(e))return!0;return!1}},{key:"getIntersectionAlongSegment",value:function(e,t){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[e][t]]}}],[{key:"constructor_",value:function(){this._result=null,this._inputLines=Array(2).fill().map(function(){return Array(2)}),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new F,this._intPt[1]=new F,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0}},{key:"computeEdgeDistance",value:function(e,t,n){var r=Math.abs(n.x-t.x),s=Math.abs(n.y-t.y),h=-1;if(e.equals(t))h=0;else if(e.equals(n))h=r>s?r:s;else{var f=Math.abs(e.x-t.x),m=Math.abs(e.y-t.y);(h=r>s?f:m)!==0||e.equals(t)||(h=Math.max(f,m))}return ne.isTrue(!(h===0&&!e.equals(t)),"Bad distance calculation"),h}},{key:"nonRobustComputeEdgeDistance",value:function(e,t,n){var r=e.x-t.x,s=e.y-t.y,h=Math.sqrt(r*r+s*s);return ne.isTrue(!(h===0&&!e.equals(t)),"Invalid distance calculation"),h}}])}();Ie.DONT_INTERSECT=0,Ie.DO_INTERSECT=1,Ie.COLLINEAR=2,Ie.NO_INTERSECTION=0,Ie.POINT_INTERSECTION=1,Ie.COLLINEAR_INTERSECTION=2;var wt=function(i){function e(){return o(this,e),c(this,e)}return N(e,i),g(e,[{key:"isInSegmentEnvelopes",value:function(t){var n=new Ee(this._inputLines[0][0],this._inputLines[0][1]),r=new Ee(this._inputLines[1][0],this._inputLines[1][1]);return n.contains(t)&&r.contains(t)}},{key:"computeIntersection",value:function(){if(arguments.length!==3)return b(e,"computeIntersection",this,1).apply(this,arguments);var t=arguments[0],n=arguments[1],r=arguments[2];if(this._isProper=!1,Ee.intersects(n,r,t)&&he.index(n,r,t)===0&&he.index(r,n,t)===0)return this._isProper=!0,(t.equals(n)||t.equals(r))&&(this._isProper=!1),this._result=Ie.POINT_INTERSECTION,null;this._result=Ie.NO_INTERSECTION}},{key:"intersection",value:function(t,n,r,s){var h=this.intersectionSafe(t,n,r,s);return this.isInSegmentEnvelopes(h)||(h=new F(e.nearestEndpoint(t,n,r,s))),this._precisionModel!==null&&this._precisionModel.makePrecise(h),h}},{key:"checkDD",value:function(t,n,r,s,h){var f=Yn.intersection(t,n,r,s),m=this.isInSegmentEnvelopes(f);Xe.out.println("DD in env = "+m+"  --------------------- "+f),h.distance(f)>1e-4&&Xe.out.println("Distance = "+h.distance(f))}},{key:"intersectionSafe",value:function(t,n,r,s){var h=Un.intersection(t,n,r,s);return h===null&&(h=e.nearestEndpoint(t,n,r,s)),h}},{key:"computeCollinearIntersection",value:function(t,n,r,s){var h=Ee.intersects(t,n,r),f=Ee.intersects(t,n,s),m=Ee.intersects(r,s,t),_=Ee.intersects(r,s,n);return h&&f?(this._intPt[0]=r,this._intPt[1]=s,Ie.COLLINEAR_INTERSECTION):m&&_?(this._intPt[0]=t,this._intPt[1]=n,Ie.COLLINEAR_INTERSECTION):h&&m?(this._intPt[0]=r,this._intPt[1]=t,!r.equals(t)||f||_?Ie.COLLINEAR_INTERSECTION:Ie.POINT_INTERSECTION):h&&_?(this._intPt[0]=r,this._intPt[1]=n,!r.equals(n)||f||m?Ie.COLLINEAR_INTERSECTION:Ie.POINT_INTERSECTION):f&&m?(this._intPt[0]=s,this._intPt[1]=t,!s.equals(t)||h||_?Ie.COLLINEAR_INTERSECTION:Ie.POINT_INTERSECTION):f&&_?(this._intPt[0]=s,this._intPt[1]=n,!s.equals(n)||h||m?Ie.COLLINEAR_INTERSECTION:Ie.POINT_INTERSECTION):Ie.NO_INTERSECTION}},{key:"computeIntersect",value:function(t,n,r,s){if(this._isProper=!1,!Ee.intersects(t,n,r,s))return Ie.NO_INTERSECTION;var h=he.index(t,n,r),f=he.index(t,n,s);if(h>0&&f>0||h<0&&f<0)return Ie.NO_INTERSECTION;var m=he.index(r,s,t),_=he.index(r,s,n);return m>0&&_>0||m<0&&_<0?Ie.NO_INTERSECTION:h===0&&f===0&&m===0&&_===0?this.computeCollinearIntersection(t,n,r,s):(h===0||f===0||m===0||_===0?(this._isProper=!1,t.equals2D(r)||t.equals2D(s)?this._intPt[0]=t:n.equals2D(r)||n.equals2D(s)?this._intPt[0]=n:h===0?this._intPt[0]=new F(r):f===0?this._intPt[0]=new F(s):m===0?this._intPt[0]=new F(t):_===0&&(this._intPt[0]=new F(n))):(this._isProper=!0,this._intPt[0]=this.intersection(t,n,r,s)),Ie.POINT_INTERSECTION)}}],[{key:"nearestEndpoint",value:function(t,n,r,s){var h=t,f=it.pointToSegment(t,r,s),m=it.pointToSegment(n,r,s);return m<f&&(f=m,h=n),(m=it.pointToSegment(r,t,n))<f&&(f=m,h=r),(m=it.pointToSegment(s,t,n))<f&&(f=m,h=s),h}}])}(Ie),zs=function(){function i(){o(this,i),i.constructor_.apply(this,arguments)}return g(i,[{key:"countSegment",value:function(e,t){if(e.x<this._p.x&&t.x<this._p.x)return null;if(this._p.x===t.x&&this._p.y===t.y)return this._isPointOnSegment=!0,null;if(e.y===this._p.y&&t.y===this._p.y){var n=e.x,r=t.x;return n>r&&(n=t.x,r=e.x),this._p.x>=n&&this._p.x<=r&&(this._isPointOnSegment=!0),null}if(e.y>this._p.y&&t.y<=this._p.y||t.y>this._p.y&&e.y<=this._p.y){var s=he.index(e,t,this._p);if(s===he.COLLINEAR)return this._isPointOnSegment=!0,null;t.y<e.y&&(s=-s),s===he.LEFT&&this._crossingCount++}}},{key:"isPointInPolygon",value:function(){return this.getLocation()!==I.EXTERIOR}},{key:"getLocation",value:function(){return this._isPointOnSegment?I.BOUNDARY:this._crossingCount%2==1?I.INTERIOR:I.EXTERIOR}},{key:"isOnSegment",value:function(){return this._isPointOnSegment}}],[{key:"constructor_",value:function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var e=arguments[0];this._p=e}},{key:"locatePointInRing",value:function(){if(arguments[0]instanceof F&&ge(arguments[1],ye)){for(var e=arguments[1],t=new i(arguments[0]),n=new F,r=new F,s=1;s<e.size();s++)if(e.getCoordinate(s,n),e.getCoordinate(s-1,r),t.countSegment(n,r),t.isOnSegment())return t.getLocation();return t.getLocation()}if(arguments[0]instanceof F&&arguments[1]instanceof Array){for(var h=arguments[1],f=new i(arguments[0]),m=1;m<h.length;m++){var _=h[m],P=h[m-1];if(f.countSegment(_,P),f.isOnSegment())return f.getLocation()}return f.getLocation()}}}])}(),Kn=function(){function i(){o(this,i)}return g(i,null,[{key:"isOnLine",value:function(){if(arguments[0]instanceof F&&ge(arguments[1],ye)){for(var e=arguments[0],t=arguments[1],n=new wt,r=new F,s=new F,h=t.size(),f=1;f<h;f++)if(t.getCoordinate(f-1,r),t.getCoordinate(f,s),n.computeIntersection(e,r,s),n.hasIntersection())return!0;return!1}if(arguments[0]instanceof F&&arguments[1]instanceof Array){for(var m=arguments[0],_=arguments[1],P=new wt,G=1;G<_.length;G++){var $=_[G-1],Q=_[G];if(P.computeIntersection(m,$,Q),P.hasIntersection())return!0}return!1}}},{key:"locateInRing",value:function(e,t){return zs.locatePointInRing(e,t)}},{key:"isInRing",value:function(e,t){return i.locateInRing(e,t)!==I.EXTERIOR}}])}(),Ve=function(){function i(){o(this,i),i.constructor_.apply(this,arguments)}return g(i,[{key:"setAllLocations",value:function(e){for(var t=0;t<this.location.length;t++)this.location[t]=e}},{key:"isNull",value:function(){for(var e=0;e<this.location.length;e++)if(this.location[e]!==I.NONE)return!1;return!0}},{key:"setAllLocationsIfNull",value:function(e){for(var t=0;t<this.location.length;t++)this.location[t]===I.NONE&&(this.location[t]=e)}},{key:"isLine",value:function(){return this.location.length===1}},{key:"merge",value:function(e){if(e.location.length>this.location.length){var t=new Array(3).fill(null);t[H.ON]=this.location[H.ON],t[H.LEFT]=I.NONE,t[H.RIGHT]=I.NONE,this.location=t}for(var n=0;n<this.location.length;n++)this.location[n]===I.NONE&&n<e.location.length&&(this.location[n]=e.location[n])}},{key:"getLocations",value:function(){return this.location}},{key:"flip",value:function(){if(this.location.length<=1)return null;var e=this.location[H.LEFT];this.location[H.LEFT]=this.location[H.RIGHT],this.location[H.RIGHT]=e}},{key:"toString",value:function(){var e=new Ut;return this.location.length>1&&e.append(I.toLocationSymbol(this.location[H.LEFT])),e.append(I.toLocationSymbol(this.location[H.ON])),this.location.length>1&&e.append(I.toLocationSymbol(this.location[H.RIGHT])),e.toString()}},{key:"setLocations",value:function(e,t,n){this.location[H.ON]=e,this.location[H.LEFT]=t,this.location[H.RIGHT]=n}},{key:"get",value:function(e){return e<this.location.length?this.location[e]:I.NONE}},{key:"isArea",value:function(){return this.location.length>1}},{key:"isAnyNull",value:function(){for(var e=0;e<this.location.length;e++)if(this.location[e]===I.NONE)return!0;return!1}},{key:"setLocation",value:function(){if(arguments.length===1){var e=arguments[0];this.setLocation(H.ON,e)}else if(arguments.length===2){var t=arguments[0],n=arguments[1];this.location[t]=n}}},{key:"init",value:function(e){this.location=new Array(e).fill(null),this.setAllLocations(I.NONE)}},{key:"isEqualOnSide",value:function(e,t){return this.location[t]===e.location[t]}},{key:"allPositionsEqual",value:function(e){for(var t=0;t<this.location.length;t++)if(this.location[t]!==e)return!1;return!0}}],[{key:"constructor_",value:function(){if(this.location=null,arguments.length===1){if(arguments[0]instanceof Array){var e=arguments[0];this.init(e.length)}else if(Number.isInteger(arguments[0])){var t=arguments[0];this.init(1),this.location[H.ON]=t}else if(arguments[0]instanceof i){var n=arguments[0];if(this.init(n.location.length),n!==null)for(var r=0;r<this.location.length;r++)this.location[r]=n.location[r]}}else if(arguments.length===3){var s=arguments[0],h=arguments[1],f=arguments[2];this.init(3),this.location[H.ON]=s,this.location[H.LEFT]=h,this.location[H.RIGHT]=f}}}])}(),$e=function(){function i(){o(this,i),i.constructor_.apply(this,arguments)}return g(i,[{key:"getGeometryCount",value:function(){var e=0;return this.elt[0].isNull()||e++,this.elt[1].isNull()||e++,e}},{key:"setAllLocations",value:function(e,t){this.elt[e].setAllLocations(t)}},{key:"isNull",value:function(e){return this.elt[e].isNull()}},{key:"setAllLocationsIfNull",value:function(){if(arguments.length===1){var e=arguments[0];this.setAllLocationsIfNull(0,e),this.setAllLocationsIfNull(1,e)}else if(arguments.length===2){var t=arguments[0],n=arguments[1];this.elt[t].setAllLocationsIfNull(n)}}},{key:"isLine",value:function(e){return this.elt[e].isLine()}},{key:"merge",value:function(e){for(var t=0;t<2;t++)this.elt[t]===null&&e.elt[t]!==null?this.elt[t]=new Ve(e.elt[t]):this.elt[t].merge(e.elt[t])}},{key:"flip",value:function(){this.elt[0].flip(),this.elt[1].flip()}},{key:"getLocation",value:function(){if(arguments.length===1){var e=arguments[0];return this.elt[e].get(H.ON)}if(arguments.length===2){var t=arguments[0],n=arguments[1];return this.elt[t].get(n)}}},{key:"toString",value:function(){var e=new Ut;return this.elt[0]!==null&&(e.append("A:"),e.append(this.elt[0].toString())),this.elt[1]!==null&&(e.append(" B:"),e.append(this.elt[1].toString())),e.toString()}},{key:"isArea",value:function(){if(arguments.length===0)return this.elt[0].isArea()||this.elt[1].isArea();if(arguments.length===1){var e=arguments[0];return this.elt[e].isArea()}}},{key:"isAnyNull",value:function(e){return this.elt[e].isAnyNull()}},{key:"setLocation",value:function(){if(arguments.length===2){var e=arguments[0],t=arguments[1];this.elt[e].setLocation(H.ON,t)}else if(arguments.length===3){var n=arguments[0],r=arguments[1],s=arguments[2];this.elt[n].setLocation(r,s)}}},{key:"isEqualOnSide",value:function(e,t){return this.elt[0].isEqualOnSide(e.elt[0],t)&&this.elt[1].isEqualOnSide(e.elt[1],t)}},{key:"allPositionsEqual",value:function(e,t){return this.elt[e].allPositionsEqual(t)}},{key:"toLine",value:function(e){this.elt[e].isArea()&&(this.elt[e]=new Ve(this.elt[e].location[0]))}}],[{key:"constructor_",value:function(){if(this.elt=new Array(2).fill(null),arguments.length===1){if(Number.isInteger(arguments[0])){var e=arguments[0];this.elt[0]=new Ve(e),this.elt[1]=new Ve(e)}else if(arguments[0]instanceof i){var t=arguments[0];this.elt[0]=new Ve(t.elt[0]),this.elt[1]=new Ve(t.elt[1])}}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this.elt[0]=new Ve(I.NONE),this.elt[1]=new Ve(I.NONE),this.elt[n].setLocation(r)}else if(arguments.length===3){var s=arguments[0],h=arguments[1],f=arguments[2];this.elt[0]=new Ve(s,h,f),this.elt[1]=new Ve(s,h,f)}else if(arguments.length===4){var m=arguments[0],_=arguments[1],P=arguments[2],G=arguments[3];this.elt[0]=new Ve(I.NONE,I.NONE,I.NONE),this.elt[1]=new Ve(I.NONE,I.NONE,I.NONE),this.elt[m].setLocations(_,P,G)}}},{key:"toLineLabel",value:function(e){for(var t=new i(I.NONE),n=0;n<2;n++)t.setLocation(n,e.getLocation(n));return t}}])}(),mn=function(){return g(function i(){o(this,i),i.constructor_.apply(this,arguments)},[{key:"computeRing",value:function(){if(this._ring!==null)return null;for(var i=new Array(this._pts.size()).fill(null),e=0;e<this._pts.size();e++)i[e]=this._pts.get(e);this._ring=this._geometryFactory.createLinearRing(i),this._isHole=he.isCCW(this._ring.getCoordinates())}},{key:"isIsolated",value:function(){return this._label.getGeometryCount()===1}},{key:"computePoints",value:function(i){this._startDe=i;var e=i,t=!0;do{if(e===null)throw new ct("Found null DirectedEdge");if(e.getEdgeRing()===this)throw new ct("Directed Edge visited twice during ring-building at "+e.getCoordinate());this._edges.add(e);var n=e.getLabel();ne.isTrue(n.isArea()),this.mergeLabel(n),this.addPoints(e.getEdge(),e.isForward(),t),t=!1,this.setEdgeRing(e,this),e=this.getNext(e)}while(e!==this._startDe)}},{key:"getLinearRing",value:function(){return this._ring}},{key:"getCoordinate",value:function(i){return this._pts.get(i)}},{key:"computeMaxNodeDegree",value:function(){this._maxNodeDegree=0;var i=this._startDe;do{var e=i.getNode().getEdges().getOutgoingDegree(this);e>this._maxNodeDegree&&(this._maxNodeDegree=e),i=this.getNext(i)}while(i!==this._startDe);this._maxNodeDegree*=2}},{key:"addPoints",value:function(i,e,t){var n=i.getCoordinates();if(e){var r=1;t&&(r=0);for(var s=r;s<n.length;s++)this._pts.add(n[s])}else{var h=n.length-2;t&&(h=n.length-1);for(var f=h;f>=0;f--)this._pts.add(n[f])}}},{key:"isHole",value:function(){return this._isHole}},{key:"setInResult",value:function(){var i=this._startDe;do i.getEdge().setInResult(!0),i=i.getNext();while(i!==this._startDe)}},{key:"containsPoint",value:function(i){var e=this.getLinearRing();if(!e.getEnvelopeInternal().contains(i)||!Kn.isInRing(i,e.getCoordinates()))return!1;for(var t=this._holes.iterator();t.hasNext();)if(t.next().containsPoint(i))return!1;return!0}},{key:"addHole",value:function(i){this._holes.add(i)}},{key:"isShell",value:function(){return this._shell===null}},{key:"getLabel",value:function(){return this._label}},{key:"getEdges",value:function(){return this._edges}},{key:"getMaxNodeDegree",value:function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree}},{key:"getShell",value:function(){return this._shell}},{key:"mergeLabel",value:function(){if(arguments.length===1){var i=arguments[0];this.mergeLabel(i,0),this.mergeLabel(i,1)}else if(arguments.length===2){var e=arguments[1],t=arguments[0].getLocation(e,H.RIGHT);if(t===I.NONE)return null;if(this._label.getLocation(e)===I.NONE)return this._label.setLocation(e,t),null}}},{key:"setShell",value:function(i){this._shell=i,i!==null&&i.addHole(this)}},{key:"toPolygon",value:function(i){for(var e=new Array(this._holes.size()).fill(null),t=0;t<this._holes.size();t++)e[t]=this._holes.get(t).getLinearRing();return i.createPolygon(this.getLinearRing(),e)}}],[{key:"constructor_",value:function(){if(this._startDe=null,this._maxNodeDegree=-1,this._edges=new ue,this._pts=new ue,this._label=new $e(I.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new ue,this._geometryFactory=null,arguments.length!==0){if(arguments.length===2){var i=arguments[0],e=arguments[1];this._geometryFactory=e,this.computePoints(i),this.computeRing()}}}}])}(),Ys=function(i){function e(){var t;return o(this,e),t=c(this,e),e.constructor_.apply(t,arguments),t}return N(e,i),g(e,[{key:"setEdgeRing",value:function(t,n){t.setMinEdgeRing(n)}},{key:"getNext",value:function(t){return t.getNextMin()}}],[{key:"constructor_",value:function(){var t=arguments[0],n=arguments[1];mn.constructor_.call(this,t,n)}}])}(mn),Us=function(i){function e(){var t;return o(this,e),t=c(this,e),e.constructor_.apply(t,arguments),t}return N(e,i),g(e,[{key:"buildMinimalRings",value:function(){var t=new ue,n=this._startDe;do{if(n.getMinEdgeRing()===null){var r=new Ys(n,this._geometryFactory);t.add(r)}n=n.getNext()}while(n!==this._startDe);return t}},{key:"setEdgeRing",value:function(t,n){t.setEdgeRing(n)}},{key:"linkDirectedEdgesForMinimalEdgeRings",value:function(){var t=this._startDe;do t.getNode().getEdges().linkMinimalDirectedEdges(this),t=t.getNext();while(t!==this._startDe)}},{key:"getNext",value:function(t){return t.getNext()}}],[{key:"constructor_",value:function(){var t=arguments[0],n=arguments[1];mn.constructor_.call(this,t,n)}}])}(mn),qi=function(){return g(function i(){o(this,i),i.constructor_.apply(this,arguments)},[{key:"setVisited",value:function(i){this._isVisited=i}},{key:"setInResult",value:function(i){this._isInResult=i}},{key:"isCovered",value:function(){return this._isCovered}},{key:"isCoveredSet",value:function(){return this._isCoveredSet}},{key:"setLabel",value:function(i){this._label=i}},{key:"getLabel",value:function(){return this._label}},{key:"setCovered",value:function(i){this._isCovered=i,this._isCoveredSet=!0}},{key:"updateIM",value:function(i){ne.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(i)}},{key:"isInResult",value:function(){return this._isInResult}},{key:"isVisited",value:function(){return this._isVisited}}],[{key:"constructor_",value:function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,arguments.length!==0){if(arguments.length===1){var i=arguments[0];this._label=i}}}}])}(),yn=function(i){function e(){var t;return o(this,e),t=c(this,e),e.constructor_.apply(t,arguments),t}return N(e,i),g(e,[{key:"isIncidentEdgeInResult",value:function(){for(var t=this.getEdges().getEdges().iterator();t.hasNext();)if(t.next().getEdge().isInResult())return!0;return!1}},{key:"isIsolated",value:function(){return this._label.getGeometryCount()===1}},{key:"getCoordinate",value:function(){return this._coord}},{key:"print",value:function(t){t.println("node "+this._coord+" lbl: "+this._label)}},{key:"computeIM",value:function(t){}},{key:"computeMergedLocation",value:function(t,n){var r=I.NONE;if(r=this._label.getLocation(n),!t.isNull(n)){var s=t.getLocation(n);r!==I.BOUNDARY&&(r=s)}return r}},{key:"setLabel",value:function(){if(arguments.length!==2||!Number.isInteger(arguments[1])||!Number.isInteger(arguments[0]))return b(e,"setLabel",this,1).apply(this,arguments);var t=arguments[0],n=arguments[1];this._label===null?this._label=new $e(t,n):this._label.setLocation(t,n)}},{key:"getEdges",value:function(){return this._edges}},{key:"mergeLabel",value:function(){if(arguments[0]instanceof e){var t=arguments[0];this.mergeLabel(t._label)}else if(arguments[0]instanceof $e)for(var n=arguments[0],r=0;r<2;r++){var s=this.computeMergedLocation(n,r);this._label.getLocation(r)===I.NONE&&this._label.setLocation(r,s)}}},{key:"add",value:function(t){this._edges.insert(t),t.setNode(this)}},{key:"setLabelBoundary",value:function(t){if(this._label===null)return null;var n=I.NONE;this._label!==null&&(n=this._label.getLocation(t));var r=null;switch(n){case I.BOUNDARY:r=I.INTERIOR;break;case I.INTERIOR:default:r=I.BOUNDARY}this._label.setLocation(t,r)}}],[{key:"constructor_",value:function(){this._coord=null,this._edges=null;var t=arguments[0],n=arguments[1];this._coord=t,this._edges=n,this._label=new $e(0,I.NONE)}}])}(qi),Xs=function(i){function e(){return o(this,e),c(this,e,arguments)}return N(e,i),g(e)}(bi);function Bi(i){return i==null?0:i.color}function _e(i){return i==null?null:i.parent}function rt(i,e){i!==null&&(i.color=e)}function Qn(i){return i==null?null:i.left}function zi(i){return i==null?null:i.right}var Wt=function(i){function e(){var t;return o(this,e),(t=c(this,e)).root_=null,t.size_=0,t}return N(e,i),g(e,[{key:"get",value:function(t){for(var n=this.root_;n!==null;){var r=t.compareTo(n.key);if(r<0)n=n.left;else{if(!(r>0))return n.value;n=n.right}}return null}},{key:"put",value:function(t,n){if(this.root_===null)return this.root_={key:t,value:n,left:null,right:null,parent:null,color:0,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var r,s,h=this.root_;do if(r=h,(s=t.compareTo(h.key))<0)h=h.left;else{if(!(s>0)){var f=h.value;return h.value=n,f}h=h.right}while(h!==null);var m={key:t,left:null,right:null,value:n,parent:r,color:0,getValue:function(){return this.value},getKey:function(){return this.key}};return s<0?r.left=m:r.right=m,this.fixAfterInsertion(m),this.size_++,null}},{key:"fixAfterInsertion",value:function(t){var n;for(t.color=1;t!=null&&t!==this.root_&&t.parent.color===1;)_e(t)===Qn(_e(_e(t)))?Bi(n=zi(_e(_e(t))))===1?(rt(_e(t),0),rt(n,0),rt(_e(_e(t)),1),t=_e(_e(t))):(t===zi(_e(t))&&(t=_e(t),this.rotateLeft(t)),rt(_e(t),0),rt(_e(_e(t)),1),this.rotateRight(_e(_e(t)))):Bi(n=Qn(_e(_e(t))))===1?(rt(_e(t),0),rt(n,0),rt(_e(_e(t)),1),t=_e(_e(t))):(t===Qn(_e(t))&&(t=_e(t),this.rotateRight(t)),rt(_e(t),0),rt(_e(_e(t)),1),this.rotateLeft(_e(_e(t))));this.root_.color=0}},{key:"values",value:function(){var t=new ue,n=this.getFirstEntry();if(n!==null)for(t.add(n.value);(n=e.successor(n))!==null;)t.add(n.value);return t}},{key:"entrySet",value:function(){var t=new Bn,n=this.getFirstEntry();if(n!==null)for(t.add(n);(n=e.successor(n))!==null;)t.add(n);return t}},{key:"rotateLeft",value:function(t){if(t!=null){var n=t.right;t.right=n.left,n.left!=null&&(n.left.parent=t),n.parent=t.parent,t.parent==null?this.root_=n:t.parent.left===t?t.parent.left=n:t.parent.right=n,n.left=t,t.parent=n}}},{key:"rotateRight",value:function(t){if(t!=null){var n=t.left;t.left=n.right,n.right!=null&&(n.right.parent=t),n.parent=t.parent,t.parent==null?this.root_=n:t.parent.right===t?t.parent.right=n:t.parent.left=n,n.right=t,t.parent=n}}},{key:"getFirstEntry",value:function(){var t=this.root_;if(t!=null)for(;t.left!=null;)t=t.left;return t}},{key:"size",value:function(){return this.size_}},{key:"containsKey",value:function(t){for(var n=this.root_;n!==null;){var r=t.compareTo(n.key);if(r<0)n=n.left;else{if(!(r>0))return!0;n=n.right}}return!1}}],[{key:"successor",value:function(t){var n;if(t===null)return null;if(t.right!==null){for(n=t.right;n.left!==null;)n=n.left;return n}n=t.parent;for(var r=t;n!==null&&r===n.right;)r=n,n=n.parent;return n}}])}(Xs),Yi=function(){return g(function i(){o(this,i),i.constructor_.apply(this,arguments)},[{key:"find",value:function(i){return this.nodeMap.get(i)}},{key:"addNode",value:function(){if(arguments[0]instanceof F){var i=arguments[0],e=this.nodeMap.get(i);return e===null&&(e=this.nodeFact.createNode(i),this.nodeMap.put(i,e)),e}if(arguments[0]instanceof yn){var t=arguments[0],n=this.nodeMap.get(t.getCoordinate());return n===null?(this.nodeMap.put(t.getCoordinate(),t),t):(n.mergeLabel(t),n)}}},{key:"print",value:function(i){for(var e=this.iterator();e.hasNext();)e.next().print(i)}},{key:"iterator",value:function(){return this.nodeMap.values().iterator()}},{key:"values",value:function(){return this.nodeMap.values()}},{key:"getBoundaryNodes",value:function(i){for(var e=new ue,t=this.iterator();t.hasNext();){var n=t.next();n.getLabel().getLocation(i)===I.BOUNDARY&&e.add(n)}return e}},{key:"add",value:function(i){var e=i.getCoordinate();this.addNode(e).add(i)}}],[{key:"constructor_",value:function(){this.nodeMap=new Wt,this.nodeFact=null;var i=arguments[0];this.nodeFact=i}}])}(),Fe=function(){function i(){o(this,i)}return g(i,null,[{key:"isNorthern",value:function(e){return e===i.NE||e===i.NW}},{key:"isOpposite",value:function(e,t){return e!==t&&(e-t+4)%4===2}},{key:"commonHalfPlane",value:function(e,t){if(e===t)return e;if((e-t+4)%4===2)return-1;var n=e<t?e:t;return n===0&&(e>t?e:t)===3?3:n}},{key:"isInHalfPlane",value:function(e,t){return t===i.SE?e===i.SE||e===i.SW:e===t||e===t+1}},{key:"quadrant",value:function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var e=arguments[0],t=arguments[1];if(e===0&&t===0)throw new W("Cannot compute the quadrant for point ( "+e+", "+t+" )");return e>=0?t>=0?i.NE:i.SE:t>=0?i.NW:i.SW}if(arguments[0]instanceof F&&arguments[1]instanceof F){var n=arguments[0],r=arguments[1];if(r.x===n.x&&r.y===n.y)throw new W("Cannot compute the quadrant for two identical points "+n);return r.x>=n.x?r.y>=n.y?i.NE:i.SE:r.y>=n.y?i.NW:i.SW}}}])}();Fe.NE=0,Fe.NW=1,Fe.SW=2,Fe.SE=3;var Ui=function(){function i(){o(this,i),i.constructor_.apply(this,arguments)}return g(i,[{key:"compareDirection",value:function(e){return this._dx===e._dx&&this._dy===e._dy?0:this._quadrant>e._quadrant?1:this._quadrant<e._quadrant?-1:he.index(e._p0,e._p1,this._p1)}},{key:"getDy",value:function(){return this._dy}},{key:"getCoordinate",value:function(){return this._p0}},{key:"setNode",value:function(e){this._node=e}},{key:"print",value:function(e){var t=Math.atan2(this._dy,this._dx),n=this.getClass().getName(),r=n.lastIndexOf("."),s=n.substring(r+1);e.print("  "+s+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+t+"   "+this._label)}},{key:"compareTo",value:function(e){var t=e;return this.compareDirection(t)}},{key:"getDirectedCoordinate",value:function(){return this._p1}},{key:"getDx",value:function(){return this._dx}},{key:"getLabel",value:function(){return this._label}},{key:"getEdge",value:function(){return this._edge}},{key:"getQuadrant",value:function(){return this._quadrant}},{key:"getNode",value:function(){return this._node}},{key:"toString",value:function(){var e=Math.atan2(this._dy,this._dx),t=this.getClass().getName(),n=t.lastIndexOf(".");return"  "+t.substring(n+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+e+"   "+this._label}},{key:"computeLabel",value:function(e){}},{key:"init",value:function(e,t){this._p0=e,this._p1=t,this._dx=t.x-e.x,this._dy=t.y-e.y,this._quadrant=Fe.quadrant(this._dx,this._dy),ne.isTrue(!(this._dx===0&&this._dy===0),"EdgeEnd with identical endpoints found")}},{key:"interfaces_",get:function(){return[ie]}}],[{key:"constructor_",value:function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,arguments.length===1){var e=arguments[0];this._edge=e}else if(arguments.length===3){var t=arguments[0],n=arguments[1],r=arguments[2];i.constructor_.call(this,t,n,r,null)}else if(arguments.length===4){var s=arguments[0],h=arguments[1],f=arguments[2],m=arguments[3];i.constructor_.call(this,s),this.init(h,f),this._label=m}}}])}(),ei=function(i){function e(){var t;return o(this,e),t=c(this,e),e.constructor_.apply(t,arguments),t}return N(e,i),g(e,[{key:"getNextMin",value:function(){return this._nextMin}},{key:"getDepth",value:function(t){return this._depth[t]}},{key:"setVisited",value:function(t){this._isVisited=t}},{key:"computeDirectedLabel",value:function(){this._label=new $e(this._edge.getLabel()),this._isForward||this._label.flip()}},{key:"getNext",value:function(){return this._next}},{key:"setDepth",value:function(t,n){if(this._depth[t]!==-999&&this._depth[t]!==n)throw new ct("assigned depths do not match",this.getCoordinate());this._depth[t]=n}},{key:"isInteriorAreaEdge",value:function(){for(var t=!0,n=0;n<2;n++)this._label.isArea(n)&&this._label.getLocation(n,H.LEFT)===I.INTERIOR&&this._label.getLocation(n,H.RIGHT)===I.INTERIOR||(t=!1);return t}},{key:"setNextMin",value:function(t){this._nextMin=t}},{key:"print",value:function(t){b(e,"print",this,1).call(this,t),t.print(" "+this._depth[H.LEFT]+"/"+this._depth[H.RIGHT]),t.print(" ("+this.getDepthDelta()+")"),this._isInResult&&t.print(" inResult")}},{key:"setMinEdgeRing",value:function(t){this._minEdgeRing=t}},{key:"isLineEdge",value:function(){var t=this._label.isLine(0)||this._label.isLine(1),n=!this._label.isArea(0)||this._label.allPositionsEqual(0,I.EXTERIOR),r=!this._label.isArea(1)||this._label.allPositionsEqual(1,I.EXTERIOR);return t&&n&&r}},{key:"setEdgeRing",value:function(t){this._edgeRing=t}},{key:"getMinEdgeRing",value:function(){return this._minEdgeRing}},{key:"getDepthDelta",value:function(){var t=this._edge.getDepthDelta();return this._isForward||(t=-t),t}},{key:"setInResult",value:function(t){this._isInResult=t}},{key:"getSym",value:function(){return this._sym}},{key:"isForward",value:function(){return this._isForward}},{key:"getEdge",value:function(){return this._edge}},{key:"printEdge",value:function(t){this.print(t),t.print(" "),this._isForward?this._edge.print(t):this._edge.printReverse(t)}},{key:"setSym",value:function(t){this._sym=t}},{key:"setVisitedEdge",value:function(t){this.setVisited(t),this._sym.setVisited(t)}},{key:"setEdgeDepths",value:function(t,n){var r=this.getEdge().getDepthDelta();this._isForward||(r=-r);var s=1;t===H.LEFT&&(s=-1);var h=H.opposite(t),f=n+r*s;this.setDepth(t,n),this.setDepth(h,f)}},{key:"getEdgeRing",value:function(){return this._edgeRing}},{key:"isInResult",value:function(){return this._isInResult}},{key:"setNext",value:function(t){this._next=t}},{key:"isVisited",value:function(){return this._isVisited}}],[{key:"constructor_",value:function(){this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999];var t=arguments[0],n=arguments[1];if(Ui.constructor_.call(this,t),this._isForward=n,n)this.init(t.getCoordinate(0),t.getCoordinate(1));else{var r=t.getNumPoints()-1;this.init(t.getCoordinate(r),t.getCoordinate(r-1))}this.computeDirectedLabel()}},{key:"depthFactor",value:function(t,n){return t===I.EXTERIOR&&n===I.INTERIOR?1:t===I.INTERIOR&&n===I.EXTERIOR?-1:0}}])}(Ui),Xi=function(){return g(function i(){o(this,i)},[{key:"createNode",value:function(i){return new yn(i,null)}}])}(),Vi=function(){return g(function i(){o(this,i),i.constructor_.apply(this,arguments)},[{key:"printEdges",value:function(i){i.println("Edges:");for(var e=0;e<this._edges.size();e++){i.println("edge "+e+":");var t=this._edges.get(e);t.print(i),t.eiList.print(i)}}},{key:"find",value:function(i){return this._nodes.find(i)}},{key:"addNode",value:function(){if(arguments[0]instanceof yn){var i=arguments[0];return this._nodes.addNode(i)}if(arguments[0]instanceof F){var e=arguments[0];return this._nodes.addNode(e)}}},{key:"getNodeIterator",value:function(){return this._nodes.iterator()}},{key:"linkResultDirectedEdges",value:function(){for(var i=this._nodes.iterator();i.hasNext();)i.next().getEdges().linkResultDirectedEdges()}},{key:"debugPrintln",value:function(i){Xe.out.println(i)}},{key:"isBoundaryNode",value:function(i,e){var t=this._nodes.find(e);if(t===null)return!1;var n=t.getLabel();return n!==null&&n.getLocation(i)===I.BOUNDARY}},{key:"linkAllDirectedEdges",value:function(){for(var i=this._nodes.iterator();i.hasNext();)i.next().getEdges().linkAllDirectedEdges()}},{key:"matchInSameDirection",value:function(i,e,t,n){return!!i.equals(t)&&he.index(i,e,n)===he.COLLINEAR&&Fe.quadrant(i,e)===Fe.quadrant(t,n)}},{key:"getEdgeEnds",value:function(){return this._edgeEndList}},{key:"debugPrint",value:function(i){Xe.out.print(i)}},{key:"getEdgeIterator",value:function(){return this._edges.iterator()}},{key:"findEdgeInSameDirection",value:function(i,e){for(var t=0;t<this._edges.size();t++){var n=this._edges.get(t),r=n.getCoordinates();if(this.matchInSameDirection(i,e,r[0],r[1])||this.matchInSameDirection(i,e,r[r.length-1],r[r.length-2]))return n}return null}},{key:"insertEdge",value:function(i){this._edges.add(i)}},{key:"findEdgeEnd",value:function(i){for(var e=this.getEdgeEnds().iterator();e.hasNext();){var t=e.next();if(t.getEdge()===i)return t}return null}},{key:"addEdges",value:function(i){for(var e=i.iterator();e.hasNext();){var t=e.next();this._edges.add(t);var n=new ei(t,!0),r=new ei(t,!1);n.setSym(r),r.setSym(n),this.add(n),this.add(r)}}},{key:"add",value:function(i){this._nodes.add(i),this._edgeEndList.add(i)}},{key:"getNodes",value:function(){return this._nodes.values()}},{key:"findEdge",value:function(i,e){for(var t=0;t<this._edges.size();t++){var n=this._edges.get(t),r=n.getCoordinates();if(i.equals(r[0])&&e.equals(r[1]))return n}return null}}],[{key:"constructor_",value:function(){if(this._edges=new ue,this._nodes=null,this._edgeEndList=new ue,arguments.length===0)this._nodes=new Yi(new Xi);else if(arguments.length===1){var i=arguments[0];this._nodes=new Yi(i)}}},{key:"linkResultDirectedEdges",value:function(i){for(var e=i.iterator();e.hasNext();)e.next().getEdges().linkResultDirectedEdges()}}])}(),Vs=function(){function i(){o(this,i),i.constructor_.apply(this,arguments)}return g(i,[{key:"sortShellsAndHoles",value:function(e,t,n){for(var r=e.iterator();r.hasNext();){var s=r.next();s.isHole()?n.add(s):t.add(s)}}},{key:"computePolygons",value:function(e){for(var t=new ue,n=e.iterator();n.hasNext();){var r=n.next().toPolygon(this._geometryFactory);t.add(r)}return t}},{key:"placeFreeHoles",value:function(e,t){for(var n=t.iterator();n.hasNext();){var r=n.next();if(r.getShell()===null){var s=i.findEdgeRingContaining(r,e);if(s===null)throw new ct("unable to assign hole to a shell",r.getCoordinate(0));r.setShell(s)}}}},{key:"buildMinimalEdgeRings",value:function(e,t,n){for(var r=new ue,s=e.iterator();s.hasNext();){var h=s.next();if(h.getMaxNodeDegree()>2){h.linkDirectedEdgesForMinimalEdgeRings();var f=h.buildMinimalRings(),m=this.findShell(f);m!==null?(this.placePolygonHoles(m,f),t.add(m)):n.addAll(f)}else r.add(h)}return r}},{key:"buildMaximalEdgeRings",value:function(e){for(var t=new ue,n=e.iterator();n.hasNext();){var r=n.next();if(r.isInResult()&&r.getLabel().isArea()&&r.getEdgeRing()===null){var s=new Us(r,this._geometryFactory);t.add(s),s.setInResult()}}return t}},{key:"placePolygonHoles",value:function(e,t){for(var n=t.iterator();n.hasNext();){var r=n.next();r.isHole()&&r.setShell(e)}}},{key:"getPolygons",value:function(){return this.computePolygons(this._shellList)}},{key:"findShell",value:function(e){for(var t=0,n=null,r=e.iterator();r.hasNext();){var s=r.next();s.isHole()||(n=s,t++)}return ne.isTrue(t<=1,"found two shells in MinimalEdgeRing list"),n}},{key:"add",value:function(){if(arguments.length===1){var e=arguments[0];this.add(e.getEdgeEnds(),e.getNodes())}else if(arguments.length===2){var t=arguments[0],n=arguments[1];Vi.linkResultDirectedEdges(n);var r=this.buildMaximalEdgeRings(t),s=new ue,h=this.buildMinimalEdgeRings(r,this._shellList,s);this.sortShellsAndHoles(h,this._shellList,s),this.placeFreeHoles(this._shellList,s)}}}],[{key:"constructor_",value:function(){this._geometryFactory=null,this._shellList=new ue;var e=arguments[0];this._geometryFactory=e}},{key:"findEdgeRingContaining",value:function(e,t){for(var n=e.getLinearRing(),r=n.getEnvelopeInternal(),s=n.getCoordinateN(0),h=null,f=null,m=t.iterator();m.hasNext();){var _=m.next(),P=_.getLinearRing(),G=P.getEnvelopeInternal();if(!G.equals(r)&&G.contains(r)){s=be.ptNotInList(n.getCoordinates(),P.getCoordinates());var $=!1;Kn.isInRing(s,P.getCoordinates())&&($=!0),$&&(h===null||f.contains(G))&&(f=(h=_).getLinearRing().getEnvelopeInternal())}}return h}}])}(),$i=function(){return g(function i(){o(this,i)},[{key:"getBounds",value:function(){}}])}(),gt=function(){return g(function i(){o(this,i),i.constructor_.apply(this,arguments)},[{key:"getItem",value:function(){return this._item}},{key:"getBounds",value:function(){return this._bounds}},{key:"interfaces_",get:function(){return[$i,v]}}],[{key:"constructor_",value:function(){this._bounds=null,this._item=null;var i=arguments[0],e=arguments[1];this._bounds=i,this._item=e}}])}(),dn=function(){return g(function i(){o(this,i),i.constructor_.apply(this,arguments)},[{key:"poll",value:function(){if(this.isEmpty())return null;var i=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),i}},{key:"size",value:function(){return this._size}},{key:"reorder",value:function(i){for(var e=null,t=this._items.get(i);2*i<=this._size&&((e=2*i)!==this._size&&this._items.get(e+1).compareTo(this._items.get(e))<0&&e++,this._items.get(e).compareTo(t)<0);i=e)this._items.set(i,this._items.get(e));this._items.set(i,t)}},{key:"clear",value:function(){this._size=0,this._items.clear()}},{key:"peek",value:function(){return this.isEmpty()?null:this._items.get(1)}},{key:"isEmpty",value:function(){return this._size===0}},{key:"add",value:function(i){this._items.add(null),this._size+=1;var e=this._size;for(this._items.set(0,i);i.compareTo(this._items.get(Math.trunc(e/2)))<0;e/=2)this._items.set(e,this._items.get(Math.trunc(e/2)));this._items.set(e,i)}}],[{key:"constructor_",value:function(){this._size=null,this._items=null,this._size=0,this._items=new ue,this._items.add(null)}}])}(),$s=function(){return g(function i(){o(this,i)},[{key:"insert",value:function(i,e){}},{key:"remove",value:function(i,e){}},{key:"query",value:function(){}}])}(),He=function(){return g(function i(){o(this,i),i.constructor_.apply(this,arguments)},[{key:"getLevel",value:function(){return this._level}},{key:"size",value:function(){return this._childBoundables.size()}},{key:"getChildBoundables",value:function(){return this._childBoundables}},{key:"addChildBoundable",value:function(i){ne.isTrue(this._bounds===null),this._childBoundables.add(i)}},{key:"isEmpty",value:function(){return this._childBoundables.isEmpty()}},{key:"getBounds",value:function(){return this._bounds===null&&(this._bounds=this.computeBounds()),this._bounds}},{key:"interfaces_",get:function(){return[$i,v]}}],[{key:"constructor_",value:function(){if(this._childBoundables=new ue,this._bounds=null,this._level=null,arguments.length!==0){if(arguments.length===1){var i=arguments[0];this._level=i}}}}])}(),Mt={reverseOrder:function(){return{compare:function(i,e){return e.compareTo(i)}}},min:function(i){return Mt.sort(i),i.get(0)},sort:function(i,e){var t=i.toArray();e?kt.sort(t,e):kt.sort(t);for(var n=i.iterator(),r=0,s=t.length;r<s;r++)n.next(),n.set(t[r])},singletonList:function(i){var e=new ue;return e.add(i),e}},Hs=function(){function i(){o(this,i)}return g(i,null,[{key:"maxDistance",value:function(e,t,n,r,s,h,f,m){var _=i.distance(e,t,s,h);return _=Math.max(_,i.distance(e,t,f,m)),_=Math.max(_,i.distance(n,r,s,h)),_=Math.max(_,i.distance(n,r,f,m))}},{key:"distance",value:function(e,t,n,r){var s=n-e,h=r-t;return Math.sqrt(s*s+h*h)}},{key:"maximumDistance",value:function(e,t){var n=Math.min(e.getMinX(),t.getMinX()),r=Math.min(e.getMinY(),t.getMinY()),s=Math.max(e.getMaxX(),t.getMaxX()),h=Math.max(e.getMaxY(),t.getMaxY());return i.distance(n,r,s,h)}},{key:"minMaxDistance",value:function(e,t){var n=e.getMinX(),r=e.getMinY(),s=e.getMaxX(),h=e.getMaxY(),f=t.getMinX(),m=t.getMinY(),_=t.getMaxX(),P=t.getMaxY(),G=i.maxDistance(n,r,n,h,f,m,f,P);return G=Math.min(G,i.maxDistance(n,r,n,h,f,m,_,m)),G=Math.min(G,i.maxDistance(n,r,n,h,_,P,f,P)),G=Math.min(G,i.maxDistance(n,r,n,h,_,P,_,m)),G=Math.min(G,i.maxDistance(n,r,s,r,f,m,f,P)),G=Math.min(G,i.maxDistance(n,r,s,r,f,m,_,m)),G=Math.min(G,i.maxDistance(n,r,s,r,_,P,f,P)),G=Math.min(G,i.maxDistance(n,r,s,r,_,P,_,m)),G=Math.min(G,i.maxDistance(s,h,n,h,f,m,f,P)),G=Math.min(G,i.maxDistance(s,h,n,h,f,m,_,m)),G=Math.min(G,i.maxDistance(s,h,n,h,_,P,f,P)),G=Math.min(G,i.maxDistance(s,h,n,h,_,P,_,m)),G=Math.min(G,i.maxDistance(s,h,s,r,f,m,f,P)),G=Math.min(G,i.maxDistance(s,h,s,r,f,m,_,m)),G=Math.min(G,i.maxDistance(s,h,s,r,_,P,f,P)),G=Math.min(G,i.maxDistance(s,h,s,r,_,P,_,m))}}])}(),Pt=function(){function i(){o(this,i),i.constructor_.apply(this,arguments)}return g(i,[{key:"maximumDistance",value:function(){return Hs.maximumDistance(this._boundable1.getBounds(),this._boundable2.getBounds())}},{key:"expandToQueue",value:function(e,t){var n=i.isComposite(this._boundable1),r=i.isComposite(this._boundable2);if(n&&r)return i.area(this._boundable1)>i.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,!1,e,t),null):(this.expand(this._boundable2,this._boundable1,!0,e,t),null);if(n)return this.expand(this._boundable1,this._boundable2,!1,e,t),null;if(r)return this.expand(this._boundable2,this._boundable1,!0,e,t),null;throw new W("neither boundable is composite")}},{key:"isLeaves",value:function(){return!(i.isComposite(this._boundable1)||i.isComposite(this._boundable2))}},{key:"compareTo",value:function(e){var t=e;return this._distance<t._distance?-1:this._distance>t._distance?1:0}},{key:"expand",value:function(e,t,n,r,s){for(var h=e.getChildBoundables().iterator();h.hasNext();){var f=h.next(),m=null;(m=n?new i(t,f,this._itemDistance):new i(f,t,this._itemDistance)).getDistance()<s&&r.add(m)}}},{key:"getBoundable",value:function(e){return e===0?this._boundable1:this._boundable2}},{key:"getDistance",value:function(){return this._distance}},{key:"distance",value:function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())}},{key:"interfaces_",get:function(){return[ie]}}],[{key:"constructor_",value:function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var e=arguments[0],t=arguments[1],n=arguments[2];this._boundable1=e,this._boundable2=t,this._itemDistance=n,this._distance=this.distance()}},{key:"area",value:function(e){return e.getBounds().getArea()}},{key:"isComposite",value:function(e){return e instanceof He}}])}(),Hi=function(){return g(function i(){o(this,i)},[{key:"visitItem",value:function(i){}}])}(),At=function(){function i(){o(this,i),i.constructor_.apply(this,arguments)}return g(i,[{key:"queryInternal",value:function(){if(ge(arguments[2],Hi)&&arguments[0]instanceof Object&&arguments[1]instanceof He)for(var e=arguments[0],t=arguments[2],n=arguments[1].getChildBoundables(),r=0;r<n.size();r++){var s=n.get(r);this.getIntersectsOp().intersects(s.getBounds(),e)&&(s instanceof He?this.queryInternal(e,s,t):s instanceof gt?t.visitItem(s.getItem()):ne.shouldNeverReachHere())}else if(ge(arguments[2],xt)&&arguments[0]instanceof Object&&arguments[1]instanceof He)for(var h=arguments[0],f=arguments[2],m=arguments[1].getChildBoundables(),_=0;_<m.size();_++){var P=m.get(_);this.getIntersectsOp().intersects(P.getBounds(),h)&&(P instanceof He?this.queryInternal(h,P,f):P instanceof gt?f.add(P.getItem()):ne.shouldNeverReachHere())}}},{key:"getNodeCapacity",value:function(){return this._nodeCapacity}},{key:"lastNode",value:function(e){return e.get(e.size()-1)}},{key:"size",value:function(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.size(this._root));if(arguments.length===1){for(var e=0,t=arguments[0].getChildBoundables().iterator();t.hasNext();){var n=t.next();n instanceof He?e+=this.size(n):n instanceof gt&&(e+=1)}return e}}},{key:"removeItem",value:function(e,t){for(var n=null,r=e.getChildBoundables().iterator();r.hasNext();){var s=r.next();s instanceof gt&&s.getItem()===t&&(n=s)}return n!==null&&(e.getChildBoundables().remove(n),!0)}},{key:"itemsTree",value:function(){if(arguments.length===0){this.build();var e=this.itemsTree(this._root);return e===null?new ue:e}if(arguments.length===1){for(var t=arguments[0],n=new ue,r=t.getChildBoundables().iterator();r.hasNext();){var s=r.next();if(s instanceof He){var h=this.itemsTree(s);h!==null&&n.add(h)}else s instanceof gt?n.add(s.getItem()):ne.shouldNeverReachHere()}return n.size()<=0?null:n}}},{key:"insert",value:function(e,t){ne.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new gt(e,t))}},{key:"boundablesAtLevel",value:function(){if(arguments.length===1){var e=arguments[0],t=new ue;return this.boundablesAtLevel(e,this._root,t),t}if(arguments.length===3){var n=arguments[0],r=arguments[1],s=arguments[2];if(ne.isTrue(n>-2),r.getLevel()===n)return s.add(r),null;for(var h=r.getChildBoundables().iterator();h.hasNext();){var f=h.next();f instanceof He?this.boundablesAtLevel(n,f,s):(ne.isTrue(f instanceof gt),n===-1&&s.add(f))}return null}}},{key:"query",value:function(){if(arguments.length===1){var e=arguments[0];this.build();var t=new ue;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),e)&&this.queryInternal(e,this._root,t),t}if(arguments.length===2){var n=arguments[0],r=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),n)&&this.queryInternal(n,this._root,r)}}},{key:"build",value:function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0}},{key:"getRoot",value:function(){return this.build(),this._root}},{key:"remove",value:function(){if(arguments.length===2){var e=arguments[0],t=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),e)&&this.remove(e,this._root,t)}if(arguments.length===3){var n=arguments[0],r=arguments[1],s=arguments[2],h=this.removeItem(r,s);if(h)return!0;for(var f=null,m=r.getChildBoundables().iterator();m.hasNext();){var _=m.next();if(this.getIntersectsOp().intersects(_.getBounds(),n)&&_ instanceof He&&(h=this.remove(n,_,s))){f=_;break}}return f!==null&&f.getChildBoundables().isEmpty()&&r.getChildBoundables().remove(f),h}}},{key:"createHigherLevels",value:function(e,t){ne.isTrue(!e.isEmpty());var n=this.createParentBoundables(e,t+1);return n.size()===1?n.get(0):this.createHigherLevels(n,t+1)}},{key:"depth",value:function(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(arguments.length===1){for(var e=0,t=arguments[0].getChildBoundables().iterator();t.hasNext();){var n=t.next();if(n instanceof He){var r=this.depth(n);r>e&&(e=r)}}return e+1}}},{key:"createParentBoundables",value:function(e,t){ne.isTrue(!e.isEmpty());var n=new ue;n.add(this.createNode(t));var r=new ue(e);Mt.sort(r,this.getComparator());for(var s=r.iterator();s.hasNext();){var h=s.next();this.lastNode(n).getChildBoundables().size()===this.getNodeCapacity()&&n.add(this.createNode(t)),this.lastNode(n).addChildBoundable(h)}return n}},{key:"isEmpty",value:function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()}},{key:"interfaces_",get:function(){return[v]}}],[{key:"constructor_",value:function(){if(this._root=null,this._built=!1,this._itemBoundables=new ue,this._nodeCapacity=null,arguments.length===0)i.constructor_.call(this,i.DEFAULT_NODE_CAPACITY);else if(arguments.length===1){var e=arguments[0];ne.isTrue(e>1,"Node capacity must be greater than 1"),this._nodeCapacity=e}}},{key:"compareDoubles",value:function(e,t){return e>t?1:e<t?-1:0}}])}();At.IntersectsOp=function(){},At.DEFAULT_NODE_CAPACITY=10;var js=function(){return g(function i(){o(this,i)},[{key:"distance",value:function(i,e){}}])}(),st=function(i){function e(){var t;return o(this,e),t=c(this,e),e.constructor_.apply(t,arguments),t}return N(e,i),g(e,[{key:"createParentBoundablesFromVerticalSlices",value:function(t,n){ne.isTrue(t.length>0);for(var r=new ue,s=0;s<t.length;s++)r.addAll(this.createParentBoundablesFromVerticalSlice(t[s],n));return r}},{key:"nearestNeighbourK",value:function(){if(arguments.length===2){var t=arguments[0],n=arguments[1];return this.nearestNeighbourK(t,z.POSITIVE_INFINITY,n)}if(arguments.length===3){var r=arguments[0],s=arguments[2],h=arguments[1],f=new dn;f.add(r);for(var m=new dn;!f.isEmpty()&&h>=0;){var _=f.poll(),P=_.getDistance();if(P>=h)break;_.isLeaves()?m.size()<s?m.add(_):(m.peek().getDistance()>P&&(m.poll(),m.add(_)),h=m.peek().getDistance()):_.expandToQueue(f,h)}return e.getItems(m)}}},{key:"createNode",value:function(t){return new ji(t)}},{key:"size",value:function(){return arguments.length===0?b(e,"size",this,1).call(this):b(e,"size",this,1).apply(this,arguments)}},{key:"insert",value:function(){if(!(arguments.length===2&&arguments[1]instanceof Object&&arguments[0]instanceof Ee))return b(e,"insert",this,1).apply(this,arguments);var t=arguments[0],n=arguments[1];if(t.isNull())return null;b(e,"insert",this,1).call(this,t,n)}},{key:"getIntersectsOp",value:function(){return e.intersectsOp}},{key:"verticalSlices",value:function(t,n){for(var r=Math.trunc(Math.ceil(t.size()/n)),s=new Array(n).fill(null),h=t.iterator(),f=0;f<n;f++){s[f]=new ue;for(var m=0;h.hasNext()&&m<r;){var _=h.next();s[f].add(_),m++}}return s}},{key:"query",value:function(){if(arguments.length===1){var t=arguments[0];return b(e,"query",this,1).call(this,t)}if(arguments.length===2){var n=arguments[0],r=arguments[1];b(e,"query",this,1).call(this,n,r)}}},{key:"getComparator",value:function(){return e.yComparator}},{key:"createParentBoundablesFromVerticalSlice",value:function(t,n){return b(e,"createParentBoundables",this,1).call(this,t,n)}},{key:"remove",value:function(){if(arguments.length===2&&arguments[1]instanceof Object&&arguments[0]instanceof Ee){var t=arguments[0],n=arguments[1];return b(e,"remove",this,1).call(this,t,n)}return b(e,"remove",this,1).apply(this,arguments)}},{key:"depth",value:function(){return arguments.length===0?b(e,"depth",this,1).call(this):b(e,"depth",this,1).apply(this,arguments)}},{key:"createParentBoundables",value:function(t,n){ne.isTrue(!t.isEmpty());var r=Math.trunc(Math.ceil(t.size()/this.getNodeCapacity())),s=new ue(t);Mt.sort(s,e.xComparator);var h=this.verticalSlices(s,Math.trunc(Math.ceil(Math.sqrt(r))));return this.createParentBoundablesFromVerticalSlices(h,n)}},{key:"nearestNeighbour",value:function(){if(arguments.length===1){if(ge(arguments[0],js)){var t=arguments[0];if(this.isEmpty())return null;var n=new Pt(this.getRoot(),this.getRoot(),t);return this.nearestNeighbour(n)}if(arguments[0]instanceof Pt){var r=arguments[0],s=z.POSITIVE_INFINITY,h=null,f=new dn;for(f.add(r);!f.isEmpty()&&s>0;){var m=f.poll(),_=m.getDistance();if(_>=s)break;m.isLeaves()?(s=_,h=m):m.expandToQueue(f,s)}return h===null?null:[h.getBoundable(0).getItem(),h.getBoundable(1).getItem()]}}else{if(arguments.length===2){var P=arguments[0],G=arguments[1];if(this.isEmpty()||P.isEmpty())return null;var $=new Pt(this.getRoot(),P.getRoot(),G);return this.nearestNeighbour($)}if(arguments.length===3){var Q=arguments[2],se=new gt(arguments[0],arguments[1]),ae=new Pt(this.getRoot(),se,Q);return this.nearestNeighbour(ae)[0]}if(arguments.length===4){var de=arguments[2],me=arguments[3],ke=new gt(arguments[0],arguments[1]),Pe=new Pt(this.getRoot(),ke,de);return this.nearestNeighbourK(Pe,me)}}}},{key:"isWithinDistance",value:function(){if(arguments.length===2){var t=arguments[0],n=arguments[1],r=z.POSITIVE_INFINITY,s=new dn;for(s.add(t);!s.isEmpty();){var h=s.poll(),f=h.getDistance();if(f>n)return!1;if(h.maximumDistance()<=n)return!0;if(h.isLeaves()){if((r=f)<=n)return!0}else h.expandToQueue(s,r)}return!1}if(arguments.length===3){var m=arguments[0],_=arguments[1],P=arguments[2],G=new Pt(this.getRoot(),m.getRoot(),_);return this.isWithinDistance(G,P)}}},{key:"interfaces_",get:function(){return[$s,v]}}],[{key:"constructor_",value:function(){if(arguments.length===0)e.constructor_.call(this,e.DEFAULT_NODE_CAPACITY);else if(arguments.length===1){var t=arguments[0];At.constructor_.call(this,t)}}},{key:"centreX",value:function(t){return e.avg(t.getMinX(),t.getMaxX())}},{key:"avg",value:function(t,n){return(t+n)/2}},{key:"getItems",value:function(t){for(var n=new Array(t.size()).fill(null),r=0;!t.isEmpty();){var s=t.poll();n[r]=s.getBoundable(0).getItem(),r++}return n}},{key:"centreY",value:function(t){return e.avg(t.getMinY(),t.getMaxY())}}])}(At),ji=function(i){function e(){var t;return o(this,e),t=c(this,e),e.constructor_.apply(t,arguments),t}return N(e,i),g(e,[{key:"computeBounds",value:function(){for(var t=null,n=this.getChildBoundables().iterator();n.hasNext();){var r=n.next();t===null?t=new Ee(r.getBounds()):t.expandToInclude(r.getBounds())}return t}}],[{key:"constructor_",value:function(){var t=arguments[0];He.constructor_.call(this,t)}}])}(He);st.STRtreeNode=ji,st.xComparator=new(function(){return g(function i(){o(this,i)},[{key:"interfaces_",get:function(){return[X]}},{key:"compare",value:function(i,e){return At.compareDoubles(st.centreX(i.getBounds()),st.centreX(e.getBounds()))}}])}()),st.yComparator=new(function(){return g(function i(){o(this,i)},[{key:"interfaces_",get:function(){return[X]}},{key:"compare",value:function(i,e){return At.compareDoubles(st.centreY(i.getBounds()),st.centreY(e.getBounds()))}}])}()),st.intersectsOp=new(function(){return g(function i(){o(this,i)},[{key:"interfaces_",get:function(){return[IntersectsOp]}},{key:"intersects",value:function(i,e){return i.intersects(e)}}])}()),st.DEFAULT_NODE_CAPACITY=10;var Zs=function(){function i(){o(this,i)}return g(i,null,[{key:"relativeSign",value:function(e,t){return e<t?-1:e>t?1:0}},{key:"compare",value:function(e,t,n){if(t.equals2D(n))return 0;var r=i.relativeSign(t.x,n.x),s=i.relativeSign(t.y,n.y);switch(e){case 0:return i.compareValue(r,s);case 1:return i.compareValue(s,r);case 2:return i.compareValue(s,-r);case 3:return i.compareValue(-r,s);case 4:return i.compareValue(-r,-s);case 5:return i.compareValue(-s,-r);case 6:return i.compareValue(-s,r);case 7:return i.compareValue(r,-s)}return ne.shouldNeverReachHere("invalid octant value"),0}},{key:"compareValue",value:function(e,t){return e<0?-1:e>0?1:t<0?-1:t>0?1:0}}])}(),Ws=function(){return g(function i(){o(this,i),i.constructor_.apply(this,arguments)},[{key:"getCoordinate",value:function(){return this.coord}},{key:"print",value:function(i){i.print(this.coord),i.print(" seg # = "+this.segmentIndex)}},{key:"compareTo",value:function(i){var e=i;return this.segmentIndex<e.segmentIndex?-1:this.segmentIndex>e.segmentIndex?1:this.coord.equals2D(e.coord)?0:this._isInterior?e._isInterior?Zs.compare(this._segmentOctant,this.coord,e.coord):1:-1}},{key:"isEndPoint",value:function(i){return this.segmentIndex===0&&!this._isInterior||this.segmentIndex===i}},{key:"toString",value:function(){return this.segmentIndex+":"+this.coord.toString()}},{key:"isInterior",value:function(){return this._isInterior}},{key:"interfaces_",get:function(){return[ie]}}],[{key:"constructor_",value:function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var i=arguments[0],e=arguments[1],t=arguments[2],n=arguments[3];this._segString=i,this.coord=new F(e),this.segmentIndex=t,this._segmentOctant=n,this._isInterior=!e.equals2D(i.getCoordinate(t))}}])}(),Js=function(){return g(function i(){o(this,i)},[{key:"hasNext",value:function(){}},{key:"next",value:function(){}},{key:"remove",value:function(){}}])}(),Ks=function(){return g(function i(){o(this,i),i.constructor_.apply(this,arguments)},[{key:"getSplitCoordinates",value:function(){var i=new Ht;this.addEndpoints();for(var e=this.iterator(),t=e.next();e.hasNext();){var n=e.next();this.addEdgeCoordinates(t,n,i),t=n}return i.toCoordinateArray()}},{key:"addCollapsedNodes",value:function(){var i=new ue;this.findCollapsesFromInsertedNodes(i),this.findCollapsesFromExistingVertices(i);for(var e=i.iterator();e.hasNext();){var t=e.next().intValue();this.add(this._edge.getCoordinate(t),t)}}},{key:"createSplitEdgePts",value:function(i,e){var t=e.segmentIndex-i.segmentIndex+2;if(t===2)return[new F(i.coord),new F(e.coord)];var n=this._edge.getCoordinate(e.segmentIndex),r=e.isInterior()||!e.coord.equals2D(n);r||t--;var s=new Array(t).fill(null),h=0;s[h++]=new F(i.coord);for(var f=i.segmentIndex+1;f<=e.segmentIndex;f++)s[h++]=this._edge.getCoordinate(f);return r&&(s[h]=new F(e.coord)),s}},{key:"print",value:function(i){i.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(i)}},{key:"findCollapsesFromExistingVertices",value:function(i){for(var e=0;e<this._edge.size()-2;e++){var t=this._edge.getCoordinate(e);this._edge.getCoordinate(e+1);var n=this._edge.getCoordinate(e+2);t.equals2D(n)&&i.add(an.valueOf(e+1))}}},{key:"addEdgeCoordinates",value:function(i,e,t){var n=this.createSplitEdgePts(i,e);t.add(n,!1)}},{key:"iterator",value:function(){return this._nodeMap.values().iterator()}},{key:"addSplitEdges",value:function(i){this.addEndpoints(),this.addCollapsedNodes();for(var e=this.iterator(),t=e.next();e.hasNext();){var n=e.next(),r=this.createSplitEdge(t,n);i.add(r),t=n}}},{key:"findCollapseIndex",value:function(i,e,t){if(!i.coord.equals2D(e.coord))return!1;var n=e.segmentIndex-i.segmentIndex;return e.isInterior()||n--,n===1&&(t[0]=i.segmentIndex+1,!0)}},{key:"findCollapsesFromInsertedNodes",value:function(i){for(var e=new Array(1).fill(null),t=this.iterator(),n=t.next();t.hasNext();){var r=t.next();this.findCollapseIndex(n,r,e)&&i.add(an.valueOf(e[0])),n=r}}},{key:"getEdge",value:function(){return this._edge}},{key:"addEndpoints",value:function(){var i=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(i),i)}},{key:"createSplitEdge",value:function(i,e){var t=this.createSplitEdgePts(i,e);return new St(t,this._edge.getData())}},{key:"add",value:function(i,e){var t=new Ws(this._edge,i,e,this._edge.getSegmentOctant(e)),n=this._nodeMap.get(t);return n!==null?(ne.isTrue(n.coord.equals2D(i),"Found equal nodes with different coordinates"),n):(this._nodeMap.put(t,t),t)}},{key:"checkSplitEdgesCorrectness",value:function(i){var e=this._edge.getCoordinates(),t=i.get(0).getCoordinate(0);if(!t.equals2D(e[0]))throw new te("bad split edge start point at "+t);var n=i.get(i.size()-1).getCoordinates(),r=n[n.length-1];if(!r.equals2D(e[e.length-1]))throw new te("bad split edge end point at "+r)}}],[{key:"constructor_",value:function(){this._nodeMap=new Wt,this._edge=null;var i=arguments[0];this._edge=i}}])}(),Qs=function(){function i(){o(this,i)}return g(i,null,[{key:"octant",value:function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var e=arguments[0],t=arguments[1];if(e===0&&t===0)throw new W("Cannot compute the octant for point ( "+e+", "+t+" )");var n=Math.abs(e),r=Math.abs(t);return e>=0?t>=0?n>=r?0:1:n>=r?7:6:t>=0?n>=r?3:2:n>=r?4:5}if(arguments[0]instanceof F&&arguments[1]instanceof F){var s=arguments[0],h=arguments[1],f=h.x-s.x,m=h.y-s.y;if(f===0&&m===0)throw new W("Cannot compute the octant for two identical points "+s);return i.octant(f,m)}}}])}(),ea=function(){return g(function i(){o(this,i)},[{key:"getCoordinates",value:function(){}},{key:"size",value:function(){}},{key:"getCoordinate",value:function(i){}},{key:"isClosed",value:function(){}},{key:"setData",value:function(i){}},{key:"getData",value:function(){}}])}(),ta=function(){return g(function i(){o(this,i)},[{key:"addIntersection",value:function(i,e){}},{key:"interfaces_",get:function(){return[ea]}}])}(),St=function(){function i(){o(this,i),i.constructor_.apply(this,arguments)}return g(i,[{key:"getCoordinates",value:function(){return this._pts}},{key:"size",value:function(){return this._pts.length}},{key:"getCoordinate",value:function(e){return this._pts[e]}},{key:"isClosed",value:function(){return this._pts[0].equals(this._pts[this._pts.length-1])}},{key:"getSegmentOctant",value:function(e){return e===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(e),this.getCoordinate(e+1))}},{key:"setData",value:function(e){this._data=e}},{key:"safeOctant",value:function(e,t){return e.equals2D(t)?0:Qs.octant(e,t)}},{key:"getData",value:function(){return this._data}},{key:"addIntersection",value:function(){if(arguments.length===2){var e=arguments[0],t=arguments[1];this.addIntersectionNode(e,t)}else if(arguments.length===4){var n=arguments[1],r=arguments[3],s=new F(arguments[0].getIntersection(r));this.addIntersection(s,n)}}},{key:"toString",value:function(){return Jn.toLineString(new jt(this._pts))}},{key:"getNodeList",value:function(){return this._nodeList}},{key:"addIntersectionNode",value:function(e,t){var n=t,r=n+1;if(r<this._pts.length){var s=this._pts[r];e.equals2D(s)&&(n=r)}return this._nodeList.add(e,n)}},{key:"addIntersections",value:function(e,t,n){for(var r=0;r<e.getIntersectionNum();r++)this.addIntersection(e,t,n,r)}},{key:"interfaces_",get:function(){return[ta]}}],[{key:"constructor_",value:function(){this._nodeList=new Ks(this),this._pts=null,this._data=null;var e=arguments[0],t=arguments[1];this._pts=e,this._data=t}},{key:"getNodedSubstrings",value:function(){if(arguments.length===1){var e=arguments[0],t=new ue;return i.getNodedSubstrings(e,t),t}if(arguments.length===2)for(var n=arguments[1],r=arguments[0].iterator();r.hasNext();)r.next().getNodeList().addSplitEdges(n)}}])}(),ze=function(){function i(){o(this,i),i.constructor_.apply(this,arguments)}return g(i,[{key:"minX",value:function(){return Math.min(this.p0.x,this.p1.x)}},{key:"orientationIndex",value:function(){if(arguments[0]instanceof i){var e=arguments[0],t=he.index(this.p0,this.p1,e.p0),n=he.index(this.p0,this.p1,e.p1);return t>=0&&n>=0||t<=0&&n<=0?Math.max(t,n):0}if(arguments[0]instanceof F){var r=arguments[0];return he.index(this.p0,this.p1,r)}}},{key:"toGeometry",value:function(e){return e.createLineString([this.p0,this.p1])}},{key:"isVertical",value:function(){return this.p0.x===this.p1.x}},{key:"equals",value:function(e){if(!(e instanceof i))return!1;var t=e;return this.p0.equals(t.p0)&&this.p1.equals(t.p1)}},{key:"intersection",value:function(e){var t=new wt;return t.computeIntersection(this.p0,this.p1,e.p0,e.p1),t.hasIntersection()?t.getIntersection(0):null}},{key:"project",value:function(){if(arguments[0]instanceof F){var e=arguments[0];if(e.equals(this.p0)||e.equals(this.p1))return new F(e);var t=this.projectionFactor(e),n=new F;return n.x=this.p0.x+t*(this.p1.x-this.p0.x),n.y=this.p0.y+t*(this.p1.y-this.p0.y),n}if(arguments[0]instanceof i){var r=arguments[0],s=this.projectionFactor(r.p0),h=this.projectionFactor(r.p1);if(s>=1&&h>=1||s<=0&&h<=0)return null;var f=this.project(r.p0);s<0&&(f=this.p0),s>1&&(f=this.p1);var m=this.project(r.p1);return h<0&&(m=this.p0),h>1&&(m=this.p1),new i(f,m)}}},{key:"normalize",value:function(){this.p1.compareTo(this.p0)<0&&this.reverse()}},{key:"angle",value:function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)}},{key:"getCoordinate",value:function(e){return e===0?this.p0:this.p1}},{key:"distancePerpendicular",value:function(e){return it.pointToLinePerpendicular(e,this.p0,this.p1)}},{key:"minY",value:function(){return Math.min(this.p0.y,this.p1.y)}},{key:"midPoint",value:function(){return i.midPoint(this.p0,this.p1)}},{key:"projectionFactor",value:function(e){if(e.equals(this.p0))return 0;if(e.equals(this.p1))return 1;var t=this.p1.x-this.p0.x,n=this.p1.y-this.p0.y,r=t*t+n*n;return r<=0?z.NaN:((e.x-this.p0.x)*t+(e.y-this.p0.y)*n)/r}},{key:"closestPoints",value:function(e){var t=this.intersection(e);if(t!==null)return[t,t];var n=new Array(2).fill(null),r=z.MAX_VALUE,s=null,h=this.closestPoint(e.p0);r=h.distance(e.p0),n[0]=h,n[1]=e.p0;var f=this.closestPoint(e.p1);(s=f.distance(e.p1))<r&&(r=s,n[0]=f,n[1]=e.p1);var m=e.closestPoint(this.p0);(s=m.distance(this.p0))<r&&(r=s,n[0]=this.p0,n[1]=m);var _=e.closestPoint(this.p1);return(s=_.distance(this.p1))<r&&(r=s,n[0]=this.p1,n[1]=_),n}},{key:"closestPoint",value:function(e){var t=this.projectionFactor(e);return t>0&&t<1?this.project(e):this.p0.distance(e)<this.p1.distance(e)?this.p0:this.p1}},{key:"maxX",value:function(){return Math.max(this.p0.x,this.p1.x)}},{key:"getLength",value:function(){return this.p0.distance(this.p1)}},{key:"compareTo",value:function(e){var t=e,n=this.p0.compareTo(t.p0);return n!==0?n:this.p1.compareTo(t.p1)}},{key:"reverse",value:function(){var e=this.p0;this.p0=this.p1,this.p1=e}},{key:"equalsTopo",value:function(e){return this.p0.equals(e.p0)&&this.p1.equals(e.p1)||this.p0.equals(e.p1)&&this.p1.equals(e.p0)}},{key:"lineIntersection",value:function(e){return Un.intersection(this.p0,this.p1,e.p0,e.p1)}},{key:"maxY",value:function(){return Math.max(this.p0.y,this.p1.y)}},{key:"pointAlongOffset",value:function(e,t){var n=this.p0.x+e*(this.p1.x-this.p0.x),r=this.p0.y+e*(this.p1.y-this.p0.y),s=this.p1.x-this.p0.x,h=this.p1.y-this.p0.y,f=Math.sqrt(s*s+h*h),m=0,_=0;if(t!==0){if(f<=0)throw new IllegalStateException("Cannot compute offset from zero-length line segment");m=t*s/f,_=t*h/f}return new F(n-_,r+m)}},{key:"setCoordinates",value:function(){if(arguments.length===1){var e=arguments[0];this.setCoordinates(e.p0,e.p1)}else if(arguments.length===2){var t=arguments[0],n=arguments[1];this.p0.x=t.x,this.p0.y=t.y,this.p1.x=n.x,this.p1.y=n.y}}},{key:"segmentFraction",value:function(e){var t=this.projectionFactor(e);return t<0?t=0:(t>1||z.isNaN(t))&&(t=1),t}},{key:"toString",value:function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"}},{key:"isHorizontal",value:function(){return this.p0.y===this.p1.y}},{key:"reflect",value:function(e){var t=this.p1.getY()-this.p0.getY(),n=this.p0.getX()-this.p1.getX(),r=this.p0.getY()*(this.p1.getX()-this.p0.getX())-this.p0.getX()*(this.p1.getY()-this.p0.getY()),s=t*t+n*n,h=t*t-n*n,f=e.getX(),m=e.getY();return new F((-h*f-2*t*n*m-2*t*r)/s,(h*m-2*t*n*f-2*n*r)/s)}},{key:"distance",value:function(){if(arguments[0]instanceof i){var e=arguments[0];return it.segmentToSegment(this.p0,this.p1,e.p0,e.p1)}if(arguments[0]instanceof F){var t=arguments[0];return it.pointToSegment(t,this.p0,this.p1)}}},{key:"pointAlong",value:function(e){var t=new F;return t.x=this.p0.x+e*(this.p1.x-this.p0.x),t.y=this.p0.y+e*(this.p1.y-this.p0.y),t}},{key:"hashCode",value:function(){var e=z.doubleToLongBits(this.p0.x);e^=31*z.doubleToLongBits(this.p0.y);var t=Math.trunc(e)^Math.trunc(e>>32),n=z.doubleToLongBits(this.p1.x);return n^=31*z.doubleToLongBits(this.p1.y),t^(Math.trunc(n)^Math.trunc(n>>32))}},{key:"interfaces_",get:function(){return[ie,v]}}],[{key:"constructor_",value:function(){if(this.p0=null,this.p1=null,arguments.length===0)i.constructor_.call(this,new F,new F);else if(arguments.length===1){var e=arguments[0];i.constructor_.call(this,e.p0,e.p1)}else if(arguments.length===2){var t=arguments[0],n=arguments[1];this.p0=t,this.p1=n}else if(arguments.length===4){var r=arguments[0],s=arguments[1],h=arguments[2],f=arguments[3];i.constructor_.call(this,new F(r,s),new F(h,f))}}},{key:"midPoint",value:function(e,t){return new F((e.x+t.x)/2,(e.y+t.y)/2)}}])}(),na=function(){return g(function i(){o(this,i),i.constructor_.apply(this,arguments)},[{key:"overlap",value:function(){if(arguments.length!==2){if(arguments.length===4){var i=arguments[1],e=arguments[2],t=arguments[3];arguments[0].getLineSegment(i,this._overlapSeg1),e.getLineSegment(t,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}}}}],[{key:"constructor_",value:function(){this._overlapSeg1=new ze,this._overlapSeg2=new ze}}])}(),Zi=function(){return g(function i(){o(this,i),i.constructor_.apply(this,arguments)},[{key:"getLineSegment",value:function(i,e){e.p0=this._pts[i],e.p1=this._pts[i+1]}},{key:"computeSelect",value:function(i,e,t,n){var r=this._pts[e],s=this._pts[t];if(t-e==1)return n.select(this,e),null;if(!i.intersects(r,s))return null;var h=Math.trunc((e+t)/2);e<h&&this.computeSelect(i,e,h,n),h<t&&this.computeSelect(i,h,t,n)}},{key:"getCoordinates",value:function(){for(var i=new Array(this._end-this._start+1).fill(null),e=0,t=this._start;t<=this._end;t++)i[e++]=this._pts[t];return i}},{key:"computeOverlaps",value:function(){if(arguments.length===2){var i=arguments[0],e=arguments[1];this.computeOverlaps(this._start,this._end,i,i._start,i._end,e)}else if(arguments.length===6){var t=arguments[0],n=arguments[1],r=arguments[2],s=arguments[3],h=arguments[4],f=arguments[5];if(n-t==1&&h-s==1)return f.overlap(this,t,r,s),null;if(!this.overlaps(t,n,r,s,h))return null;var m=Math.trunc((t+n)/2),_=Math.trunc((s+h)/2);t<m&&(s<_&&this.computeOverlaps(t,m,r,s,_,f),_<h&&this.computeOverlaps(t,m,r,_,h,f)),m<n&&(s<_&&this.computeOverlaps(m,n,r,s,_,f),_<h&&this.computeOverlaps(m,n,r,_,h,f))}}},{key:"setId",value:function(i){this._id=i}},{key:"select",value:function(i,e){this.computeSelect(i,this._start,this._end,e)}},{key:"getEnvelope",value:function(){if(this._env===null){var i=this._pts[this._start],e=this._pts[this._end];this._env=new Ee(i,e)}return this._env}},{key:"overlaps",value:function(i,e,t,n,r){return Ee.intersects(this._pts[i],this._pts[e],t._pts[n],t._pts[r])}},{key:"getEndIndex",value:function(){return this._end}},{key:"getStartIndex",value:function(){return this._start}},{key:"getContext",value:function(){return this._context}},{key:"getId",value:function(){return this._id}}],[{key:"constructor_",value:function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var i=arguments[0],e=arguments[1],t=arguments[2],n=arguments[3];this._pts=i,this._start=e,this._end=t,this._context=n}}])}(),ia=function(){function i(){o(this,i)}return g(i,null,[{key:"findChainEnd",value:function(e,t){for(var n=t;n<e.length-1&&e[n].equals2D(e[n+1]);)n++;if(n>=e.length-1)return e.length-1;for(var r=Fe.quadrant(e[n],e[n+1]),s=t+1;s<e.length&&!(!e[s-1].equals2D(e[s])&&Fe.quadrant(e[s-1],e[s])!==r);)s++;return s-1}},{key:"getChains",value:function(){if(arguments.length===1){var e=arguments[0];return i.getChains(e,null)}if(arguments.length===2){var t=arguments[0],n=arguments[1],r=new ue,s=0;do{var h=i.findChainEnd(t,s),f=new Zi(t,s,h,n);r.add(f),s=h}while(s<t.length-1);return r}}}])}(),ti=function(){return g(function i(){o(this,i)},[{key:"computeNodes",value:function(i){}},{key:"getNodedSubstrings",value:function(){}}])}(),Wi=function(){return g(function i(){o(this,i),i.constructor_.apply(this,arguments)},[{key:"setSegmentIntersector",value:function(i){this._segInt=i}},{key:"interfaces_",get:function(){return[ti]}}],[{key:"constructor_",value:function(){if(this._segInt=null,arguments.length!==0){if(arguments.length===1){var i=arguments[0];this.setSegmentIntersector(i)}}}}])}(),ni=function(i){function e(){var t;return o(this,e),t=c(this,e),e.constructor_.apply(t,arguments),t}return N(e,i),g(e,[{key:"getMonotoneChains",value:function(){return this._monoChains}},{key:"getNodedSubstrings",value:function(){return St.getNodedSubstrings(this._nodedSegStrings)}},{key:"getIndex",value:function(){return this._index}},{key:"add",value:function(t){for(var n=ia.getChains(t.getCoordinates(),t).iterator();n.hasNext();){var r=n.next();r.setId(this._idCounter++),this._index.insert(r.getEnvelope(),r),this._monoChains.add(r)}}},{key:"computeNodes",value:function(t){this._nodedSegStrings=t;for(var n=t.iterator();n.hasNext();)this.add(n.next());this.intersectChains()}},{key:"intersectChains",value:function(){for(var t=new Ji(this._segInt),n=this._monoChains.iterator();n.hasNext();)for(var r=n.next(),s=this._index.query(r.getEnvelope()).iterator();s.hasNext();){var h=s.next();if(h.getId()>r.getId()&&(r.computeOverlaps(h,t),this._nOverlaps++),this._segInt.isDone())return null}}}],[{key:"constructor_",value:function(){if(this._monoChains=new ue,this._index=new st,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0,arguments.length!==0){if(arguments.length===1){var t=arguments[0];Wi.constructor_.call(this,t)}}}}])}(Wi),Ji=function(i){function e(){var t;return o(this,e),t=c(this,e),e.constructor_.apply(t,arguments),t}return N(e,i),g(e,[{key:"overlap",value:function(){if(arguments.length!==4)return b(e,"overlap",this,1).apply(this,arguments);var t=arguments[1],n=arguments[2],r=arguments[3],s=arguments[0].getContext(),h=n.getContext();this._si.processIntersections(s,t,h,r)}}],[{key:"constructor_",value:function(){this._si=null;var t=arguments[0];this._si=t}}])}(na);ni.SegmentOverlapAction=Ji;var et=function(){function i(){o(this,i),i.constructor_.apply(this,arguments)}return g(i,[{key:"isDeletable",value:function(e,t,n,r){var s=this._inputLine[e],h=this._inputLine[t],f=this._inputLine[n];return!!this.isConcave(s,h,f)&&!!this.isShallow(s,h,f,r)&&this.isShallowSampled(s,h,e,n,r)}},{key:"deleteShallowConcavities",value:function(){for(var e=1,t=this.findNextNonDeletedIndex(e),n=this.findNextNonDeletedIndex(t),r=!1;n<this._inputLine.length;){var s=!1;this.isDeletable(e,t,n,this._distanceTol)&&(this._isDeleted[t]=i.DELETE,s=!0,r=!0),e=s?n:t,t=this.findNextNonDeletedIndex(e),n=this.findNextNonDeletedIndex(t)}return r}},{key:"isShallowConcavity",value:function(e,t,n,r){return he.index(e,t,n)===this._angleOrientation&&it.pointToSegment(t,e,n)<r}},{key:"isShallowSampled",value:function(e,t,n,r,s){var h=Math.trunc((r-n)/i.NUM_PTS_TO_CHECK);h<=0&&(h=1);for(var f=n;f<r;f+=h)if(!this.isShallow(e,t,this._inputLine[f],s))return!1;return!0}},{key:"isConcave",value:function(e,t,n){var r=he.index(e,t,n)===this._angleOrientation;return r}},{key:"simplify",value:function(e){this._distanceTol=Math.abs(e),e<0&&(this._angleOrientation=he.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var t=!1;do t=this.deleteShallowConcavities();while(t);return this.collapseLine()}},{key:"findNextNonDeletedIndex",value:function(e){for(var t=e+1;t<this._inputLine.length&&this._isDeleted[t]===i.DELETE;)t++;return t}},{key:"isShallow",value:function(e,t,n,r){return it.pointToSegment(t,e,n)<r}},{key:"collapseLine",value:function(){for(var e=new Ht,t=0;t<this._inputLine.length;t++)this._isDeleted[t]!==i.DELETE&&e.add(this._inputLine[t]);return e.toCoordinateArray()}}],[{key:"constructor_",value:function(){this._inputLine=null,this._distanceTol=null,this._isDeleted=null,this._angleOrientation=he.COUNTERCLOCKWISE;var e=arguments[0];this._inputLine=e}},{key:"simplify",value:function(e,t){return new i(e).simplify(t)}}])}();et.INIT=0,et.DELETE=1,et.KEEP=1,et.NUM_PTS_TO_CHECK=10;var Ki=function(){function i(){o(this,i),i.constructor_.apply(this,arguments)}return g(i,[{key:"getCoordinates",value:function(){return this._ptList.toArray(i.COORDINATE_ARRAY_TYPE)}},{key:"setPrecisionModel",value:function(e){this._precisionModel=e}},{key:"addPt",value:function(e){var t=new F(e);if(this._precisionModel.makePrecise(t),this.isRedundant(t))return null;this._ptList.add(t)}},{key:"reverse",value:function(){}},{key:"addPts",value:function(e,t){if(t)for(var n=0;n<e.length;n++)this.addPt(e[n]);else for(var r=e.length-1;r>=0;r--)this.addPt(e[r])}},{key:"isRedundant",value:function(e){if(this._ptList.size()<1)return!1;var t=this._ptList.get(this._ptList.size()-1);return e.distance(t)<this._minimimVertexDistance}},{key:"toString",value:function(){return new Ot().createLineString(this.getCoordinates()).toString()}},{key:"closeRing",value:function(){if(this._ptList.size()<1)return null;var e=new F(this._ptList.get(0)),t=this._ptList.get(this._ptList.size()-1);if(e.equals(t))return null;this._ptList.add(e)}},{key:"setMinimumVertexDistance",value:function(e){this._minimimVertexDistance=e}}],[{key:"constructor_",value:function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new ue}}])}();Ki.COORDINATE_ARRAY_TYPE=new Array(0).fill(null);var Ye=function(){function i(){o(this,i)}return g(i,null,[{key:"toDegrees",value:function(e){return 180*e/Math.PI}},{key:"normalize",value:function(e){for(;e>Math.PI;)e-=i.PI_TIMES_2;for(;e<=-Math.PI;)e+=i.PI_TIMES_2;return e}},{key:"angle",value:function(){if(arguments.length===1){var e=arguments[0];return Math.atan2(e.y,e.x)}if(arguments.length===2){var t=arguments[0],n=arguments[1],r=n.x-t.x,s=n.y-t.y;return Math.atan2(s,r)}}},{key:"isAcute",value:function(e,t,n){var r=e.x-t.x,s=e.y-t.y;return r*(n.x-t.x)+s*(n.y-t.y)>0}},{key:"isObtuse",value:function(e,t,n){var r=e.x-t.x,s=e.y-t.y;return r*(n.x-t.x)+s*(n.y-t.y)<0}},{key:"interiorAngle",value:function(e,t,n){var r=i.angle(t,e),s=i.angle(t,n);return Math.abs(s-r)}},{key:"normalizePositive",value:function(e){if(e<0){for(;e<0;)e+=i.PI_TIMES_2;e>=i.PI_TIMES_2&&(e=0)}else{for(;e>=i.PI_TIMES_2;)e-=i.PI_TIMES_2;e<0&&(e=0)}return e}},{key:"angleBetween",value:function(e,t,n){var r=i.angle(t,e),s=i.angle(t,n);return i.diff(r,s)}},{key:"diff",value:function(e,t){var n=null;return(n=e<t?t-e:e-t)>Math.PI&&(n=2*Math.PI-n),n}},{key:"toRadians",value:function(e){return e*Math.PI/180}},{key:"getTurn",value:function(e,t){var n=Math.sin(t-e);return n>0?i.COUNTERCLOCKWISE:n<0?i.CLOCKWISE:i.NONE}},{key:"angleBetweenOriented",value:function(e,t,n){var r=i.angle(t,e),s=i.angle(t,n)-r;return s<=-Math.PI?s+i.PI_TIMES_2:s>Math.PI?s-i.PI_TIMES_2:s}}])}();Ye.PI_TIMES_2=2*Math.PI,Ye.PI_OVER_2=Math.PI/2,Ye.PI_OVER_4=Math.PI/4,Ye.COUNTERCLOCKWISE=he.COUNTERCLOCKWISE,Ye.CLOCKWISE=he.CLOCKWISE,Ye.NONE=he.COLLINEAR;var Jt=function(){function i(){o(this,i),i.constructor_.apply(this,arguments)}return g(i,[{key:"addNextSegment",value:function(e,t){if(this._s0=this._s1,this._s1=this._s2,this._s2=e,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var n=he.index(this._s0,this._s1,this._s2),r=n===he.CLOCKWISE&&this._side===H.LEFT||n===he.COUNTERCLOCKWISE&&this._side===H.RIGHT;n===0?this.addCollinear(t):r?this.addOutsideTurn(n,t):this.addInsideTurn(n,t)}},{key:"addLineEndCap",value:function(e,t){var n=new ze(e,t),r=new ze;this.computeOffsetSegment(n,H.LEFT,this._distance,r);var s=new ze;this.computeOffsetSegment(n,H.RIGHT,this._distance,s);var h=t.x-e.x,f=t.y-e.y,m=Math.atan2(f,h);switch(this._bufParams.getEndCapStyle()){case U.CAP_ROUND:this._segList.addPt(r.p1),this.addDirectedFillet(t,m+Math.PI/2,m-Math.PI/2,he.CLOCKWISE,this._distance),this._segList.addPt(s.p1);break;case U.CAP_FLAT:this._segList.addPt(r.p1),this._segList.addPt(s.p1);break;case U.CAP_SQUARE:var _=new F;_.x=Math.abs(this._distance)*Math.cos(m),_.y=Math.abs(this._distance)*Math.sin(m);var P=new F(r.p1.x+_.x,r.p1.y+_.y),G=new F(s.p1.x+_.x,s.p1.y+_.y);this._segList.addPt(P),this._segList.addPt(G)}}},{key:"getCoordinates",value:function(){return this._segList.getCoordinates()}},{key:"addMitreJoin",value:function(e,t,n,r){var s=Un.intersection(t.p0,t.p1,n.p0,n.p1);if(s!==null&&(r<=0?1:s.distance(e)/Math.abs(r))<=this._bufParams.getMitreLimit())return this._segList.addPt(s),null;this.addLimitedMitreJoin(t,n,r,this._bufParams.getMitreLimit())}},{key:"addOutsideTurn",value:function(e,t){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*i.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===U.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===U.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(t&&this._segList.addPt(this._offset0.p1),this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,e,this._distance),this._segList.addPt(this._offset1.p0))}},{key:"createSquare",value:function(e){this._segList.addPt(new F(e.x+this._distance,e.y+this._distance)),this._segList.addPt(new F(e.x+this._distance,e.y-this._distance)),this._segList.addPt(new F(e.x-this._distance,e.y-this._distance)),this._segList.addPt(new F(e.x-this._distance,e.y+this._distance)),this._segList.closeRing()}},{key:"addSegments",value:function(e,t){this._segList.addPts(e,t)}},{key:"addFirstSegment",value:function(){this._segList.addPt(this._offset1.p0)}},{key:"addCornerFillet",value:function(e,t,n,r,s){var h=t.x-e.x,f=t.y-e.y,m=Math.atan2(f,h),_=n.x-e.x,P=n.y-e.y,G=Math.atan2(P,_);r===he.CLOCKWISE?m<=G&&(m+=2*Math.PI):m>=G&&(m-=2*Math.PI),this._segList.addPt(t),this.addDirectedFillet(e,m,G,r,s),this._segList.addPt(n)}},{key:"addLastSegment",value:function(){this._segList.addPt(this._offset1.p1)}},{key:"initSideSegments",value:function(e,t,n){this._s1=e,this._s2=t,this._side=n,this._seg1.setCoordinates(e,t),this.computeOffsetSegment(this._seg1,n,this._distance,this._offset1)}},{key:"addLimitedMitreJoin",value:function(e,t,n,r){var s=this._seg0.p1,h=Ye.angle(s,this._seg0.p0),f=Ye.angleBetweenOriented(this._seg0.p0,s,this._seg1.p1)/2,m=Ye.normalize(h+f),_=Ye.normalize(m+Math.PI),P=r*n,G=n-P*Math.abs(Math.sin(f)),$=s.x+P*Math.cos(_),Q=s.y+P*Math.sin(_),se=new F($,Q),ae=new ze(s,se),de=ae.pointAlongOffset(1,G),me=ae.pointAlongOffset(1,-G);this._side===H.LEFT?(this._segList.addPt(de),this._segList.addPt(me)):(this._segList.addPt(me),this._segList.addPt(de))}},{key:"addDirectedFillet",value:function(e,t,n,r,s){var h=r===he.CLOCKWISE?-1:1,f=Math.abs(t-n),m=Math.trunc(f/this._filletAngleQuantum+.5);if(m<1)return null;for(var _=f/m,P=new F,G=0;G<m;G++){var $=t+h*G*_;P.x=e.x+s*Math.cos($),P.y=e.y+s*Math.sin($),this._segList.addPt(P)}}},{key:"computeOffsetSegment",value:function(e,t,n,r){var s=t===H.LEFT?1:-1,h=e.p1.x-e.p0.x,f=e.p1.y-e.p0.y,m=Math.sqrt(h*h+f*f),_=s*n*h/m,P=s*n*f/m;r.p0.x=e.p0.x-P,r.p0.y=e.p0.y+_,r.p1.x=e.p1.x-P,r.p1.y=e.p1.y+_}},{key:"addInsideTurn",value:function(e,t){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*i.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var n=new F((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(n);var r=new F((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(r)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}}},{key:"createCircle",value:function(e){var t=new F(e.x+this._distance,e.y);this._segList.addPt(t),this.addDirectedFillet(e,0,2*Math.PI,-1,this._distance),this._segList.closeRing()}},{key:"addBevelJoin",value:function(e,t){this._segList.addPt(e.p1),this._segList.addPt(t.p0)}},{key:"init",value:function(e){this._distance=e,this._maxCurveSegmentError=e*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new Ki,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(e*i.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)}},{key:"addCollinear",value:function(e){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===U.JOIN_BEVEL||this._bufParams.getJoinStyle()===U.JOIN_MITRE?(e&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,he.CLOCKWISE,this._distance))}},{key:"closeRing",value:function(){this._segList.closeRing()}},{key:"hasNarrowConcaveAngle",value:function(){return this._hasNarrowConcaveAngle}}],[{key:"constructor_",value:function(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new ze,this._seg1=new ze,this._offset0=new ze,this._offset1=new ze,this._side=0,this._hasNarrowConcaveAngle=!1;var e=arguments[0],t=arguments[1],n=arguments[2];this._precisionModel=e,this._bufParams=t,this._li=new wt,this._filletAngleQuantum=Math.PI/2/t.getQuadrantSegments(),t.getQuadrantSegments()>=8&&t.getJoinStyle()===U.JOIN_ROUND&&(this._closingSegLengthFactor=i.MAX_CLOSING_SEG_LEN_FACTOR),this.init(n)}}])}();Jt.OFFSET_SEGMENT_SEPARATION_FACTOR=.001,Jt.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR=.001,Jt.CURVE_VERTEX_SNAP_DISTANCE_FACTOR=1e-6,Jt.MAX_CLOSING_SEG_LEN_FACTOR=80;var ra=function(){function i(){o(this,i),i.constructor_.apply(this,arguments)}return g(i,[{key:"getOffsetCurve",value:function(e,t){if(this._distance=t,t===0)return null;var n=t<0,r=Math.abs(t),s=this.getSegGen(r);e.length<=1?this.computePointCurve(e[0],s):this.computeOffsetCurve(e,n,s);var h=s.getCoordinates();return n&&be.reverse(h),h}},{key:"computeSingleSidedBufferCurve",value:function(e,t,n){var r=this.simplifyTolerance(this._distance);if(t){n.addSegments(e,!0);var s=et.simplify(e,-r),h=s.length-1;n.initSideSegments(s[h],s[h-1],H.LEFT),n.addFirstSegment();for(var f=h-2;f>=0;f--)n.addNextSegment(s[f],!0)}else{n.addSegments(e,!1);var m=et.simplify(e,r),_=m.length-1;n.initSideSegments(m[0],m[1],H.LEFT),n.addFirstSegment();for(var P=2;P<=_;P++)n.addNextSegment(m[P],!0)}n.addLastSegment(),n.closeRing()}},{key:"computeRingBufferCurve",value:function(e,t,n){var r=this.simplifyTolerance(this._distance);t===H.RIGHT&&(r=-r);var s=et.simplify(e,r),h=s.length-1;n.initSideSegments(s[h-1],s[0],t);for(var f=1;f<=h;f++){var m=f!==1;n.addNextSegment(s[f],m)}n.closeRing()}},{key:"computeLineBufferCurve",value:function(e,t){var n=this.simplifyTolerance(this._distance),r=et.simplify(e,n),s=r.length-1;t.initSideSegments(r[0],r[1],H.LEFT);for(var h=2;h<=s;h++)t.addNextSegment(r[h],!0);t.addLastSegment(),t.addLineEndCap(r[s-1],r[s]);var f=et.simplify(e,-n),m=f.length-1;t.initSideSegments(f[m],f[m-1],H.LEFT);for(var _=m-2;_>=0;_--)t.addNextSegment(f[_],!0);t.addLastSegment(),t.addLineEndCap(f[1],f[0]),t.closeRing()}},{key:"computePointCurve",value:function(e,t){switch(this._bufParams.getEndCapStyle()){case U.CAP_ROUND:t.createCircle(e);break;case U.CAP_SQUARE:t.createSquare(e)}}},{key:"getLineCurve",value:function(e,t){if(this._distance=t,this.isLineOffsetEmpty(t))return null;var n=Math.abs(t),r=this.getSegGen(n);if(e.length<=1)this.computePointCurve(e[0],r);else if(this._bufParams.isSingleSided()){var s=t<0;this.computeSingleSidedBufferCurve(e,s,r)}else this.computeLineBufferCurve(e,r);return r.getCoordinates()}},{key:"getBufferParameters",value:function(){return this._bufParams}},{key:"simplifyTolerance",value:function(e){return e*this._bufParams.getSimplifyFactor()}},{key:"getRingCurve",value:function(e,t,n){if(this._distance=n,e.length<=2)return this.getLineCurve(e,n);if(n===0)return i.copyCoordinates(e);var r=this.getSegGen(n);return this.computeRingBufferCurve(e,t,r),r.getCoordinates()}},{key:"computeOffsetCurve",value:function(e,t,n){var r=this.simplifyTolerance(this._distance);if(t){var s=et.simplify(e,-r),h=s.length-1;n.initSideSegments(s[h],s[h-1],H.LEFT),n.addFirstSegment();for(var f=h-2;f>=0;f--)n.addNextSegment(s[f],!0)}else{var m=et.simplify(e,r),_=m.length-1;n.initSideSegments(m[0],m[1],H.LEFT),n.addFirstSegment();for(var P=2;P<=_;P++)n.addNextSegment(m[P],!0)}n.addLastSegment()}},{key:"isLineOffsetEmpty",value:function(e){return e===0||e<0&&!this._bufParams.isSingleSided()}},{key:"getSegGen",value:function(e){return new Jt(this._precisionModel,this._bufParams,e)}}],[{key:"constructor_",value:function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var e=arguments[0],t=arguments[1];this._precisionModel=e,this._bufParams=t}},{key:"copyCoordinates",value:function(e){for(var t=new Array(e.length).fill(null),n=0;n<t.length;n++)t[n]=new F(e[n]);return t}}])}(),Qi=function(){return g(function i(){o(this,i),i.constructor_.apply(this,arguments)},[{key:"findStabbedSegments",value:function(){if(arguments.length===1){for(var i=arguments[0],e=new ue,t=this._subgraphs.iterator();t.hasNext();){var n=t.next(),r=n.getEnvelope();i.y<r.getMinY()||i.y>r.getMaxY()||this.findStabbedSegments(i,n.getDirectedEdges(),e)}return e}if(arguments.length===3){if(ge(arguments[2],xt)&&arguments[0]instanceof F&&arguments[1]instanceof ei){for(var s=arguments[0],h=arguments[1],f=arguments[2],m=h.getEdge().getCoordinates(),_=0;_<m.length-1;_++)if(this._seg.p0=m[_],this._seg.p1=m[_+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse(),!(Math.max(this._seg.p0.x,this._seg.p1.x)<s.x||this._seg.isHorizontal()||s.y<this._seg.p0.y||s.y>this._seg.p1.y||he.index(this._seg.p0,this._seg.p1,s)===he.RIGHT)){var P=h.getDepth(H.LEFT);this._seg.p0.equals(m[_])||(P=h.getDepth(H.RIGHT));var G=new er(this._seg,P);f.add(G)}}else if(ge(arguments[2],xt)&&arguments[0]instanceof F&&ge(arguments[1],xt))for(var $=arguments[0],Q=arguments[2],se=arguments[1].iterator();se.hasNext();){var ae=se.next();ae.isForward()&&this.findStabbedSegments($,ae,Q)}}}},{key:"getDepth",value:function(i){var e=this.findStabbedSegments(i);return e.size()===0?0:Mt.min(e)._leftDepth}}],[{key:"constructor_",value:function(){this._subgraphs=null,this._seg=new ze;var i=arguments[0];this._subgraphs=i}}])}(),er=function(){return g(function i(){o(this,i),i.constructor_.apply(this,arguments)},[{key:"compareTo",value:function(i){var e=i;if(this._upwardSeg.minX()>=e._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=e._upwardSeg.minX())return-1;var t=this._upwardSeg.orientationIndex(e._upwardSeg);return t!==0||(t=-1*e._upwardSeg.orientationIndex(this._upwardSeg))!==0?t:this._upwardSeg.compareTo(e._upwardSeg)}},{key:"compareX",value:function(i,e){var t=i.p0.compareTo(e.p0);return t!==0?t:i.p1.compareTo(e.p1)}},{key:"toString",value:function(){return this._upwardSeg.toString()}},{key:"interfaces_",get:function(){return[ie]}}],[{key:"constructor_",value:function(){this._upwardSeg=null,this._leftDepth=null;var i=arguments[0],e=arguments[1];this._upwardSeg=new ze(i),this._leftDepth=e}}])}();Qi.DepthSegment=er;var tr=function(i){function e(){var t;return o(this,e),t=c(this,e),e.constructor_.apply(t,arguments),t}return N(e,i),g(e,null,[{key:"constructor_",value:function(){j.constructor_.call(this,"Projective point not representable on the Cartesian plane.")}}])}(j),ii=function(){function i(){o(this,i),i.constructor_.apply(this,arguments)}return g(i,[{key:"getY",value:function(){var e=this.y/this.w;if(z.isNaN(e)||z.isInfinite(e))throw new tr;return e}},{key:"getX",value:function(){var e=this.x/this.w;if(z.isNaN(e)||z.isInfinite(e))throw new tr;return e}},{key:"getCoordinate",value:function(){var e=new F;return e.x=this.getX(),e.y=this.getY(),e}}],[{key:"constructor_",value:function(){if(this.x=null,this.y=null,this.w=null,arguments.length===0)this.x=0,this.y=0,this.w=1;else if(arguments.length===1){var e=arguments[0];this.x=e.x,this.y=e.y,this.w=1}else if(arguments.length===2){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var t=arguments[0],n=arguments[1];this.x=t,this.y=n,this.w=1}else if(arguments[0]instanceof i&&arguments[1]instanceof i){var r=arguments[0],s=arguments[1];this.x=r.y*s.w-s.y*r.w,this.y=s.x*r.w-r.x*s.w,this.w=r.x*s.y-s.x*r.y}else if(arguments[0]instanceof F&&arguments[1]instanceof F){var h=arguments[0],f=arguments[1];this.x=h.y-f.y,this.y=f.x-h.x,this.w=h.x*f.y-f.x*h.y}}else if(arguments.length===3){var m=arguments[0],_=arguments[1],P=arguments[2];this.x=m,this.y=_,this.w=P}else if(arguments.length===4){var G=arguments[0],$=arguments[1],Q=arguments[2],se=arguments[3],ae=G.y-$.y,de=$.x-G.x,me=G.x*$.y-$.x*G.y,ke=Q.y-se.y,Pe=se.x-Q.x,Ae=Q.x*se.y-se.x*Q.y;this.x=de*Ae-Pe*me,this.y=ke*me-ae*Ae,this.w=ae*Pe-ke*de}}}])}(),sa=function(){function i(){o(this,i),i.constructor_.apply(this,arguments)}return g(i,[{key:"area",value:function(){return i.area(this.p0,this.p1,this.p2)}},{key:"signedArea",value:function(){return i.signedArea(this.p0,this.p1,this.p2)}},{key:"interpolateZ",value:function(e){if(e===null)throw new W("Supplied point is null.");return i.interpolateZ(e,this.p0,this.p1,this.p2)}},{key:"longestSideLength",value:function(){return i.longestSideLength(this.p0,this.p1,this.p2)}},{key:"isAcute",value:function(){return i.isAcute(this.p0,this.p1,this.p2)}},{key:"circumcentre",value:function(){return i.circumcentre(this.p0,this.p1,this.p2)}},{key:"area3D",value:function(){return i.area3D(this.p0,this.p1,this.p2)}},{key:"centroid",value:function(){return i.centroid(this.p0,this.p1,this.p2)}},{key:"inCentre",value:function(){return i.inCentre(this.p0,this.p1,this.p2)}}],[{key:"constructor_",value:function(){this.p0=null,this.p1=null,this.p2=null;var e=arguments[0],t=arguments[1],n=arguments[2];this.p0=e,this.p1=t,this.p2=n}},{key:"area",value:function(e,t,n){return Math.abs(((n.x-e.x)*(t.y-e.y)-(t.x-e.x)*(n.y-e.y))/2)}},{key:"signedArea",value:function(e,t,n){return((n.x-e.x)*(t.y-e.y)-(t.x-e.x)*(n.y-e.y))/2}},{key:"det",value:function(e,t,n,r){return e*r-t*n}},{key:"interpolateZ",value:function(e,t,n,r){var s=t.x,h=t.y,f=n.x-s,m=r.x-s,_=n.y-h,P=r.y-h,G=f*P-m*_,$=e.x-s,Q=e.y-h,se=(P*$-m*Q)/G,ae=(-_*$+f*Q)/G;return t.getZ()+se*(n.getZ()-t.getZ())+ae*(r.getZ()-t.getZ())}},{key:"longestSideLength",value:function(e,t,n){var r=e.distance(t),s=t.distance(n),h=n.distance(e),f=r;return s>f&&(f=s),h>f&&(f=h),f}},{key:"circumcentreDD",value:function(e,t,n){var r=le.valueOf(e.x).subtract(n.x),s=le.valueOf(e.y).subtract(n.y),h=le.valueOf(t.x).subtract(n.x),f=le.valueOf(t.y).subtract(n.y),m=le.determinant(r,s,h,f).multiply(2),_=r.sqr().add(s.sqr()),P=h.sqr().add(f.sqr()),G=le.determinant(s,_,f,P),$=le.determinant(r,_,h,P),Q=le.valueOf(n.x).subtract(G.divide(m)).doubleValue(),se=le.valueOf(n.y).add($.divide(m)).doubleValue();return new F(Q,se)}},{key:"isAcute",value:function(e,t,n){return!!Ye.isAcute(e,t,n)&&!!Ye.isAcute(t,n,e)&&!!Ye.isAcute(n,e,t)}},{key:"circumcentre",value:function(e,t,n){var r=n.x,s=n.y,h=e.x-r,f=e.y-s,m=t.x-r,_=t.y-s,P=2*i.det(h,f,m,_),G=i.det(f,h*h+f*f,_,m*m+_*_),$=i.det(h,h*h+f*f,m,m*m+_*_);return new F(r-G/P,s+$/P)}},{key:"perpendicularBisector",value:function(e,t){var n=t.x-e.x,r=t.y-e.y,s=new ii(e.x+n/2,e.y+r/2,1),h=new ii(e.x-r+n/2,e.y+n+r/2,1);return new ii(s,h)}},{key:"angleBisector",value:function(e,t,n){var r=t.distance(e),s=r/(r+t.distance(n)),h=n.x-e.x,f=n.y-e.y;return new F(e.x+s*h,e.y+s*f)}},{key:"area3D",value:function(e,t,n){var r=t.x-e.x,s=t.y-e.y,h=t.getZ()-e.getZ(),f=n.x-e.x,m=n.y-e.y,_=n.getZ()-e.getZ(),P=s*_-h*m,G=h*f-r*_,$=r*m-s*f,Q=P*P+G*G+$*$,se=Math.sqrt(Q)/2;return se}},{key:"centroid",value:function(e,t,n){var r=(e.x+t.x+n.x)/3,s=(e.y+t.y+n.y)/3;return new F(r,s)}},{key:"inCentre",value:function(e,t,n){var r=t.distance(n),s=e.distance(n),h=e.distance(t),f=r+s+h,m=(r*e.x+s*t.x+h*n.x)/f,_=(r*e.y+s*t.y+h*n.y)/f;return new F(m,_)}}])}(),aa=function(){return g(function i(){o(this,i),i.constructor_.apply(this,arguments)},[{key:"addRingSide",value:function(i,e,t,n,r){if(e===0&&i.length<$t.MINIMUM_VALID_SIZE)return null;var s=n,h=r;i.length>=$t.MINIMUM_VALID_SIZE&&he.isCCW(i)&&(s=r,h=n,t=H.opposite(t));var f=this._curveBuilder.getRingCurve(i,t,e);this.addCurve(f,s,h)}},{key:"addRingBothSides",value:function(i,e){this.addRingSide(i,e,H.LEFT,I.EXTERIOR,I.INTERIOR),this.addRingSide(i,e,H.RIGHT,I.INTERIOR,I.EXTERIOR)}},{key:"addPoint",value:function(i){if(this._distance<=0)return null;var e=i.getCoordinates(),t=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(t,I.EXTERIOR,I.INTERIOR)}},{key:"addPolygon",value:function(i){var e=this._distance,t=H.LEFT;this._distance<0&&(e=-this._distance,t=H.RIGHT);var n=i.getExteriorRing(),r=be.removeRepeatedPoints(n.getCoordinates());if(this._distance<0&&this.isErodedCompletely(n,this._distance)||this._distance<=0&&r.length<3)return null;this.addRingSide(r,e,t,I.EXTERIOR,I.INTERIOR);for(var s=0;s<i.getNumInteriorRing();s++){var h=i.getInteriorRingN(s),f=be.removeRepeatedPoints(h.getCoordinates());this._distance>0&&this.isErodedCompletely(h,-this._distance)||this.addRingSide(f,e,H.opposite(t),I.INTERIOR,I.EXTERIOR)}}},{key:"isTriangleErodedCompletely",value:function(i,e){var t=new sa(i[0],i[1],i[2]),n=t.inCentre();return it.pointToSegment(n,t.p0,t.p1)<Math.abs(e)}},{key:"addLineString",value:function(i){if(this._curveBuilder.isLineOffsetEmpty(this._distance))return null;var e=be.removeRepeatedPoints(i.getCoordinates());if(be.isRing(e)&&!this._curveBuilder.getBufferParameters().isSingleSided())this.addRingBothSides(e,this._distance);else{var t=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(t,I.EXTERIOR,I.INTERIOR)}}},{key:"addCurve",value:function(i,e,t){if(i===null||i.length<2)return null;var n=new St(i,new $e(0,I.BOUNDARY,e,t));this._curveList.add(n)}},{key:"getCurves",value:function(){return this.add(this._inputGeom),this._curveList}},{key:"add",value:function(i){if(i.isEmpty())return null;if(i instanceof hn)this.addPolygon(i);else if(i instanceof Vt)this.addLineString(i);else if(i instanceof Xn)this.addPoint(i);else if(i instanceof Vn)this.addCollection(i);else if(i instanceof Zn)this.addCollection(i);else if(i instanceof jn)this.addCollection(i);else{if(!(i instanceof Be))throw new pe(i.getGeometryType());this.addCollection(i)}}},{key:"isErodedCompletely",value:function(i,e){var t=i.getCoordinates();if(t.length<4)return e<0;if(t.length===4)return this.isTriangleErodedCompletely(t,e);var n=i.getEnvelopeInternal(),r=Math.min(n.getHeight(),n.getWidth());return e<0&&2*Math.abs(e)>r}},{key:"addCollection",value:function(i){for(var e=0;e<i.getNumGeometries();e++){var t=i.getGeometryN(e);this.add(t)}}}],[{key:"constructor_",value:function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new ue;var i=arguments[0],e=arguments[1],t=arguments[2];this._inputGeom=i,this._distance=e,this._curveBuilder=t}}])}(),oa=function(){return g(function i(){o(this,i)},[{key:"locate",value:function(i){}}])}(),ua=function(){function i(){o(this,i),i.constructor_.apply(this,arguments)}return g(i,[{key:"next",value:function(){if(this._atStart)return this._atStart=!1,i.isAtomic(this._parent)&&this._index++,this._parent;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new Ce;var e=this._parent.getGeometryN(this._index++);return e instanceof Be?(this._subcollectionIterator=new i(e),this._subcollectionIterator.next()):e}},{key:"remove",value:function(){throw new pe(this.getClass().getName())}},{key:"hasNext",value:function(){if(this._atStart)return!0;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)}},{key:"interfaces_",get:function(){return[Js]}}],[{key:"constructor_",value:function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var e=arguments[0];this._parent=e,this._atStart=!0,this._index=0,this._max=e.getNumGeometries()}},{key:"isAtomic",value:function(e){return!(e instanceof Be)}}])}(),la=function(){function i(){o(this,i),i.constructor_.apply(this,arguments)}return g(i,[{key:"locate",value:function(e){return i.locate(e,this._geom)}},{key:"interfaces_",get:function(){return[oa]}}],[{key:"constructor_",value:function(){this._geom=null;var e=arguments[0];this._geom=e}},{key:"locatePointInPolygon",value:function(e,t){if(t.isEmpty())return I.EXTERIOR;var n=t.getExteriorRing(),r=i.locatePointInRing(e,n);if(r!==I.INTERIOR)return r;for(var s=0;s<t.getNumInteriorRing();s++){var h=t.getInteriorRingN(s),f=i.locatePointInRing(e,h);if(f===I.BOUNDARY)return I.BOUNDARY;if(f===I.INTERIOR)return I.EXTERIOR}return I.INTERIOR}},{key:"locatePointInRing",value:function(e,t){return t.getEnvelopeInternal().intersects(e)?Kn.locateInRing(e,t.getCoordinates()):I.EXTERIOR}},{key:"containsPointInPolygon",value:function(e,t){return I.EXTERIOR!==i.locatePointInPolygon(e,t)}},{key:"locateInGeometry",value:function(e,t){if(t instanceof hn)return i.locatePointInPolygon(e,t);if(t instanceof Be)for(var n=new ua(t);n.hasNext();){var r=n.next();if(r!==t){var s=i.locateInGeometry(e,r);if(s!==I.EXTERIOR)return s}}return I.EXTERIOR}},{key:"isContained",value:function(e,t){return I.EXTERIOR!==i.locate(e,t)}},{key:"locate",value:function(e,t){return t.isEmpty()?I.EXTERIOR:t.getEnvelopeInternal().intersects(e)?i.locateInGeometry(e,t):I.EXTERIOR}}])}(),ha=function(){return g(function i(){o(this,i),i.constructor_.apply(this,arguments)},[{key:"getNextCW",value:function(i){this.getEdges();var e=this._edgeList.indexOf(i),t=e-1;return e===0&&(t=this._edgeList.size()-1),this._edgeList.get(t)}},{key:"propagateSideLabels",value:function(i){for(var e=I.NONE,t=this.iterator();t.hasNext();){var n=t.next().getLabel();n.isArea(i)&&n.getLocation(i,H.LEFT)!==I.NONE&&(e=n.getLocation(i,H.LEFT))}if(e===I.NONE)return null;for(var r=e,s=this.iterator();s.hasNext();){var h=s.next(),f=h.getLabel();if(f.getLocation(i,H.ON)===I.NONE&&f.setLocation(i,H.ON,r),f.isArea(i)){var m=f.getLocation(i,H.LEFT),_=f.getLocation(i,H.RIGHT);if(_!==I.NONE){if(_!==r)throw new ct("side location conflict",h.getCoordinate());m===I.NONE&&ne.shouldNeverReachHere("found single null side (at "+h.getCoordinate()+")"),r=m}else ne.isTrue(f.getLocation(i,H.LEFT)===I.NONE,"found single null side"),f.setLocation(i,H.RIGHT,r),f.setLocation(i,H.LEFT,r)}}}},{key:"getCoordinate",value:function(){var i=this.iterator();return i.hasNext()?i.next().getCoordinate():null}},{key:"print",value:function(i){Xe.out.println("EdgeEndStar:   "+this.getCoordinate());for(var e=this.iterator();e.hasNext();)e.next().print(i)}},{key:"isAreaLabelsConsistent",value:function(i){return this.computeEdgeEndLabels(i.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)}},{key:"checkAreaLabelsConsistent",value:function(i){var e=this.getEdges();if(e.size()<=0)return!0;var t=e.size()-1,n=e.get(t).getLabel().getLocation(i,H.LEFT);ne.isTrue(n!==I.NONE,"Found unlabelled area edge");for(var r=n,s=this.iterator();s.hasNext();){var h=s.next().getLabel();ne.isTrue(h.isArea(i),"Found non-area edge");var f=h.getLocation(i,H.LEFT),m=h.getLocation(i,H.RIGHT);if(f===m||m!==r)return!1;r=f}return!0}},{key:"findIndex",value:function(i){this.iterator();for(var e=0;e<this._edgeList.size();e++)if(this._edgeList.get(e)===i)return e;return-1}},{key:"iterator",value:function(){return this.getEdges().iterator()}},{key:"getEdges",value:function(){return this._edgeList===null&&(this._edgeList=new ue(this._edgeMap.values())),this._edgeList}},{key:"getLocation",value:function(i,e,t){return this._ptInAreaLocation[i]===I.NONE&&(this._ptInAreaLocation[i]=la.locate(e,t[i].getGeometry())),this._ptInAreaLocation[i]}},{key:"toString",value:function(){var i=new Ut;i.append("EdgeEndStar:   "+this.getCoordinate()),i.append(`
`);for(var e=this.iterator();e.hasNext();){var t=e.next();i.append(t),i.append(`
`)}return i.toString()}},{key:"computeEdgeEndLabels",value:function(i){for(var e=this.iterator();e.hasNext();)e.next().computeLabel(i)}},{key:"computeLabelling",value:function(i){this.computeEdgeEndLabels(i[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var e=[!1,!1],t=this.iterator();t.hasNext();)for(var n=t.next().getLabel(),r=0;r<2;r++)n.isLine(r)&&n.getLocation(r)===I.BOUNDARY&&(e[r]=!0);for(var s=this.iterator();s.hasNext();)for(var h=s.next(),f=h.getLabel(),m=0;m<2;m++)if(f.isAnyNull(m)){var _=I.NONE;if(e[m])_=I.EXTERIOR;else{var P=h.getCoordinate();_=this.getLocation(m,P,i)}f.setAllLocationsIfNull(m,_)}}},{key:"getDegree",value:function(){return this._edgeMap.size()}},{key:"insertEdgeEnd",value:function(i,e){this._edgeMap.put(i,e),this._edgeList=null}}],[{key:"constructor_",value:function(){this._edgeMap=new Wt,this._edgeList=null,this._ptInAreaLocation=[I.NONE,I.NONE]}}])}(),ca=function(i){function e(){var t;return o(this,e),t=c(this,e),e.constructor_.apply(t,arguments),t}return N(e,i),g(e,[{key:"linkResultDirectedEdges",value:function(){this.getResultAreaEdges();for(var t=null,n=null,r=this._SCANNING_FOR_INCOMING,s=0;s<this._resultAreaEdgeList.size();s++){var h=this._resultAreaEdgeList.get(s),f=h.getSym();if(h.getLabel().isArea())switch(t===null&&h.isInResult()&&(t=h),r){case this._SCANNING_FOR_INCOMING:if(!f.isInResult())continue;n=f,r=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!h.isInResult())continue;n.setNext(h),r=this._SCANNING_FOR_INCOMING}}if(r===this._LINKING_TO_OUTGOING){if(t===null)throw new ct("no outgoing dirEdge found",this.getCoordinate());ne.isTrue(t.isInResult(),"unable to link last incoming dirEdge"),n.setNext(t)}}},{key:"insert",value:function(t){var n=t;this.insertEdgeEnd(n,n)}},{key:"getRightmostEdge",value:function(){var t=this.getEdges(),n=t.size();if(n<1)return null;var r=t.get(0);if(n===1)return r;var s=t.get(n-1),h=r.getQuadrant(),f=s.getQuadrant();return Fe.isNorthern(h)&&Fe.isNorthern(f)?r:Fe.isNorthern(h)||Fe.isNorthern(f)?r.getDy()!==0?r:s.getDy()!==0?s:(ne.shouldNeverReachHere("found two horizontal edges incident on node"),null):s}},{key:"print",value:function(t){Xe.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var n=this.iterator();n.hasNext();){var r=n.next();t.print("out "),r.print(t),t.println(),t.print("in "),r.getSym().print(t),t.println()}}},{key:"getResultAreaEdges",value:function(){if(this._resultAreaEdgeList!==null)return this._resultAreaEdgeList;this._resultAreaEdgeList=new ue;for(var t=this.iterator();t.hasNext();){var n=t.next();(n.isInResult()||n.getSym().isInResult())&&this._resultAreaEdgeList.add(n)}return this._resultAreaEdgeList}},{key:"updateLabelling",value:function(t){for(var n=this.iterator();n.hasNext();){var r=n.next().getLabel();r.setAllLocationsIfNull(0,t.getLocation(0)),r.setAllLocationsIfNull(1,t.getLocation(1))}}},{key:"linkAllDirectedEdges",value:function(){this.getEdges();for(var t=null,n=null,r=this._edgeList.size()-1;r>=0;r--){var s=this._edgeList.get(r),h=s.getSym();n===null&&(n=h),t!==null&&h.setNext(t),t=s}n.setNext(t)}},{key:"computeDepths",value:function(){if(arguments.length===1){var t=arguments[0],n=this.findIndex(t),r=t.getDepth(H.LEFT),s=t.getDepth(H.RIGHT),h=this.computeDepths(n+1,this._edgeList.size(),r);if(this.computeDepths(0,n,h)!==s)throw new ct("depth mismatch at "+t.getCoordinate())}else if(arguments.length===3){for(var f=arguments[1],m=arguments[2],_=arguments[0];_<f;_++){var P=this._edgeList.get(_);P.setEdgeDepths(H.RIGHT,m),m=P.getDepth(H.LEFT)}return m}}},{key:"mergeSymLabels",value:function(){for(var t=this.iterator();t.hasNext();){var n=t.next();n.getLabel().merge(n.getSym().getLabel())}}},{key:"linkMinimalDirectedEdges",value:function(t){for(var n=null,r=null,s=this._SCANNING_FOR_INCOMING,h=this._resultAreaEdgeList.size()-1;h>=0;h--){var f=this._resultAreaEdgeList.get(h),m=f.getSym();switch(n===null&&f.getEdgeRing()===t&&(n=f),s){case this._SCANNING_FOR_INCOMING:if(m.getEdgeRing()!==t)continue;r=m,s=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(f.getEdgeRing()!==t)continue;r.setNextMin(f),s=this._SCANNING_FOR_INCOMING}}s===this._LINKING_TO_OUTGOING&&(ne.isTrue(n!==null,"found null for first outgoing dirEdge"),ne.isTrue(n.getEdgeRing()===t,"unable to link last incoming dirEdge"),r.setNextMin(n))}},{key:"getOutgoingDegree",value:function(){if(arguments.length===0){for(var t=0,n=this.iterator();n.hasNext();)n.next().isInResult()&&t++;return t}if(arguments.length===1){for(var r=arguments[0],s=0,h=this.iterator();h.hasNext();)h.next().getEdgeRing()===r&&s++;return s}}},{key:"getLabel",value:function(){return this._label}},{key:"findCoveredLineEdges",value:function(){for(var t=I.NONE,n=this.iterator();n.hasNext();){var r=n.next(),s=r.getSym();if(!r.isLineEdge()){if(r.isInResult()){t=I.INTERIOR;break}if(s.isInResult()){t=I.EXTERIOR;break}}}if(t===I.NONE)return null;for(var h=t,f=this.iterator();f.hasNext();){var m=f.next(),_=m.getSym();m.isLineEdge()?m.getEdge().setCovered(h===I.INTERIOR):(m.isInResult()&&(h=I.EXTERIOR),_.isInResult()&&(h=I.INTERIOR))}}},{key:"computeLabelling",value:function(t){b(e,"computeLabelling",this,1).call(this,t),this._label=new $e(I.NONE);for(var n=this.iterator();n.hasNext();)for(var r=n.next().getEdge().getLabel(),s=0;s<2;s++){var h=r.getLocation(s);h!==I.INTERIOR&&h!==I.BOUNDARY||this._label.setLocation(s,I.INTERIOR)}}}],[{key:"constructor_",value:function(){this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}}])}(ha),fa=function(i){function e(){return o(this,e),c(this,e)}return N(e,i),g(e,[{key:"createNode",value:function(t){return new yn(t,new ca)}}])}(Xi),nr=function(){function i(){o(this,i),i.constructor_.apply(this,arguments)}return g(i,[{key:"compareTo",value:function(e){var t=e;return i.compareOriented(this._pts,this._orientation,t._pts,t._orientation)}},{key:"interfaces_",get:function(){return[ie]}}],[{key:"constructor_",value:function(){this._pts=null,this._orientation=null;var e=arguments[0];this._pts=e,this._orientation=i.orientation(e)}},{key:"orientation",value:function(e){return be.increasingDirection(e)===1}},{key:"compareOriented",value:function(e,t,n,r){for(var s=t?1:-1,h=r?1:-1,f=t?e.length:-1,m=r?n.length:-1,_=t?0:e.length-1,P=r?0:n.length-1;;){var G=e[_].compareTo(n[P]);if(G!==0)return G;var $=(_+=s)===f,Q=(P+=h)===m;if($&&!Q)return-1;if(!$&&Q)return 1;if($&&Q)return 0}}}])}(),ga=function(){return g(function i(){o(this,i),i.constructor_.apply(this,arguments)},[{key:"print",value:function(i){i.print("MULTILINESTRING ( ");for(var e=0;e<this._edges.size();e++){var t=this._edges.get(e);e>0&&i.print(","),i.print("(");for(var n=t.getCoordinates(),r=0;r<n.length;r++)r>0&&i.print(","),i.print(n[r].x+" "+n[r].y);i.println(")")}i.print(")  ")}},{key:"addAll",value:function(i){for(var e=i.iterator();e.hasNext();)this.add(e.next())}},{key:"findEdgeIndex",value:function(i){for(var e=0;e<this._edges.size();e++)if(this._edges.get(e).equals(i))return e;return-1}},{key:"iterator",value:function(){return this._edges.iterator()}},{key:"getEdges",value:function(){return this._edges}},{key:"get",value:function(i){return this._edges.get(i)}},{key:"findEqualEdge",value:function(i){var e=new nr(i.getCoordinates());return this._ocaMap.get(e)}},{key:"add",value:function(i){this._edges.add(i);var e=new nr(i.getCoordinates());this._ocaMap.put(e,i)}}],[{key:"constructor_",value:function(){this._edges=new ue,this._ocaMap=new Wt}}])}(),ir=function(){return g(function i(){o(this,i)},[{key:"processIntersections",value:function(i,e,t,n){}},{key:"isDone",value:function(){}}])}(),ma=function(){function i(){o(this,i),i.constructor_.apply(this,arguments)}return g(i,[{key:"isTrivialIntersection",value:function(e,t,n,r){if(e===n&&this._li.getIntersectionNum()===1){if(i.isAdjacentSegments(t,r))return!0;if(e.isClosed()){var s=e.size()-1;if(t===0&&r===s||r===0&&t===s)return!0}}return!1}},{key:"getProperIntersectionPoint",value:function(){return this._properIntersectionPoint}},{key:"hasProperInteriorIntersection",value:function(){return this._hasProperInterior}},{key:"getLineIntersector",value:function(){return this._li}},{key:"hasProperIntersection",value:function(){return this._hasProper}},{key:"processIntersections",value:function(e,t,n,r){if(e===n&&t===r)return null;this.numTests++;var s=e.getCoordinates()[t],h=e.getCoordinates()[t+1],f=n.getCoordinates()[r],m=n.getCoordinates()[r+1];this._li.computeIntersection(s,h,f,m),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(e,t,n,r)||(this._hasIntersection=!0,e.addIntersections(this._li,t,0),n.addIntersections(this._li,r,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))}},{key:"hasIntersection",value:function(){return this._hasIntersection}},{key:"isDone",value:function(){return!1}},{key:"hasInteriorIntersection",value:function(){return this._hasInterior}},{key:"interfaces_",get:function(){return[ir]}}],[{key:"constructor_",value:function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var e=arguments[0];this._li=e}},{key:"isAdjacentSegments",value:function(e,t){return Math.abs(e-t)===1}}])}(),ya=function(){return g(function i(){o(this,i),i.constructor_.apply(this,arguments)},[{key:"getSegmentIndex",value:function(){return this.segmentIndex}},{key:"getCoordinate",value:function(){return this.coord}},{key:"print",value:function(i){i.print(this.coord),i.print(" seg # = "+this.segmentIndex),i.println(" dist = "+this.dist)}},{key:"compareTo",value:function(i){var e=i;return this.compare(e.segmentIndex,e.dist)}},{key:"isEndPoint",value:function(i){return this.segmentIndex===0&&this.dist===0||this.segmentIndex===i}},{key:"toString",value:function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist}},{key:"getDistance",value:function(){return this.dist}},{key:"compare",value:function(i,e){return this.segmentIndex<i?-1:this.segmentIndex>i?1:this.dist<e?-1:this.dist>e?1:0}},{key:"interfaces_",get:function(){return[ie]}}],[{key:"constructor_",value:function(){this.coord=null,this.segmentIndex=null,this.dist=null;var i=arguments[0],e=arguments[1],t=arguments[2];this.coord=new F(i),this.segmentIndex=e,this.dist=t}}])}(),da=function(){return g(function i(){o(this,i),i.constructor_.apply(this,arguments)},[{key:"print",value:function(i){i.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(i)}},{key:"iterator",value:function(){return this._nodeMap.values().iterator()}},{key:"addSplitEdges",value:function(i){this.addEndpoints();for(var e=this.iterator(),t=e.next();e.hasNext();){var n=e.next(),r=this.createSplitEdge(t,n);i.add(r),t=n}}},{key:"addEndpoints",value:function(){var i=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[i],i,0)}},{key:"createSplitEdge",value:function(i,e){var t=e.segmentIndex-i.segmentIndex+2,n=this.edge.pts[e.segmentIndex],r=e.dist>0||!e.coord.equals2D(n);r||t--;var s=new Array(t).fill(null),h=0;s[h++]=new F(i.coord);for(var f=i.segmentIndex+1;f<=e.segmentIndex;f++)s[h++]=this.edge.pts[f];return r&&(s[h]=e.coord),new sr(s,new $e(this.edge._label))}},{key:"add",value:function(i,e,t){var n=new ya(i,e,t),r=this._nodeMap.get(n);return r!==null?r:(this._nodeMap.put(n,n),n)}},{key:"isIntersection",value:function(i){for(var e=this.iterator();e.hasNext();)if(e.next().coord.equals(i))return!0;return!1}}],[{key:"constructor_",value:function(){this._nodeMap=new Wt,this.edge=null;var i=arguments[0];this.edge=i}}])}(),va=function(){function i(){o(this,i),i.constructor_.apply(this,arguments)}return g(i,[{key:"isIntersects",value:function(){return!this.isDisjoint()}},{key:"isCovers",value:function(){return(i.isTrue(this._matrix[I.INTERIOR][I.INTERIOR])||i.isTrue(this._matrix[I.INTERIOR][I.BOUNDARY])||i.isTrue(this._matrix[I.BOUNDARY][I.INTERIOR])||i.isTrue(this._matrix[I.BOUNDARY][I.BOUNDARY]))&&this._matrix[I.EXTERIOR][I.INTERIOR]===J.FALSE&&this._matrix[I.EXTERIOR][I.BOUNDARY]===J.FALSE}},{key:"isCoveredBy",value:function(){return(i.isTrue(this._matrix[I.INTERIOR][I.INTERIOR])||i.isTrue(this._matrix[I.INTERIOR][I.BOUNDARY])||i.isTrue(this._matrix[I.BOUNDARY][I.INTERIOR])||i.isTrue(this._matrix[I.BOUNDARY][I.BOUNDARY]))&&this._matrix[I.INTERIOR][I.EXTERIOR]===J.FALSE&&this._matrix[I.BOUNDARY][I.EXTERIOR]===J.FALSE}},{key:"set",value:function(){if(arguments.length===1)for(var e=arguments[0],t=0;t<e.length;t++){var n=Math.trunc(t/3),r=t%3;this._matrix[n][r]=J.toDimensionValue(e.charAt(t))}else if(arguments.length===3){var s=arguments[0],h=arguments[1],f=arguments[2];this._matrix[s][h]=f}}},{key:"isContains",value:function(){return i.isTrue(this._matrix[I.INTERIOR][I.INTERIOR])&&this._matrix[I.EXTERIOR][I.INTERIOR]===J.FALSE&&this._matrix[I.EXTERIOR][I.BOUNDARY]===J.FALSE}},{key:"setAtLeast",value:function(){if(arguments.length===1)for(var e=arguments[0],t=0;t<e.length;t++){var n=Math.trunc(t/3),r=t%3;this.setAtLeast(n,r,J.toDimensionValue(e.charAt(t)))}else if(arguments.length===3){var s=arguments[0],h=arguments[1],f=arguments[2];this._matrix[s][h]<f&&(this._matrix[s][h]=f)}}},{key:"setAtLeastIfValid",value:function(e,t,n){e>=0&&t>=0&&this.setAtLeast(e,t,n)}},{key:"isWithin",value:function(){return i.isTrue(this._matrix[I.INTERIOR][I.INTERIOR])&&this._matrix[I.INTERIOR][I.EXTERIOR]===J.FALSE&&this._matrix[I.BOUNDARY][I.EXTERIOR]===J.FALSE}},{key:"isTouches",value:function(e,t){return e>t?this.isTouches(t,e):(e===J.A&&t===J.A||e===J.L&&t===J.L||e===J.L&&t===J.A||e===J.P&&t===J.A||e===J.P&&t===J.L)&&this._matrix[I.INTERIOR][I.INTERIOR]===J.FALSE&&(i.isTrue(this._matrix[I.INTERIOR][I.BOUNDARY])||i.isTrue(this._matrix[I.BOUNDARY][I.INTERIOR])||i.isTrue(this._matrix[I.BOUNDARY][I.BOUNDARY]))}},{key:"isOverlaps",value:function(e,t){return e===J.P&&t===J.P||e===J.A&&t===J.A?i.isTrue(this._matrix[I.INTERIOR][I.INTERIOR])&&i.isTrue(this._matrix[I.INTERIOR][I.EXTERIOR])&&i.isTrue(this._matrix[I.EXTERIOR][I.INTERIOR]):e===J.L&&t===J.L&&this._matrix[I.INTERIOR][I.INTERIOR]===1&&i.isTrue(this._matrix[I.INTERIOR][I.EXTERIOR])&&i.isTrue(this._matrix[I.EXTERIOR][I.INTERIOR])}},{key:"isEquals",value:function(e,t){return e===t&&i.isTrue(this._matrix[I.INTERIOR][I.INTERIOR])&&this._matrix[I.INTERIOR][I.EXTERIOR]===J.FALSE&&this._matrix[I.BOUNDARY][I.EXTERIOR]===J.FALSE&&this._matrix[I.EXTERIOR][I.INTERIOR]===J.FALSE&&this._matrix[I.EXTERIOR][I.BOUNDARY]===J.FALSE}},{key:"toString",value:function(){for(var e=new fn("123456789"),t=0;t<3;t++)for(var n=0;n<3;n++)e.setCharAt(3*t+n,J.toDimensionSymbol(this._matrix[t][n]));return e.toString()}},{key:"setAll",value:function(e){for(var t=0;t<3;t++)for(var n=0;n<3;n++)this._matrix[t][n]=e}},{key:"get",value:function(e,t){return this._matrix[e][t]}},{key:"transpose",value:function(){var e=this._matrix[1][0];return this._matrix[1][0]=this._matrix[0][1],this._matrix[0][1]=e,e=this._matrix[2][0],this._matrix[2][0]=this._matrix[0][2],this._matrix[0][2]=e,e=this._matrix[2][1],this._matrix[2][1]=this._matrix[1][2],this._matrix[1][2]=e,this}},{key:"matches",value:function(e){if(e.length!==9)throw new W("Should be length 9: "+e);for(var t=0;t<3;t++)for(var n=0;n<3;n++)if(!i.matches(this._matrix[t][n],e.charAt(3*t+n)))return!1;return!0}},{key:"add",value:function(e){for(var t=0;t<3;t++)for(var n=0;n<3;n++)this.setAtLeast(t,n,e.get(t,n))}},{key:"isDisjoint",value:function(){return this._matrix[I.INTERIOR][I.INTERIOR]===J.FALSE&&this._matrix[I.INTERIOR][I.BOUNDARY]===J.FALSE&&this._matrix[I.BOUNDARY][I.INTERIOR]===J.FALSE&&this._matrix[I.BOUNDARY][I.BOUNDARY]===J.FALSE}},{key:"isCrosses",value:function(e,t){return e===J.P&&t===J.L||e===J.P&&t===J.A||e===J.L&&t===J.A?i.isTrue(this._matrix[I.INTERIOR][I.INTERIOR])&&i.isTrue(this._matrix[I.INTERIOR][I.EXTERIOR]):e===J.L&&t===J.P||e===J.A&&t===J.P||e===J.A&&t===J.L?i.isTrue(this._matrix[I.INTERIOR][I.INTERIOR])&&i.isTrue(this._matrix[I.EXTERIOR][I.INTERIOR]):e===J.L&&t===J.L&&this._matrix[I.INTERIOR][I.INTERIOR]===0}},{key:"interfaces_",get:function(){return[y]}}],[{key:"constructor_",value:function(){if(this._matrix=null,arguments.length===0)this._matrix=Array(3).fill().map(function(){return Array(3)}),this.setAll(J.FALSE);else if(arguments.length===1){if(typeof arguments[0]=="string"){var e=arguments[0];i.constructor_.call(this),this.set(e)}else if(arguments[0]instanceof i){var t=arguments[0];i.constructor_.call(this),this._matrix[I.INTERIOR][I.INTERIOR]=t._matrix[I.INTERIOR][I.INTERIOR],this._matrix[I.INTERIOR][I.BOUNDARY]=t._matrix[I.INTERIOR][I.BOUNDARY],this._matrix[I.INTERIOR][I.EXTERIOR]=t._matrix[I.INTERIOR][I.EXTERIOR],this._matrix[I.BOUNDARY][I.INTERIOR]=t._matrix[I.BOUNDARY][I.INTERIOR],this._matrix[I.BOUNDARY][I.BOUNDARY]=t._matrix[I.BOUNDARY][I.BOUNDARY],this._matrix[I.BOUNDARY][I.EXTERIOR]=t._matrix[I.BOUNDARY][I.EXTERIOR],this._matrix[I.EXTERIOR][I.INTERIOR]=t._matrix[I.EXTERIOR][I.INTERIOR],this._matrix[I.EXTERIOR][I.BOUNDARY]=t._matrix[I.EXTERIOR][I.BOUNDARY],this._matrix[I.EXTERIOR][I.EXTERIOR]=t._matrix[I.EXTERIOR][I.EXTERIOR]}}}},{key:"matches",value:function(){if(Number.isInteger(arguments[0])&&typeof arguments[1]=="string"){var e=arguments[0],t=arguments[1];return t===J.SYM_DONTCARE||t===J.SYM_TRUE&&(e>=0||e===J.TRUE)||t===J.SYM_FALSE&&e===J.FALSE||t===J.SYM_P&&e===J.P||t===J.SYM_L&&e===J.L||t===J.SYM_A&&e===J.A}if(typeof arguments[0]=="string"&&typeof arguments[1]=="string"){var n=arguments[1];return new i(arguments[0]).matches(n)}}},{key:"isTrue",value:function(e){return e>=0||e===J.TRUE}}])}(),pa=function(){function i(){o(this,i),i.constructor_.apply(this,arguments)}return g(i,[{key:"size",value:function(){return this._size}},{key:"addAll",value:function(e){return e===null||e.length===0?null:(this.ensureCapacity(this._size+e.length),Xe.arraycopy(e,0,this._data,this._size,e.length),void(this._size+=e.length))}},{key:"ensureCapacity",value:function(e){if(e<=this._data.length)return null;var t=Math.max(e,2*this._data.length);this._data=kt.copyOf(this._data,t)}},{key:"toArray",value:function(){var e=new Array(this._size).fill(null);return Xe.arraycopy(this._data,0,e,0,this._size),e}},{key:"add",value:function(e){this.ensureCapacity(this._size+1),this._data[this._size]=e,++this._size}}],[{key:"constructor_",value:function(){if(this._data=null,this._size=0,arguments.length===0)i.constructor_.call(this,10);else if(arguments.length===1){var e=arguments[0];this._data=new Array(e).fill(null)}}}])}(),_a=function(){function i(){o(this,i)}return g(i,[{key:"getChainStartIndices",value:function(e){var t=0,n=new pa(Math.trunc(e.length/2));n.add(t);do{var r=this.findChainEnd(e,t);n.add(r),t=r}while(t<e.length-1);return n.toArray()}},{key:"findChainEnd",value:function(e,t){for(var n=Fe.quadrant(e[t],e[t+1]),r=t+1;r<e.length&&Fe.quadrant(e[r-1],e[r])===n;)r++;return r-1}},{key:"OLDgetChainStartIndices",value:function(e){var t=0,n=new ue;n.add(t);do{var r=this.findChainEnd(e,t);n.add(r),t=r}while(t<e.length-1);return i.toIntArray(n)}}],[{key:"toIntArray",value:function(e){for(var t=new Array(e.size()).fill(null),n=0;n<t.length;n++)t[n]=e.get(n).intValue();return t}}])}(),xa=function(){return g(function i(){o(this,i),i.constructor_.apply(this,arguments)},[{key:"getCoordinates",value:function(){return this.pts}},{key:"getMaxX",value:function(i){var e=this.pts[this.startIndex[i]].x,t=this.pts[this.startIndex[i+1]].x;return e>t?e:t}},{key:"getMinX",value:function(i){var e=this.pts[this.startIndex[i]].x,t=this.pts[this.startIndex[i+1]].x;return e<t?e:t}},{key:"computeIntersectsForChain",value:function(){if(arguments.length===4){var i=arguments[0],e=arguments[1],t=arguments[2],n=arguments[3];this.computeIntersectsForChain(this.startIndex[i],this.startIndex[i+1],e,e.startIndex[t],e.startIndex[t+1],n)}else if(arguments.length===6){var r=arguments[0],s=arguments[1],h=arguments[2],f=arguments[3],m=arguments[4],_=arguments[5];if(s-r==1&&m-f==1)return _.addIntersections(this.e,r,h.e,f),null;if(!this.overlaps(r,s,h,f,m))return null;var P=Math.trunc((r+s)/2),G=Math.trunc((f+m)/2);r<P&&(f<G&&this.computeIntersectsForChain(r,P,h,f,G,_),G<m&&this.computeIntersectsForChain(r,P,h,G,m,_)),P<s&&(f<G&&this.computeIntersectsForChain(P,s,h,f,G,_),G<m&&this.computeIntersectsForChain(P,s,h,G,m,_))}}},{key:"overlaps",value:function(i,e,t,n,r){return Ee.intersects(this.pts[i],this.pts[e],t.pts[n],t.pts[r])}},{key:"getStartIndexes",value:function(){return this.startIndex}},{key:"computeIntersects",value:function(i,e){for(var t=0;t<this.startIndex.length-1;t++)for(var n=0;n<i.startIndex.length-1;n++)this.computeIntersectsForChain(t,i,n,e)}}],[{key:"constructor_",value:function(){this.e=null,this.pts=null,this.startIndex=null;var i=arguments[0];this.e=i,this.pts=i.getCoordinates();var e=new _a;this.startIndex=e.getChainStartIndices(this.pts)}}])}(),rr=function(){function i(){o(this,i),i.constructor_.apply(this,arguments)}return g(i,[{key:"getDepth",value:function(e,t){return this._depth[e][t]}},{key:"setDepth",value:function(e,t,n){this._depth[e][t]=n}},{key:"isNull",value:function(){if(arguments.length===0){for(var e=0;e<2;e++)for(var t=0;t<3;t++)if(this._depth[e][t]!==i.NULL_VALUE)return!1;return!0}if(arguments.length===1){var n=arguments[0];return this._depth[n][1]===i.NULL_VALUE}if(arguments.length===2){var r=arguments[0],s=arguments[1];return this._depth[r][s]===i.NULL_VALUE}}},{key:"normalize",value:function(){for(var e=0;e<2;e++)if(!this.isNull(e)){var t=this._depth[e][1];this._depth[e][2]<t&&(t=this._depth[e][2]),t<0&&(t=0);for(var n=1;n<3;n++){var r=0;this._depth[e][n]>t&&(r=1),this._depth[e][n]=r}}}},{key:"getDelta",value:function(e){return this._depth[e][H.RIGHT]-this._depth[e][H.LEFT]}},{key:"getLocation",value:function(e,t){return this._depth[e][t]<=0?I.EXTERIOR:I.INTERIOR}},{key:"toString",value:function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]}},{key:"add",value:function(){if(arguments.length===1)for(var e=arguments[0],t=0;t<2;t++)for(var n=1;n<3;n++){var r=e.getLocation(t,n);r!==I.EXTERIOR&&r!==I.INTERIOR||(this.isNull(t,n)?this._depth[t][n]=i.depthAtLocation(r):this._depth[t][n]+=i.depthAtLocation(r))}else if(arguments.length===3){var s=arguments[0],h=arguments[1];arguments[2]===I.INTERIOR&&this._depth[s][h]++}}}],[{key:"constructor_",value:function(){this._depth=Array(2).fill().map(function(){return Array(3)});for(var e=0;e<2;e++)for(var t=0;t<3;t++)this._depth[e][t]=i.NULL_VALUE}},{key:"depthAtLocation",value:function(e){return e===I.EXTERIOR?0:e===I.INTERIOR?1:i.NULL_VALUE}}])}();rr.NULL_VALUE=-1;var sr=function(i){function e(){var t;return o(this,e),t=c(this,e),e.constructor_.apply(t,arguments),t}return N(e,i),g(e,[{key:"getDepth",value:function(){return this._depth}},{key:"getCollapsedEdge",value:function(){var t=new Array(2).fill(null);return t[0]=this.pts[0],t[1]=this.pts[1],new e(t,$e.toLineLabel(this._label))}},{key:"isIsolated",value:function(){return this._isIsolated}},{key:"getCoordinates",value:function(){return this.pts}},{key:"setIsolated",value:function(t){this._isIsolated=t}},{key:"setName",value:function(t){this._name=t}},{key:"equals",value:function(t){if(!(t instanceof e))return!1;var n=t;if(this.pts.length!==n.pts.length)return!1;for(var r=!0,s=!0,h=this.pts.length,f=0;f<this.pts.length;f++)if(this.pts[f].equals2D(n.pts[f])||(r=!1),this.pts[f].equals2D(n.pts[--h])||(s=!1),!r&&!s)return!1;return!0}},{key:"getCoordinate",value:function(){if(arguments.length===0)return this.pts.length>0?this.pts[0]:null;if(arguments.length===1){var t=arguments[0];return this.pts[t]}}},{key:"print",value:function(t){t.print("edge "+this._name+": "),t.print("LINESTRING (");for(var n=0;n<this.pts.length;n++)n>0&&t.print(","),t.print(this.pts[n].x+" "+this.pts[n].y);t.print(")  "+this._label+" "+this._depthDelta)}},{key:"computeIM",value:function(t){e.updateIM(this._label,t)}},{key:"isCollapsed",value:function(){return!!this._label.isArea()&&this.pts.length===3&&!!this.pts[0].equals(this.pts[2])}},{key:"isClosed",value:function(){return this.pts[0].equals(this.pts[this.pts.length-1])}},{key:"getMaximumSegmentIndex",value:function(){return this.pts.length-1}},{key:"getDepthDelta",value:function(){return this._depthDelta}},{key:"getNumPoints",value:function(){return this.pts.length}},{key:"printReverse",value:function(t){t.print("edge "+this._name+": ");for(var n=this.pts.length-1;n>=0;n--)t.print(this.pts[n]+" ");t.println("")}},{key:"getMonotoneChainEdge",value:function(){return this._mce===null&&(this._mce=new xa(this)),this._mce}},{key:"getEnvelope",value:function(){if(this._env===null){this._env=new Ee;for(var t=0;t<this.pts.length;t++)this._env.expandToInclude(this.pts[t])}return this._env}},{key:"addIntersection",value:function(t,n,r,s){var h=new F(t.getIntersection(s)),f=n,m=t.getEdgeDistance(r,s),_=f+1;if(_<this.pts.length){var P=this.pts[_];h.equals2D(P)&&(f=_,m=0)}this.eiList.add(h,f,m)}},{key:"toString",value:function(){var t=new fn;t.append("edge "+this._name+": "),t.append("LINESTRING (");for(var n=0;n<this.pts.length;n++)n>0&&t.append(","),t.append(this.pts[n].x+" "+this.pts[n].y);return t.append(")  "+this._label+" "+this._depthDelta),t.toString()}},{key:"isPointwiseEqual",value:function(t){if(this.pts.length!==t.pts.length)return!1;for(var n=0;n<this.pts.length;n++)if(!this.pts[n].equals2D(t.pts[n]))return!1;return!0}},{key:"setDepthDelta",value:function(t){this._depthDelta=t}},{key:"getEdgeIntersectionList",value:function(){return this.eiList}},{key:"addIntersections",value:function(t,n,r){for(var s=0;s<t.getIntersectionNum();s++)this.addIntersection(t,n,r,s)}}],[{key:"constructor_",value:function(){if(this.pts=null,this._env=null,this.eiList=new da(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new rr,this._depthDelta=0,arguments.length===1){var t=arguments[0];e.constructor_.call(this,t,null)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this.pts=n,this._label=r}}},{key:"updateIM",value:function(){if(!(arguments.length===2&&arguments[1]instanceof va&&arguments[0]instanceof $e))return b(e,"updateIM",this).apply(this,arguments);var t=arguments[0],n=arguments[1];n.setAtLeastIfValid(t.getLocation(0,H.ON),t.getLocation(1,H.ON),1),t.isArea()&&(n.setAtLeastIfValid(t.getLocation(0,H.LEFT),t.getLocation(1,H.LEFT),2),n.setAtLeastIfValid(t.getLocation(0,H.RIGHT),t.getLocation(1,H.RIGHT),2))}}])}(qi),ar=function(){function i(){o(this,i),i.constructor_.apply(this,arguments)}return g(i,[{key:"setWorkingPrecisionModel",value:function(e){this._workingPrecisionModel=e}},{key:"insertUniqueEdge",value:function(e){var t=this._edgeList.findEqualEdge(e);if(t!==null){var n=t.getLabel(),r=e.getLabel();t.isPointwiseEqual(e)||(r=new $e(e.getLabel())).flip(),n.merge(r);var s=i.depthDelta(r),h=t.getDepthDelta()+s;t.setDepthDelta(h)}else this._edgeList.add(e),e.setDepthDelta(i.depthDelta(e.getLabel()))}},{key:"buildSubgraphs",value:function(e,t){for(var n=new ue,r=e.iterator();r.hasNext();){var s=r.next(),h=s.getRightmostCoordinate(),f=new Qi(n).getDepth(h);s.computeDepth(f),s.findResultEdges(),n.add(s),t.add(s.getDirectedEdges(),s.getNodes())}}},{key:"createSubgraphs",value:function(e){for(var t=new ue,n=e.getNodes().iterator();n.hasNext();){var r=n.next();if(!r.isVisited()){var s=new ws;s.create(r),t.add(s)}}return Mt.sort(t,Mt.reverseOrder()),t}},{key:"createEmptyResultGeometry",value:function(){return this._geomFact.createPolygon()}},{key:"getNoder",value:function(e){if(this._workingNoder!==null)return this._workingNoder;var t=new ni,n=new wt;return n.setPrecisionModel(e),t.setSegmentIntersector(new ma(n)),t}},{key:"buffer",value:function(e,t){var n=this._workingPrecisionModel;n===null&&(n=e.getPrecisionModel()),this._geomFact=e.getFactory();var r=new ra(n,this._bufParams),s=new aa(e,t,r).getCurves();if(s.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(s,n),this._graph=new Vi(new fa),this._graph.addEdges(this._edgeList.getEdges());var h=this.createSubgraphs(this._graph),f=new Vs(this._geomFact);this.buildSubgraphs(h,f);var m=f.getPolygons();return m.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(m)}},{key:"computeNodedEdges",value:function(e,t){var n=this.getNoder(t);n.computeNodes(e);for(var r=n.getNodedSubstrings().iterator();r.hasNext();){var s=r.next(),h=s.getCoordinates();if(h.length!==2||!h[0].equals2D(h[1])){var f=s.getData(),m=new sr(s.getCoordinates(),new $e(f));this.insertUniqueEdge(m)}}}},{key:"setNoder",value:function(e){this._workingNoder=e}}],[{key:"constructor_",value:function(){this._bufParams=null,this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new ga;var e=arguments[0];this._bufParams=e}},{key:"depthDelta",value:function(e){var t=e.getLocation(0,H.LEFT),n=e.getLocation(0,H.RIGHT);return t===I.INTERIOR&&n===I.EXTERIOR?1:t===I.EXTERIOR&&n===I.INTERIOR?-1:0}},{key:"convertSegStrings",value:function(e){for(var t=new Ot,n=new ue;e.hasNext();){var r=e.next(),s=t.createLineString(r.getCoordinates());n.add(s)}return t.buildGeometry(n)}}])}(),Ea=function(){function i(){o(this,i),i.constructor_.apply(this,arguments)}return g(i,[{key:"rescale",value:function(){if(ge(arguments[0],we))for(var e=arguments[0].iterator();e.hasNext();){var t=e.next();this.rescale(t.getCoordinates())}else if(arguments[0]instanceof Array){for(var n=arguments[0],r=0;r<n.length;r++)n[r].x=n[r].x/this._scaleFactor+this._offsetX,n[r].y=n[r].y/this._scaleFactor+this._offsetY;n.length===2&&n[0].equals2D(n[1])&&Xe.out.println(n)}}},{key:"scale",value:function(){if(ge(arguments[0],we)){for(var e=arguments[0],t=new ue(e.size()),n=e.iterator();n.hasNext();){var r=n.next();t.add(new St(this.scale(r.getCoordinates()),r.getData()))}return t}if(arguments[0]instanceof Array){for(var s=arguments[0],h=new Array(s.length).fill(null),f=0;f<s.length;f++)h[f]=new F(Math.round((s[f].x-this._offsetX)*this._scaleFactor),Math.round((s[f].y-this._offsetY)*this._scaleFactor),s[f].getZ());return be.removeRepeatedPoints(h)}}},{key:"isIntegerPrecision",value:function(){return this._scaleFactor===1}},{key:"getNodedSubstrings",value:function(){var e=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(e),e}},{key:"computeNodes",value:function(e){var t=e;this._isScaled&&(t=this.scale(e)),this._noder.computeNodes(t)}},{key:"interfaces_",get:function(){return[ti]}}],[{key:"constructor_",value:function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,arguments.length===2){var e=arguments[0],t=arguments[1];i.constructor_.call(this,e,t,0,0)}else if(arguments.length===4){var n=arguments[0],r=arguments[1];this._noder=n,this._scaleFactor=r,this._isScaled=!this.isIntegerPrecision()}}}])}(),or=function(){function i(){o(this,i),i.constructor_.apply(this,arguments)}return g(i,[{key:"checkEndPtVertexIntersections",value:function(){if(arguments.length===0)for(var e=this._segStrings.iterator();e.hasNext();){var t=e.next().getCoordinates();this.checkEndPtVertexIntersections(t[0],this._segStrings),this.checkEndPtVertexIntersections(t[t.length-1],this._segStrings)}else if(arguments.length===2){for(var n=arguments[0],r=arguments[1].iterator();r.hasNext();)for(var s=r.next().getCoordinates(),h=1;h<s.length-1;h++)if(s[h].equals(n))throw new te("found endpt/interior pt intersection at index "+h+" :pt "+n)}}},{key:"checkInteriorIntersections",value:function(){if(arguments.length===0)for(var e=this._segStrings.iterator();e.hasNext();)for(var t=e.next(),n=this._segStrings.iterator();n.hasNext();){var r=n.next();this.checkInteriorIntersections(t,r)}else if(arguments.length===2)for(var s=arguments[0],h=arguments[1],f=s.getCoordinates(),m=h.getCoordinates(),_=0;_<f.length-1;_++)for(var P=0;P<m.length-1;P++)this.checkInteriorIntersections(s,_,h,P);else if(arguments.length===4){var G=arguments[0],$=arguments[1],Q=arguments[2],se=arguments[3];if(G===Q&&$===se)return null;var ae=G.getCoordinates()[$],de=G.getCoordinates()[$+1],me=Q.getCoordinates()[se],ke=Q.getCoordinates()[se+1];if(this._li.computeIntersection(ae,de,me,ke),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,ae,de)||this.hasInteriorIntersection(this._li,me,ke)))throw new te("found non-noded intersection at "+ae+"-"+de+" and "+me+"-"+ke)}}},{key:"checkValid",value:function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()}},{key:"checkCollapses",value:function(){if(arguments.length===0)for(var e=this._segStrings.iterator();e.hasNext();){var t=e.next();this.checkCollapses(t)}else if(arguments.length===1)for(var n=arguments[0].getCoordinates(),r=0;r<n.length-2;r++)this.checkCollapse(n[r],n[r+1],n[r+2])}},{key:"hasInteriorIntersection",value:function(e,t,n){for(var r=0;r<e.getIntersectionNum();r++){var s=e.getIntersection(r);if(!s.equals(t)&&!s.equals(n))return!0}return!1}},{key:"checkCollapse",value:function(e,t,n){if(e.equals(n))throw new te("found non-noded collapse at "+i.fact.createLineString([e,t,n]))}}],[{key:"constructor_",value:function(){this._li=new wt,this._segStrings=null;var e=arguments[0];this._segStrings=e}}])}();or.fact=new Ot;var ri=function(){function i(){o(this,i),i.constructor_.apply(this,arguments)}return g(i,[{key:"intersectsScaled",value:function(e,t){var n=Math.min(e.x,t.x),r=Math.max(e.x,t.x),s=Math.min(e.y,t.y),h=Math.max(e.y,t.y),f=this._maxx<n||this._minx>r||this._maxy<s||this._miny>h;if(f)return!1;var m=this.intersectsToleranceSquare(e,t);return ne.isTrue(!(f&&m),"Found bad envelope test"),m}},{key:"initCorners",value:function(e){var t=.5;this._minx=e.x-t,this._maxx=e.x+t,this._miny=e.y-t,this._maxy=e.y+t,this._corner[0]=new F(this._maxx,this._maxy),this._corner[1]=new F(this._minx,this._maxy),this._corner[2]=new F(this._minx,this._miny),this._corner[3]=new F(this._maxx,this._miny)}},{key:"intersects",value:function(e,t){return this._scaleFactor===1?this.intersectsScaled(e,t):(this.copyScaled(e,this._p0Scaled),this.copyScaled(t,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))}},{key:"scale",value:function(e){return Math.round(e*this._scaleFactor)}},{key:"getCoordinate",value:function(){return this._originalPt}},{key:"copyScaled",value:function(e,t){t.x=this.scale(e.x),t.y=this.scale(e.y)}},{key:"getSafeEnvelope",value:function(){if(this._safeEnv===null){var e=i.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new Ee(this._originalPt.x-e,this._originalPt.x+e,this._originalPt.y-e,this._originalPt.y+e)}return this._safeEnv}},{key:"intersectsPixelClosure",value:function(e,t){return this._li.computeIntersection(e,t,this._corner[0],this._corner[1]),!!this._li.hasIntersection()||(this._li.computeIntersection(e,t,this._corner[1],this._corner[2]),!!this._li.hasIntersection()||(this._li.computeIntersection(e,t,this._corner[2],this._corner[3]),!!this._li.hasIntersection()||(this._li.computeIntersection(e,t,this._corner[3],this._corner[0]),!!this._li.hasIntersection())))}},{key:"intersectsToleranceSquare",value:function(e,t){var n=!1,r=!1;return this._li.computeIntersection(e,t,this._corner[0],this._corner[1]),!!this._li.isProper()||(this._li.computeIntersection(e,t,this._corner[1],this._corner[2]),!!this._li.isProper()||(this._li.hasIntersection()&&(n=!0),this._li.computeIntersection(e,t,this._corner[2],this._corner[3]),!!this._li.isProper()||(this._li.hasIntersection()&&(r=!0),this._li.computeIntersection(e,t,this._corner[3],this._corner[0]),!!this._li.isProper()||!(!n||!r)||!!e.equals(this._pt)||!!t.equals(this._pt))))}},{key:"addSnappedNode",value:function(e,t){var n=e.getCoordinate(t),r=e.getCoordinate(t+1);return!!this.intersects(n,r)&&(e.addIntersection(this.getCoordinate(),t),!0)}}],[{key:"constructor_",value:function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var e=arguments[0],t=arguments[1],n=arguments[2];if(this._originalPt=e,this._pt=e,this._scaleFactor=t,this._li=n,t<=0)throw new W("Scale factor must be non-zero");t!==1&&(this._pt=new F(this.scale(e.x),this.scale(e.y)),this._p0Scaled=new F,this._p1Scaled=new F),this.initCorners(this._pt)}}])}();ri.SAFE_ENV_EXPANSION_FACTOR=.75;var ka=function(){return g(function i(){o(this,i),i.constructor_.apply(this,arguments)},[{key:"select",value:function(){if(arguments.length!==1){if(arguments.length===2){var i=arguments[1];arguments[0].getLineSegment(i,this.selectedSegment),this.select(this.selectedSegment)}}}}],[{key:"constructor_",value:function(){this.selectedSegment=new ze}}])}(),ur=function(){return g(function i(){o(this,i),i.constructor_.apply(this,arguments)},[{key:"snap",value:function(){if(arguments.length===1){var i=arguments[0];return this.snap(i,null,-1)}if(arguments.length===3){var e=arguments[0],t=arguments[1],n=arguments[2],r=e.getSafeEnvelope(),s=new lr(e,t,n);return this._index.query(r,new(function(){return g(function h(){o(this,h)},[{key:"interfaces_",get:function(){return[Hi]}},{key:"visitItem",value:function(h){h.select(r,s)}}])}())),s.isNodeAdded()}}}],[{key:"constructor_",value:function(){this._index=null;var i=arguments[0];this._index=i}}])}(),lr=function(i){function e(){var t;return o(this,e),t=c(this,e),e.constructor_.apply(t,arguments),t}return N(e,i),g(e,[{key:"isNodeAdded",value:function(){return this._isNodeAdded}},{key:"select",value:function(){if(!(arguments.length===2&&Number.isInteger(arguments[1])&&arguments[0]instanceof Zi))return b(e,"select",this,1).apply(this,arguments);var t=arguments[1],n=arguments[0].getContext();if(this._parentEdge===n&&(t===this._hotPixelVertexIndex||t+1===this._hotPixelVertexIndex))return null;this._isNodeAdded|=this._hotPixel.addSnappedNode(n,t)}}],[{key:"constructor_",value:function(){this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var t=arguments[0],n=arguments[1],r=arguments[2];this._hotPixel=t,this._parentEdge=n,this._hotPixelVertexIndex=r}}])}(ka);ur.HotPixelSnapAction=lr;var Ia=function(){return g(function i(){o(this,i),i.constructor_.apply(this,arguments)},[{key:"processIntersections",value:function(i,e,t,n){if(i===t&&e===n)return null;var r=i.getCoordinates()[e],s=i.getCoordinates()[e+1],h=t.getCoordinates()[n],f=t.getCoordinates()[n+1];if(this._li.computeIntersection(r,s,h,f),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var m=0;m<this._li.getIntersectionNum();m++)this._interiorIntersections.add(this._li.getIntersection(m));i.addIntersections(this._li,e,0),t.addIntersections(this._li,n,1)}}},{key:"isDone",value:function(){return!1}},{key:"getInteriorIntersections",value:function(){return this._interiorIntersections}},{key:"interfaces_",get:function(){return[ir]}}],[{key:"constructor_",value:function(){this._li=null,this._interiorIntersections=null;var i=arguments[0];this._li=i,this._interiorIntersections=new ue}}])}(),Na=function(){return g(function i(){o(this,i),i.constructor_.apply(this,arguments)},[{key:"checkCorrectness",value:function(i){var e=St.getNodedSubstrings(i),t=new or(e);try{t.checkValid()}catch(n){if(!(n instanceof j))throw n;n.printStackTrace()}}},{key:"getNodedSubstrings",value:function(){return St.getNodedSubstrings(this._nodedSegStrings)}},{key:"snapRound",value:function(i,e){var t=this.findInteriorIntersections(i,e);this.computeIntersectionSnaps(t),this.computeVertexSnaps(i)}},{key:"findInteriorIntersections",value:function(i,e){var t=new Ia(e);return this._noder.setSegmentIntersector(t),this._noder.computeNodes(i),t.getInteriorIntersections()}},{key:"computeVertexSnaps",value:function(){if(ge(arguments[0],we))for(var i=arguments[0].iterator();i.hasNext();){var e=i.next();this.computeVertexSnaps(e)}else if(arguments[0]instanceof St)for(var t=arguments[0],n=t.getCoordinates(),r=0;r<n.length;r++){var s=new ri(n[r],this._scaleFactor,this._li);this._pointSnapper.snap(s,t,r)&&t.addIntersection(n[r],r)}}},{key:"computeNodes",value:function(i){this._nodedSegStrings=i,this._noder=new ni,this._pointSnapper=new ur(this._noder.getIndex()),this.snapRound(i,this._li)}},{key:"computeIntersectionSnaps",value:function(i){for(var e=i.iterator();e.hasNext();){var t=e.next(),n=new ri(t,this._scaleFactor,this._li);this._pointSnapper.snap(n)}}},{key:"interfaces_",get:function(){return[ti]}}],[{key:"constructor_",value:function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var i=arguments[0];this._pm=i,this._li=new wt,this._li.setPrecisionModel(i),this._scaleFactor=i.getScale()}}])}(),Dt=function(){function i(){o(this,i),i.constructor_.apply(this,arguments)}return g(i,[{key:"bufferFixedPrecision",value:function(e){var t=new Ea(new Na(new Qe(1)),e.getScale()),n=new ar(this._bufParams);n.setWorkingPrecisionModel(e),n.setNoder(t),this._resultGeometry=n.buffer(this._argGeom,this._distance)}},{key:"bufferReducedPrecision",value:function(){if(arguments.length===0){for(var e=i.MAX_PRECISION_DIGITS;e>=0;e--){try{this.bufferReducedPrecision(e)}catch(s){if(!(s instanceof ct))throw s;this._saveException=s}if(this._resultGeometry!==null)return null}throw this._saveException}if(arguments.length===1){var t=arguments[0],n=i.precisionScaleFactor(this._argGeom,this._distance,t),r=new Qe(n);this.bufferFixedPrecision(r)}}},{key:"computeGeometry",value:function(){if(this.bufferOriginalPrecision(),this._resultGeometry!==null)return null;var e=this._argGeom.getFactory().getPrecisionModel();e.getType()===Qe.FIXED?this.bufferFixedPrecision(e):this.bufferReducedPrecision()}},{key:"setQuadrantSegments",value:function(e){this._bufParams.setQuadrantSegments(e)}},{key:"bufferOriginalPrecision",value:function(){try{var e=new ar(this._bufParams);this._resultGeometry=e.buffer(this._argGeom,this._distance)}catch(t){if(!(t instanceof te))throw t;this._saveException=t}}},{key:"getResultGeometry",value:function(e){return this._distance=e,this.computeGeometry(),this._resultGeometry}},{key:"setEndCapStyle",value:function(e){this._bufParams.setEndCapStyle(e)}}],[{key:"constructor_",value:function(){if(this._argGeom=null,this._distance=null,this._bufParams=new U,this._resultGeometry=null,this._saveException=null,arguments.length===1){var e=arguments[0];this._argGeom=e}else if(arguments.length===2){var t=arguments[0],n=arguments[1];this._argGeom=t,this._bufParams=n}}},{key:"bufferOp",value:function(){if(arguments.length===2){var e=arguments[1];return new i(arguments[0]).getResultGeometry(e)}if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof re&&typeof arguments[1]=="number"){var t=arguments[1],n=arguments[2],r=new i(arguments[0]);return r.setQuadrantSegments(n),r.getResultGeometry(t)}if(arguments[2]instanceof U&&arguments[0]instanceof re&&typeof arguments[1]=="number"){var s=arguments[1];return new i(arguments[0],arguments[2]).getResultGeometry(s)}}else if(arguments.length===4){var h=arguments[1],f=arguments[2],m=arguments[3],_=new i(arguments[0]);return _.setQuadrantSegments(f),_.setEndCapStyle(m),_.getResultGeometry(h)}}},{key:"precisionScaleFactor",value:function(e,t,n){var r=e.getEnvelopeInternal(),s=Xt.max(Math.abs(r.getMaxX()),Math.abs(r.getMaxY()),Math.abs(r.getMinX()),Math.abs(r.getMinY()))+2*(t>0?t:0),h=n-Math.trunc(Math.log(s)/Math.log(10)+1);return Math.pow(10,h)}}])}();Dt.CAP_ROUND=U.CAP_ROUND,Dt.CAP_BUTT=U.CAP_FLAT,Dt.CAP_FLAT=U.CAP_FLAT,Dt.CAP_SQUARE=U.CAP_SQUARE,Dt.MAX_PRECISION_DIGITS=12;var wa=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],hr=function(){return g(function i(e){o(this,i),this.geometryFactory=e||new Ot},[{key:"read",value:function(i){var e,t=(e=typeof i=="string"?JSON.parse(i):i).type;if(!je[t])throw new Error("Unknown GeoJSON type: "+e.type);return wa.indexOf(t)!==-1?je[t].call(this,e.coordinates):t==="GeometryCollection"?je[t].call(this,e.geometries):je[t].call(this,e)}},{key:"write",value:function(i){var e=i.getGeometryType();if(!at[e])throw new Error("Geometry is not supported");return at[e].call(this,i)}}])}(),je={Feature:function(i){var e={};for(var t in i)e[t]=i[t];if(i.geometry){var n=i.geometry.type;if(!je[n])throw new Error("Unknown GeoJSON type: "+i.type);e.geometry=this.read(i.geometry)}return i.bbox&&(e.bbox=je.bbox.call(this,i.bbox)),e},FeatureCollection:function(i){var e={};if(i.features){e.features=[];for(var t=0;t<i.features.length;++t)e.features.push(this.read(i.features[t]))}return i.bbox&&(e.bbox=this.parse.bbox.call(this,i.bbox)),e},coordinates:function(i){for(var e=[],t=0;t<i.length;++t){var n=i[t];e.push(d(F,Z(n)))}return e},bbox:function(i){return this.geometryFactory.createLinearRing([new F(i[0],i[1]),new F(i[2],i[1]),new F(i[2],i[3]),new F(i[0],i[3]),new F(i[0],i[1])])},Point:function(i){var e=d(F,Z(i));return this.geometryFactory.createPoint(e)},MultiPoint:function(i){for(var e=[],t=0;t<i.length;++t)e.push(je.Point.call(this,i[t]));return this.geometryFactory.createMultiPoint(e)},LineString:function(i){var e=je.coordinates.call(this,i);return this.geometryFactory.createLineString(e)},MultiLineString:function(i){for(var e=[],t=0;t<i.length;++t)e.push(je.LineString.call(this,i[t]));return this.geometryFactory.createMultiLineString(e)},Polygon:function(i){for(var e=je.coordinates.call(this,i[0]),t=this.geometryFactory.createLinearRing(e),n=[],r=1;r<i.length;++r){var s=i[r],h=je.coordinates.call(this,s),f=this.geometryFactory.createLinearRing(h);n.push(f)}return this.geometryFactory.createPolygon(t,n)},MultiPolygon:function(i){for(var e=[],t=0;t<i.length;++t){var n=i[t];e.push(je.Polygon.call(this,n))}return this.geometryFactory.createMultiPolygon(e)},GeometryCollection:function(i){for(var e=[],t=0;t<i.length;++t){var n=i[t];e.push(this.read(n))}return this.geometryFactory.createGeometryCollection(e)}},at={coordinate:function(i){var e=[i.x,i.y];return i.z&&e.push(i.z),i.m&&e.push(i.m),e},Point:function(i){return{type:"Point",coordinates:at.coordinate.call(this,i.getCoordinate())}},MultiPoint:function(i){for(var e=[],t=0;t<i._geometries.length;++t){var n=i._geometries[t],r=at.Point.call(this,n);e.push(r.coordinates)}return{type:"MultiPoint",coordinates:e}},LineString:function(i){for(var e=[],t=i.getCoordinates(),n=0;n<t.length;++n){var r=t[n];e.push(at.coordinate.call(this,r))}return{type:"LineString",coordinates:e}},MultiLineString:function(i){for(var e=[],t=0;t<i._geometries.length;++t){var n=i._geometries[t],r=at.LineString.call(this,n);e.push(r.coordinates)}return{type:"MultiLineString",coordinates:e}},Polygon:function(i){var e=[],t=at.LineString.call(this,i._shell);e.push(t.coordinates);for(var n=0;n<i._holes.length;++n){var r=i._holes[n],s=at.LineString.call(this,r);e.push(s.coordinates)}return{type:"Polygon",coordinates:e}},MultiPolygon:function(i){for(var e=[],t=0;t<i._geometries.length;++t){var n=i._geometries[t],r=at.Polygon.call(this,n);e.push(r.coordinates)}return{type:"MultiPolygon",coordinates:e}},GeometryCollection:function(i){for(var e=[],t=0;t<i._geometries.length;++t){var n=i._geometries[t],r=n.getGeometryType();e.push(at[r].call(this,n))}return{type:"GeometryCollection",geometries:e}}};return{BufferOp:Dt,GeoJSONReader:function(){return g(function i(e){o(this,i),this.parser=new hr(e||new Ot)},[{key:"read",value:function(i){return this.parser.read(i)}}])}(),GeoJSONWriter:function(){return g(function i(){o(this,i),this.parser=new hr(this.geometryFactory)},[{key:"write",value:function(i){return this.parser.write(i)}}])}()}})}(Tn)),Tn.exports}var qa=Ga();const Ba=Sa(qa);function _t(){return new bn}function bn(){this.reset()}bn.prototype={constructor:bn,reset:function(){this.s=this.t=0},add:function(u){kr(pn,u,this.t),kr(this,pn.s,this.s),this.s?this.t+=pn.t:this.s=pn.t},valueOf:function(){return this.s}};var pn=new bn;function kr(u,a,l){var c=u.s=a+l,o=c-a,d=c-o;u.t=a-d+(l-o)}var Ne=1e-6,ve=Math.PI,ut=ve/2,Ir=ve/4,ht=ve*2,vt=180/ve,Ke=ve/180,Me=Math.abs,za=Math.atan,Ft=Math.atan2,Te=Math.cos,Le=Math.sin,zt=Math.sqrt;function Zr(u){return u>1?0:u<-1?ve:Math.acos(u)}function Ct(u){return u>1?ut:u<-1?-ut:Math.asin(u)}function tn(){}function Mn(u,a){u&&wr.hasOwnProperty(u.type)&&wr[u.type](u,a)}var Nr={Feature:function(u,a){Mn(u.geometry,a)},FeatureCollection:function(u,a){for(var l=u.features,c=-1,o=l.length;++c<o;)Mn(l[c].geometry,a)}},wr={Sphere:function(u,a){a.sphere()},Point:function(u,a){u=u.coordinates,a.point(u[0],u[1],u[2])},MultiPoint:function(u,a){for(var l=u.coordinates,c=-1,o=l.length;++c<o;)u=l[c],a.point(u[0],u[1],u[2])},LineString:function(u,a){fi(u.coordinates,a,0)},MultiLineString:function(u,a){for(var l=u.coordinates,c=-1,o=l.length;++c<o;)fi(l[c],a,0)},Polygon:function(u,a){Sr(u.coordinates,a)},MultiPolygon:function(u,a){for(var l=u.coordinates,c=-1,o=l.length;++c<o;)Sr(l[c],a)},GeometryCollection:function(u,a){for(var l=u.geometries,c=-1,o=l.length;++c<o;)Mn(l[c],a)}};function fi(u,a,l){var c=-1,o=u.length-l,d;for(a.lineStart();++c<o;)d=u[c],a.point(d[0],d[1],d[2]);a.lineEnd()}function Sr(u,a){var l=-1,c=u.length;for(a.polygonStart();++l<c;)fi(u[l],a,1);a.polygonEnd()}function Ya(u,a){u&&Nr.hasOwnProperty(u.type)?Nr[u.type](u,a):Mn(u,a)}_t();_t();function gi(u){return[Ft(u[1],u[0]),Ct(u[2])]}function Gt(u){var a=u[0],l=u[1],c=Te(l);return[c*Te(a),c*Le(a),Le(l)]}function _n(u,a){return u[0]*a[0]+u[1]*a[1]+u[2]*a[2]}function Pn(u,a){return[u[1]*a[2]-u[2]*a[1],u[2]*a[0]-u[0]*a[2],u[0]*a[1]-u[1]*a[0]]}function oi(u,a){u[0]+=a[0],u[1]+=a[1],u[2]+=a[2]}function xn(u,a){return[u[0]*a,u[1]*a,u[2]*a]}function mi(u){var a=zt(u[0]*u[0]+u[1]*u[1]+u[2]*u[2]);u[0]/=a,u[1]/=a,u[2]/=a}_t();function Wr(u,a){function l(c,o){return c=u(c,o),a(c[0],c[1])}return u.invert&&a.invert&&(l.invert=function(c,o){return c=a.invert(c,o),c&&u.invert(c[0],c[1])}),l}function yi(u,a){return[u>ve?u-ht:u<-ve?u+ht:u,a]}yi.invert=yi;function Ua(u,a,l){return(u%=ht)?a||l?Wr(Lr(u),Cr(a,l)):Lr(u):a||l?Cr(a,l):yi}function Tr(u){return function(a,l){return a+=u,[a>ve?a-ht:a<-ve?a+ht:a,l]}}function Lr(u){var a=Tr(u);return a.invert=Tr(-u),a}function Cr(u,a){var l=Te(u),c=Le(u),o=Te(a),d=Le(a);function p(g,C){var x=Te(C),w=Te(g)*x,N=Le(g)*x,D=Le(C),B=D*l+w*c;return[Ft(N*o-B*d,w*l-D*c),Ct(B*o+N*d)]}return p.invert=function(g,C){var x=Te(C),w=Te(g)*x,N=Le(g)*x,D=Le(C),B=D*o-N*d;return[Ft(N*o+D*d,w*l+B*c),Ct(B*l-w*c)]},p}function Xa(u,a,l,c,o,d){if(l){var p=Te(a),g=Le(a),C=c*l;o==null?(o=a+c*ht,d=a-C/2):(o=Rr(p,o),d=Rr(p,d),(c>0?o<d:o>d)&&(o+=c*ht));for(var x,w=o;c>0?w>d:w<d;w-=C)x=gi([p,-g*Te(w),-g*Le(w)]),u.point(x[0],x[1])}}function Rr(u,a){a=Gt(a),a[0]-=u,mi(a);var l=Zr(-a[1]);return((-a[2]<0?-l:l)+ht-Ne)%ht}function Jr(){var u=[],a;return{point:function(l,c){a.push([l,c])},lineStart:function(){u.push(a=[])},lineEnd:tn,rejoin:function(){u.length>1&&u.push(u.pop().concat(u.shift()))},result:function(){var l=u;return u=[],a=null,l}}}function Va(u,a,l,c,o,d){var p=u[0],g=u[1],C=a[0],x=a[1],w=0,N=1,D=C-p,B=x-g,b;if(b=l-p,!(!D&&b>0)){if(b/=D,D<0){if(b<w)return;b<N&&(N=b)}else if(D>0){if(b>N)return;b>w&&(w=b)}if(b=o-p,!(!D&&b<0)){if(b/=D,D<0){if(b>N)return;b>w&&(w=b)}else if(D>0){if(b<w)return;b<N&&(N=b)}if(b=c-g,!(!B&&b>0)){if(b/=B,B<0){if(b<w)return;b<N&&(N=b)}else if(B>0){if(b>N)return;b>w&&(w=b)}if(b=d-g,!(!B&&b<0)){if(b/=B,B<0){if(b>N)return;b>w&&(w=b)}else if(B>0){if(b<w)return;b<N&&(N=b)}return w>0&&(u[0]=p+w*D,u[1]=g+w*B),N<1&&(a[0]=p+N*D,a[1]=g+N*B),!0}}}}}function Ln(u,a){return Me(u[0]-a[0])<Ne&&Me(u[1]-a[1])<Ne}function En(u,a,l,c){this.x=u,this.z=a,this.o=l,this.e=c,this.v=!1,this.n=this.p=null}function Kr(u,a,l,c,o){var d=[],p=[],g,C;if(u.forEach(function(b){if(!((Z=b.length-1)<=0)){var Z,V=b[0],ee=b[Z],q;if(Ln(V,ee)){for(o.lineStart(),g=0;g<Z;++g)o.point((V=b[g])[0],V[1]);o.lineEnd();return}d.push(q=new En(V,b,null,!0)),p.push(q.o=new En(V,null,q,!1)),d.push(q=new En(ee,b,null,!1)),p.push(q.o=new En(ee,null,q,!0))}}),!!d.length){for(p.sort(a),Or(d),Or(p),g=0,C=p.length;g<C;++g)p[g].e=l=!l;for(var x=d[0],w,N;;){for(var D=x,B=!0;D.v;)if((D=D.n)===x)return;w=D.z,o.lineStart();do{if(D.v=D.o.v=!0,D.e){if(B)for(g=0,C=w.length;g<C;++g)o.point((N=w[g])[0],N[1]);else c(D.x,D.n.x,1,o);D=D.n}else{if(B)for(w=D.p.z,g=w.length-1;g>=0;--g)o.point((N=w[g])[0],N[1]);else c(D.x,D.p.x,-1,o);D=D.p}D=D.o,w=D.z,B=!B}while(!D.v);o.lineEnd()}}}function Or(u){if(a=u.length){for(var a,l=0,c=u[0],o;++l<a;)c.n=o=u[l],o.p=c,c=o;c.n=o=u[0],o.p=c}}function Qr(u,a){return u<a?-1:u>a?1:u>=a?0:NaN}function $a(u){return u.length===1&&(u=Ha(u)),{left:function(a,l,c,o){for(c==null&&(c=0),o==null&&(o=a.length);c<o;){var d=c+o>>>1;u(a[d],l)<0?c=d+1:o=d}return c},right:function(a,l,c,o){for(c==null&&(c=0),o==null&&(o=a.length);c<o;){var d=c+o>>>1;u(a[d],l)>0?o=d:c=d+1}return c}}}function Ha(u){return function(a,l){return Qr(u(a),l)}}$a(Qr);function es(u){for(var a=u.length,l,c=-1,o=0,d,p;++c<a;)o+=u[c].length;for(d=new Array(o);--a>=0;)for(p=u[a],l=p.length;--l>=0;)d[--o]=p[l];return d}var kn=1e9,In=-1e9;function ja(u,a,l,c){function o(x,w){return u<=x&&x<=l&&a<=w&&w<=c}function d(x,w,N,D){var B=0,b=0;if(x==null||(B=p(x,N))!==(b=p(w,N))||C(x,w)<0^N>0)do D.point(B===0||B===3?u:l,B>1?c:a);while((B=(B+N+4)%4)!==b);else D.point(w[0],w[1])}function p(x,w){return Me(x[0]-u)<Ne?w>0?0:3:Me(x[0]-l)<Ne?w>0?2:1:Me(x[1]-a)<Ne?w>0?1:0:w>0?3:2}function g(x,w){return C(x.x,w.x)}function C(x,w){var N=p(x,1),D=p(w,1);return N!==D?N-D:N===0?w[1]-x[1]:N===1?x[0]-w[0]:N===2?x[1]-w[1]:w[0]-x[0]}return function(x){var w=x,N=Jr(),D,B,b,Z,V,ee,q,U,j,W,K,ie={point:y,lineStart:T,lineEnd:M,polygonStart:E,polygonEnd:A};function y(k,L){o(k,L)&&w.point(k,L)}function v(){for(var k=0,L=0,O=B.length;L<O;++L)for(var R=B[L],Y=1,z=R.length,X=R[0],te,oe,ne=X[0],ce=X[1];Y<z;++Y)te=ne,oe=ce,X=R[Y],ne=X[0],ce=X[1],oe<=c?ce>c&&(ne-te)*(c-oe)>(ce-oe)*(u-te)&&++k:ce<=c&&(ne-te)*(c-oe)<(ce-oe)*(u-te)&&--k;return k}function E(){w=N,D=[],B=[],K=!0}function A(){var k=v(),L=K&&k,O=(D=es(D)).length;(L||O)&&(x.polygonStart(),L&&(x.lineStart(),d(null,null,1,x),x.lineEnd()),O&&Kr(D,g,k,d,x),x.polygonEnd()),w=x,D=B=b=null}function T(){ie.point=S,B&&B.push(b=[]),W=!0,j=!1,q=U=NaN}function M(){D&&(S(Z,V),ee&&j&&N.rejoin(),D.push(N.result())),ie.point=y,j&&w.lineEnd()}function S(k,L){var O=o(k,L);if(B&&b.push([k,L]),W)Z=k,V=L,ee=O,W=!1,O&&(w.lineStart(),w.point(k,L));else if(O&&j)w.point(k,L);else{var R=[q=Math.max(In,Math.min(kn,q)),U=Math.max(In,Math.min(kn,U))],Y=[k=Math.max(In,Math.min(kn,k)),L=Math.max(In,Math.min(kn,L))];Va(R,Y,u,a,l,c)?(j||(w.lineStart(),w.point(R[0],R[1])),w.point(Y[0],Y[1]),O||w.lineEnd(),K=!1):O&&(w.lineStart(),w.point(k,L),K=!1)}q=k,U=L,j=O}return ie}}var ui=_t();function Za(u,a){var l=a[0],c=a[1],o=[Le(l),-Te(l),0],d=0,p=0;ui.reset();for(var g=0,C=u.length;g<C;++g)if(w=(x=u[g]).length)for(var x,w,N=x[w-1],D=N[0],B=N[1]/2+Ir,b=Le(B),Z=Te(B),V=0;V<w;++V,D=q,b=j,Z=W,N=ee){var ee=x[V],q=ee[0],U=ee[1]/2+Ir,j=Le(U),W=Te(U),K=q-D,ie=K>=0?1:-1,y=ie*K,v=y>ve,E=b*j;if(ui.add(Ft(E*ie*Le(y),Z*W+E*Te(y))),d+=v?K+ie*ht:K,v^D>=l^q>=l){var A=Pn(Gt(N),Gt(ee));mi(A);var T=Pn(o,A);mi(T);var M=(v^K>=0?-1:1)*Ct(T[2]);(c>M||c===M&&(A[0]||A[1]))&&(p+=v^K>=0?1:-1)}}return(d<-1e-6||d<Ne&&ui<-1e-6)^p&1}_t();function br(u){return u}_t();_t();var qt=1/0,An=qt,sn=-qt,Dn=sn,Mr={point:Wa,lineStart:tn,lineEnd:tn,polygonStart:tn,polygonEnd:tn,result:function(){var u=[[qt,An],[sn,Dn]];return sn=Dn=-(An=qt=1/0),u}};function Wa(u,a){u<qt&&(qt=u),u>sn&&(sn=u),a<An&&(An=a),a>Dn&&(Dn=a)}_t();function ts(u,a,l,c){return function(o,d){var p=a(d),g=o.invert(c[0],c[1]),C=Jr(),x=a(C),w=!1,N,D,B,b={point:Z,lineStart:ee,lineEnd:q,polygonStart:function(){b.point=U,b.lineStart=j,b.lineEnd=W,D=[],N=[]},polygonEnd:function(){b.point=Z,b.lineStart=ee,b.lineEnd=q,D=es(D);var K=Za(N,g);D.length?(w||(d.polygonStart(),w=!0),Kr(D,Ka,K,l,d)):K&&(w||(d.polygonStart(),w=!0),d.lineStart(),l(null,null,1,d),d.lineEnd()),w&&(d.polygonEnd(),w=!1),D=N=null},sphere:function(){d.polygonStart(),d.lineStart(),l(null,null,1,d),d.lineEnd(),d.polygonEnd()}};function Z(K,ie){var y=o(K,ie);u(K=y[0],ie=y[1])&&d.point(K,ie)}function V(K,ie){var y=o(K,ie);p.point(y[0],y[1])}function ee(){b.point=V,p.lineStart()}function q(){b.point=Z,p.lineEnd()}function U(K,ie){B.push([K,ie]);var y=o(K,ie);x.point(y[0],y[1])}function j(){x.lineStart(),B=[]}function W(){U(B[0][0],B[0][1]),x.lineEnd();var K=x.clean(),ie=C.result(),y,v=ie.length,E,A,T;if(B.pop(),N.push(B),B=null,!!v){if(K&1){if(A=ie[0],(E=A.length-1)>0){for(w||(d.polygonStart(),w=!0),d.lineStart(),y=0;y<E;++y)d.point((T=A[y])[0],T[1]);d.lineEnd()}return}v>1&&K&2&&ie.push(ie.pop().concat(ie.shift())),D.push(ie.filter(Ja))}}return b}}function Ja(u){return u.length>1}function Ka(u,a){return((u=u.x)[0]<0?u[1]-ut-Ne:ut-u[1])-((a=a.x)[0]<0?a[1]-ut-Ne:ut-a[1])}const Pr=ts(function(){return!0},Qa,to,[-ve,-ut]);function Qa(u){var a=NaN,l=NaN,c=NaN,o;return{lineStart:function(){u.lineStart(),o=1},point:function(d,p){var g=d>0?ve:-ve,C=Me(d-a);Me(C-ve)<Ne?(u.point(a,l=(l+p)/2>0?ut:-ut),u.point(c,l),u.lineEnd(),u.lineStart(),u.point(g,l),u.point(d,l),o=0):c!==g&&C>=ve&&(Me(a-c)<Ne&&(a-=c*Ne),Me(d-g)<Ne&&(d-=g*Ne),l=eo(a,l,d,p),u.point(c,l),u.lineEnd(),u.lineStart(),u.point(g,l),o=0),u.point(a=d,l=p),c=g},lineEnd:function(){u.lineEnd(),a=l=NaN},clean:function(){return 2-o}}}function eo(u,a,l,c){var o,d,p=Le(u-l);return Me(p)>Ne?za((Le(a)*(d=Te(c))*Le(l)-Le(c)*(o=Te(a))*Le(u))/(o*d*p)):(a+c)/2}function to(u,a,l,c){var o;if(u==null)o=l*ut,c.point(-ve,o),c.point(0,o),c.point(ve,o),c.point(ve,0),c.point(ve,-o),c.point(0,-o),c.point(-ve,-o),c.point(-ve,0),c.point(-ve,o);else if(Me(u[0]-a[0])>Ne){var d=u[0]<a[0]?ve:-ve;o=l*d/2,c.point(-d,o),c.point(0,o),c.point(d,o)}else c.point(a[0],a[1])}function no(u,a){var l=Te(u),c=l>0,o=Me(l)>Ne;function d(w,N,D,B){Xa(B,u,a,D,w,N)}function p(w,N){return Te(w)*Te(N)>l}function g(w){var N,D,B,b,Z;return{lineStart:function(){b=B=!1,Z=1},point:function(V,ee){var q=[V,ee],U,j=p(V,ee),W=c?j?0:x(V,ee):j?x(V+(V<0?ve:-ve),ee):0;if(!N&&(b=B=j)&&w.lineStart(),j!==B&&(U=C(N,q),(!U||Ln(N,U)||Ln(q,U))&&(q[0]+=Ne,q[1]+=Ne,j=p(q[0],q[1]))),j!==B)Z=0,j?(w.lineStart(),U=C(q,N),w.point(U[0],U[1])):(U=C(N,q),w.point(U[0],U[1]),w.lineEnd()),N=U;else if(o&&N&&c^j){var K;!(W&D)&&(K=C(q,N,!0))&&(Z=0,c?(w.lineStart(),w.point(K[0][0],K[0][1]),w.point(K[1][0],K[1][1]),w.lineEnd()):(w.point(K[1][0],K[1][1]),w.lineEnd(),w.lineStart(),w.point(K[0][0],K[0][1])))}j&&(!N||!Ln(N,q))&&w.point(q[0],q[1]),N=q,B=j,D=W},lineEnd:function(){B&&w.lineEnd(),N=null},clean:function(){return Z|(b&&B)<<1}}}function C(w,N,D){var B=Gt(w),b=Gt(N),Z=[1,0,0],V=Pn(B,b),ee=_n(V,V),q=V[0],U=ee-q*q;if(!U)return!D&&w;var j=l*ee/U,W=-l*q/U,K=Pn(Z,V),ie=xn(Z,j),y=xn(V,W);oi(ie,y);var v=K,E=_n(ie,v),A=_n(v,v),T=E*E-A*(_n(ie,ie)-1);if(!(T<0)){var M=zt(T),S=xn(v,(-E-M)/A);if(oi(S,ie),S=gi(S),!D)return S;var k=w[0],L=N[0],O=w[1],R=N[1],Y;L<k&&(Y=k,k=L,L=Y);var z=L-k,X=Me(z-ve)<Ne,te=X||z<Ne;if(!X&&R<O&&(Y=O,O=R,R=Y),te?X?O+R>0^S[1]<(Me(S[0]-k)<Ne?O:R):O<=S[1]&&S[1]<=R:z>ve^(k<=S[0]&&S[0]<=L)){var oe=xn(v,(-E+M)/A);return oi(oe,ie),[S,gi(oe)]}}}function x(w,N){var D=c?u:ve-u,B=0;return w<-D?B|=1:w>D&&(B|=2),N<-D?B|=4:N>D&&(B|=8),B}return ts(p,g,d,c?[0,-u]:[-ve,u-ve])}function ns(u){return function(a){var l=new di;for(var c in u)l[c]=u[c];return l.stream=a,l}}function di(){}di.prototype={constructor:di,point:function(u,a){this.stream.point(u,a)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function is(u,a,l){var c=a[1][0]-a[0][0],o=a[1][1]-a[0][1],d=u.clipExtent&&u.clipExtent();u.scale(150).translate([0,0]),d!=null&&u.clipExtent(null),Ya(l,u.stream(Mr));var p=Mr.result(),g=Math.min(c/(p[1][0]-p[0][0]),o/(p[1][1]-p[0][1])),C=+a[0][0]+(c-g*(p[1][0]+p[0][0]))/2,x=+a[0][1]+(o-g*(p[1][1]+p[0][1]))/2;return d!=null&&u.clipExtent(d),u.scale(g*150).translate([C,x])}function io(u,a,l){return is(u,[[0,0],a],l)}var Ar=16,ro=Te(30*Ke);function Dr(u,a){return+a?ao(u,a):so(u)}function so(u){return ns({point:function(a,l){a=u(a,l),this.stream.point(a[0],a[1])}})}function ao(u,a){function l(c,o,d,p,g,C,x,w,N,D,B,b,Z,V){var ee=x-c,q=w-o,U=ee*ee+q*q;if(U>4*a&&Z--){var j=p+D,W=g+B,K=C+b,ie=zt(j*j+W*W+K*K),y=Ct(K/=ie),v=Me(Me(K)-1)<Ne||Me(d-N)<Ne?(d+N)/2:Ft(W,j),E=u(v,y),A=E[0],T=E[1],M=A-c,S=T-o,k=q*M-ee*S;(k*k/U>a||Me((ee*M+q*S)/U-.5)>.3||p*D+g*B+C*b<ro)&&(l(c,o,d,p,g,C,A,T,v,j/=ie,W/=ie,K,Z,V),V.point(A,T),l(A,T,v,j,W,K,x,w,N,D,B,b,Z,V))}}return function(c){var o,d,p,g,C,x,w,N,D,B,b,Z,V={point:ee,lineStart:q,lineEnd:j,polygonStart:function(){c.polygonStart(),V.lineStart=W},polygonEnd:function(){c.polygonEnd(),V.lineStart=q}};function ee(y,v){y=u(y,v),c.point(y[0],y[1])}function q(){N=NaN,V.point=U,c.lineStart()}function U(y,v){var E=Gt([y,v]),A=u(y,v);l(N,D,w,B,b,Z,N=A[0],D=A[1],w=y,B=E[0],b=E[1],Z=E[2],Ar,c),c.point(N,D)}function j(){V.point=ee,c.lineEnd()}function W(){q(),V.point=K,V.lineEnd=ie}function K(y,v){U(o=y,v),d=N,p=D,g=B,C=b,x=Z,V.point=U}function ie(){l(N,D,w,B,b,Z,d,p,o,g,C,x,Ar,c),V.lineEnd=j,j()}return V}}var oo=ns({point:function(u,a){this.stream.point(u*Ke,a*Ke)}});function uo(u){return lo(function(){return u})()}function lo(u){var a,l=150,c=480,o=250,d,p,g=0,C=0,x=0,w=0,N=0,D,B,b=null,Z=Pr,V=null,ee,q,U,j=br,W=.5,K=Dr(A,W),ie,y;function v(S){return S=B(S[0]*Ke,S[1]*Ke),[S[0]*l+d,p-S[1]*l]}function E(S){return S=B.invert((S[0]-d)/l,(p-S[1])/l),S&&[S[0]*vt,S[1]*vt]}function A(S,k){return S=a(S,k),[S[0]*l+d,p-S[1]*l]}v.stream=function(S){return ie&&y===S?ie:ie=oo(Z(D,K(j(y=S))))},v.clipAngle=function(S){return arguments.length?(Z=+S?no(b=S*Ke,6*Ke):(b=null,Pr),M()):b*vt},v.clipExtent=function(S){return arguments.length?(j=S==null?(V=ee=q=U=null,br):ja(V=+S[0][0],ee=+S[0][1],q=+S[1][0],U=+S[1][1]),M()):V==null?null:[[V,ee],[q,U]]},v.scale=function(S){return arguments.length?(l=+S,T()):l},v.translate=function(S){return arguments.length?(c=+S[0],o=+S[1],T()):[c,o]},v.center=function(S){return arguments.length?(g=S[0]%360*Ke,C=S[1]%360*Ke,T()):[g*vt,C*vt]},v.rotate=function(S){return arguments.length?(x=S[0]%360*Ke,w=S[1]%360*Ke,N=S.length>2?S[2]%360*Ke:0,T()):[x*vt,w*vt,N*vt]},v.precision=function(S){return arguments.length?(K=Dr(A,W=S*S),M()):zt(W)},v.fitExtent=function(S,k){return is(v,S,k)},v.fitSize=function(S,k){return io(v,S,k)};function T(){B=Wr(D=Ua(x,w,N),a);var S=a(g,C);return d=c-S[0]*l,p=o+S[1]*l,M()}function M(){return ie=y=null,v}return function(){return a=u.apply(this,arguments),v.invert=a.invert&&E,T()}}function rs(u){return function(a,l){var c=Te(a),o=Te(l),d=u(c*o);return[d*o*Le(a),d*Le(l)]}}function ss(u){return function(a,l){var c=zt(a*a+l*l),o=u(c),d=Le(o),p=Te(o);return[Ft(a*d,c*p),Ct(c&&l*d/c)]}}var ho=rs(function(u){return zt(2/(1+u))});ho.invert=ss(function(u){return 2*Ct(u/2)});var as=rs(function(u){return(u=Zr(u))&&u/Le(u)});as.invert=ss(function(u){return u});function co(){return uo(as).scale(79.4188).clipAngle(180-.001)}function Fr(u,a){return[u,a]}Fr.invert=Fr;var{BufferOp:fo,GeoJSONReader:go,GeoJSONWriter:mo}=Ba;function os(u,a,l){l=l||{};var c=l.units||"kilometers",o=l.steps||8;if(!u)throw new Error("geojson is required");if(typeof l!="object")throw new Error("options must be an object");if(typeof o!="number")throw new Error("steps must be an number");if(a===void 0)throw new Error("radius is required");if(o<=0)throw new Error("steps must be greater than 0");var d=[];switch(u.type){case"GeometryCollection":return ki(u,function(p){var g=Cn(p,a,c,o);g&&d.push(g)}),ci(d);case"FeatureCollection":return xr(u,function(p){var g=Cn(p,a,c,o);g&&xr(g,function(C){C&&d.push(C)})}),ci(d)}return Cn(u,a,c,o)}function Cn(u,a,l,c){var o=u.properties||{},d=u.type==="Feature"?u.geometry:u;if(d.type==="GeometryCollection"){var p=[];return ki(u,function(Z){var V=Cn(Z,a,l,c);V&&p.push(V)}),ci(p)}var g=yo(d),C={type:d.type,coordinates:ls(d.coordinates,g)},x=new go,w=x.read(C),N=Ma(Pa(a,l),"meters"),D=fo.bufferOp(w,N,c),B=new mo;if(D=B.write(D),!us(D.coordinates)){var b={type:D.type,coordinates:hs(D.coordinates,g)};return Bt(b,o)}}function us(u){return Array.isArray(u[0])?us(u[0]):isNaN(u[0])}function ls(u,a){return typeof u[0]!="object"?a(u):u.map(function(l){return ls(l,a)})}function hs(u,a){return typeof u[0]!="object"?a.invert(u):u.map(function(l){return hs(l,a)})}function yo(u){var a=Da(u).geometry.coordinates,l=[-a[0],-a[1]];return co().rotate(l).scale(Ge)}var vo=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,li=Math.ceil,We=Math.floor,qe="[BigNumber Error] ",Gr=qe+"Number primitive has more than 15 significant digits: ",tt=1e14,fe=14,qr=9007199254740991,hi=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],pt=1e7,Ue=1e9;function cs(u){var a,l,c,o=q.prototype={constructor:q,toString:null,valueOf:null},d=new q(1),p=20,g=4,C=-7,x=21,w=-1e7,N=1e7,D=!1,B=1,b=0,Z={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},V="0123456789abcdefghijklmnopqrstuvwxyz",ee=!0;function q(y,v){var E,A,T,M,S,k,L,O,R=this;if(!(R instanceof q))return new q(y,v);if(v==null){if(y&&y._isBigNumber===!0){R.s=y.s,!y.c||y.e>N?R.c=R.e=null:y.e<w?R.c=[R.e=0]:(R.e=y.e,R.c=y.c.slice());return}if((k=typeof y=="number")&&y*0==0){if(R.s=1/y<0?(y=-y,-1):1,y===~~y){for(M=0,S=y;S>=10;S/=10,M++);M>N?R.c=R.e=null:(R.e=M,R.c=[y]);return}O=String(y)}else{if(!vo.test(O=String(y)))return c(R,O,k);R.s=O.charCodeAt(0)==45?(O=O.slice(1),-1):1}(M=O.indexOf("."))>-1&&(O=O.replace(".","")),(S=O.search(/e/i))>0?(M<0&&(M=S),M+=+O.slice(S+1),O=O.substring(0,S)):M<0&&(M=O.length)}else{if(Se(v,2,V.length,"Base"),v==10&&ee)return R=new q(y),K(R,p+R.e+1,g);if(O=String(y),k=typeof y=="number"){if(y*0!=0)return c(R,O,k,v);if(R.s=1/y<0?(O=O.slice(1),-1):1,q.DEBUG&&O.replace(/^0\.0*|\./,"").length>15)throw Error(Gr+y)}else R.s=O.charCodeAt(0)===45?(O=O.slice(1),-1):1;for(E=V.slice(0,v),M=S=0,L=O.length;S<L;S++)if(E.indexOf(A=O.charAt(S))<0){if(A=="."){if(S>M){M=L;continue}}else if(!T&&(O==O.toUpperCase()&&(O=O.toLowerCase())||O==O.toLowerCase()&&(O=O.toUpperCase()))){T=!0,S=-1,M=0;continue}return c(R,String(y),k,v)}k=!1,O=l(O,v,10,R.s),(M=O.indexOf("."))>-1?O=O.replace(".",""):M=O.length}for(S=0;O.charCodeAt(S)===48;S++);for(L=O.length;O.charCodeAt(--L)===48;);if(O=O.slice(S,++L)){if(L-=S,k&&q.DEBUG&&L>15&&(y>qr||y!==We(y)))throw Error(Gr+R.s*y);if((M=M-S-1)>N)R.c=R.e=null;else if(M<w)R.c=[R.e=0];else{if(R.e=M,R.c=[],S=(M+1)%fe,M<0&&(S+=fe),S<L){for(S&&R.c.push(+O.slice(0,S)),L-=fe;S<L;)R.c.push(+O.slice(S,S+=fe));S=fe-(O=O.slice(S)).length}else S-=L;for(;S--;O+="0");R.c.push(+O)}}else R.c=[R.e=0]}q.clone=cs,q.ROUND_UP=0,q.ROUND_DOWN=1,q.ROUND_CEIL=2,q.ROUND_FLOOR=3,q.ROUND_HALF_UP=4,q.ROUND_HALF_DOWN=5,q.ROUND_HALF_EVEN=6,q.ROUND_HALF_CEIL=7,q.ROUND_HALF_FLOOR=8,q.EUCLID=9,q.config=q.set=function(y){var v,E;if(y!=null)if(typeof y=="object"){if(y.hasOwnProperty(v="DECIMAL_PLACES")&&(E=y[v],Se(E,0,Ue,v),p=E),y.hasOwnProperty(v="ROUNDING_MODE")&&(E=y[v],Se(E,0,8,v),g=E),y.hasOwnProperty(v="EXPONENTIAL_AT")&&(E=y[v],E&&E.pop?(Se(E[0],-1e9,0,v),Se(E[1],0,Ue,v),C=E[0],x=E[1]):(Se(E,-1e9,Ue,v),C=-(x=E<0?-E:E))),y.hasOwnProperty(v="RANGE"))if(E=y[v],E&&E.pop)Se(E[0],-1e9,-1,v),Se(E[1],1,Ue,v),w=E[0],N=E[1];else if(Se(E,-1e9,Ue,v),E)w=-(N=E<0?-E:E);else throw Error(qe+v+" cannot be zero: "+E);if(y.hasOwnProperty(v="CRYPTO"))if(E=y[v],E===!!E)if(E)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))D=E;else throw D=!E,Error(qe+"crypto unavailable");else D=E;else throw Error(qe+v+" not true or false: "+E);if(y.hasOwnProperty(v="MODULO_MODE")&&(E=y[v],Se(E,0,9,v),B=E),y.hasOwnProperty(v="POW_PRECISION")&&(E=y[v],Se(E,0,Ue,v),b=E),y.hasOwnProperty(v="FORMAT"))if(E=y[v],typeof E=="object")Z=E;else throw Error(qe+v+" not an object: "+E);if(y.hasOwnProperty(v="ALPHABET"))if(E=y[v],typeof E=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(E))ee=E.slice(0,10)=="0123456789",V=E;else throw Error(qe+v+" invalid: "+E)}else throw Error(qe+"Object expected: "+y);return{DECIMAL_PLACES:p,ROUNDING_MODE:g,EXPONENTIAL_AT:[C,x],RANGE:[w,N],CRYPTO:D,MODULO_MODE:B,POW_PRECISION:b,FORMAT:Z,ALPHABET:V}},q.isBigNumber=function(y){if(!y||y._isBigNumber!==!0)return!1;if(!q.DEBUG)return!0;var v,E,A=y.c,T=y.e,M=y.s;e:if({}.toString.call(A)=="[object Array]"){if((M===1||M===-1)&&T>=-1e9&&T<=Ue&&T===We(T)){if(A[0]===0){if(T===0&&A.length===1)return!0;break e}if(v=(T+1)%fe,v<1&&(v+=fe),String(A[0]).length==v){for(v=0;v<A.length;v++)if(E=A[v],E<0||E>=tt||E!==We(E))break e;if(E!==0)return!0}}}else if(A===null&&T===null&&(M===null||M===1||M===-1))return!0;throw Error(qe+"Invalid BigNumber: "+y)},q.maximum=q.max=function(){return j(arguments,-1)},q.minimum=q.min=function(){return j(arguments,1)},q.random=function(){var y=9007199254740992,v=Math.random()*y&2097151?function(){return We(Math.random()*y)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(E){var A,T,M,S,k,L=0,O=[],R=new q(d);if(E==null?E=p:Se(E,0,Ue),S=li(E/fe),D)if(crypto.getRandomValues){for(A=crypto.getRandomValues(new Uint32Array(S*=2));L<S;)k=A[L]*131072+(A[L+1]>>>11),k>=9e15?(T=crypto.getRandomValues(new Uint32Array(2)),A[L]=T[0],A[L+1]=T[1]):(O.push(k%1e14),L+=2);L=S/2}else if(crypto.randomBytes){for(A=crypto.randomBytes(S*=7);L<S;)k=(A[L]&31)*281474976710656+A[L+1]*1099511627776+A[L+2]*4294967296+A[L+3]*16777216+(A[L+4]<<16)+(A[L+5]<<8)+A[L+6],k>=9e15?crypto.randomBytes(7).copy(A,L):(O.push(k%1e14),L+=7);L=S/7}else throw D=!1,Error(qe+"crypto unavailable");if(!D)for(;L<S;)k=v(),k<9e15&&(O[L++]=k%1e14);for(S=O[--L],E%=fe,S&&E&&(k=hi[fe-E],O[L]=We(S/k)*k);O[L]===0;O.pop(),L--);if(L<0)O=[M=0];else{for(M=-1;O[0]===0;O.splice(0,1),M-=fe);for(L=1,k=O[0];k>=10;k/=10,L++);L<fe&&(M-=fe-L)}return R.e=M,R.c=O,R}}(),q.sum=function(){for(var y=1,v=arguments,E=new q(v[0]);y<v.length;)E=E.plus(v[y++]);return E},l=function(){var y="0123456789";function v(E,A,T,M){for(var S,k=[0],L,O=0,R=E.length;O<R;){for(L=k.length;L--;k[L]*=A);for(k[0]+=M.indexOf(E.charAt(O++)),S=0;S<k.length;S++)k[S]>T-1&&(k[S+1]==null&&(k[S+1]=0),k[S+1]+=k[S]/T|0,k[S]%=T)}return k.reverse()}return function(E,A,T,M,S){var k,L,O,R,Y,z,X,te,oe=E.indexOf("."),ne=p,ce=g;for(oe>=0&&(R=b,b=0,E=E.replace(".",""),te=new q(A),z=te.pow(E.length-oe),b=R,te.c=v(mt(Ze(z.c),z.e,"0"),10,T,y),te.e=te.c.length),X=v(E,A,T,S?(k=V,y):(k=y,V)),O=R=X.length;X[--R]==0;X.pop());if(!X[0])return k.charAt(0);if(oe<0?--O:(z.c=X,z.e=O,z.s=M,z=a(z,te,ne,ce,T),X=z.c,Y=z.r,O=z.e),L=O+ne+1,oe=X[L],R=T/2,Y=Y||L<0||X[L+1]!=null,Y=ce<4?(oe!=null||Y)&&(ce==0||ce==(z.s<0?3:2)):oe>R||oe==R&&(ce==4||Y||ce==6&&X[L-1]&1||ce==(z.s<0?8:7)),L<1||!X[0])E=Y?mt(k.charAt(1),-ne,k.charAt(0)):k.charAt(0);else{if(X.length=L,Y)for(--T;++X[--L]>T;)X[L]=0,L||(++O,X=[1].concat(X));for(R=X.length;!X[--R];);for(oe=0,E="";oe<=R;E+=k.charAt(X[oe++]));E=mt(E,O,k.charAt(0))}return E}}(),a=function(){function y(A,T,M){var S,k,L,O,R=0,Y=A.length,z=T%pt,X=T/pt|0;for(A=A.slice();Y--;)L=A[Y]%pt,O=A[Y]/pt|0,S=X*L+O*z,k=z*L+S%pt*pt+R,R=(k/M|0)+(S/pt|0)+X*O,A[Y]=k%M;return R&&(A=[R].concat(A)),A}function v(A,T,M,S){var k,L;if(M!=S)L=M>S?1:-1;else for(k=L=0;k<M;k++)if(A[k]!=T[k]){L=A[k]>T[k]?1:-1;break}return L}function E(A,T,M,S){for(var k=0;M--;)A[M]-=k,k=A[M]<T[M]?1:0,A[M]=k*S+A[M]-T[M];for(;!A[0]&&A.length>1;A.splice(0,1));}return function(A,T,M,S,k){var L,O,R,Y,z,X,te,oe,ne,ce,xe,Oe,F,Yt,Ee,re,I,we=A.s==T.s?1:-1,Ce=A.c,pe=T.c;if(!Ce||!Ce[0]||!pe||!pe[0])return new q(!A.s||!T.s||(Ce?pe&&Ce[0]==pe[0]:!pe)?NaN:Ce&&Ce[0]==0||!pe?we*0:we/0);for(oe=new q(we),ne=oe.c=[],O=A.e-T.e,we=M+O+1,k||(k=tt,O=Je(A.e/fe)-Je(T.e/fe),we=we/fe|0),R=0;pe[R]==(Ce[R]||0);R++);if(pe[R]>(Ce[R]||0)&&O--,we<0)ne.push(1),Y=!0;else{for(Yt=Ce.length,re=pe.length,R=0,we+=2,z=We(k/(pe[0]+1)),z>1&&(pe=y(pe,z,k),Ce=y(Ce,z,k),re=pe.length,Yt=Ce.length),F=re,ce=Ce.slice(0,re),xe=ce.length;xe<re;ce[xe++]=0);I=pe.slice(),I=[0].concat(I),Ee=pe[0],pe[1]>=k/2&&Ee++;do{if(z=0,L=v(pe,ce,re,xe),L<0){if(Oe=ce[0],re!=xe&&(Oe=Oe*k+(ce[1]||0)),z=We(Oe/Ee),z>1)for(z>=k&&(z=k-1),X=y(pe,z,k),te=X.length,xe=ce.length;v(X,ce,te,xe)==1;)z--,E(X,re<te?I:pe,te,k),te=X.length,L=1;else z==0&&(L=z=1),X=pe.slice(),te=X.length;if(te<xe&&(X=[0].concat(X)),E(ce,X,xe,k),xe=ce.length,L==-1)for(;v(pe,ce,re,xe)<1;)z++,E(ce,re<xe?I:pe,xe,k),xe=ce.length}else L===0&&(z++,ce=[0]);ne[R++]=z,ce[0]?ce[xe++]=Ce[F]||0:(ce=[Ce[F]],xe=1)}while((F++<Yt||ce[0]!=null)&&we--);Y=ce[0]!=null,ne[0]||ne.splice(0,1)}if(k==tt){for(R=1,we=ne[0];we>=10;we/=10,R++);K(oe,M+(oe.e=R+O*fe-1)+1,S,Y)}else oe.e=O,oe.r=+Y;return oe}}();function U(y,v,E,A){var T,M,S,k,L;if(E==null?E=g:Se(E,0,8),!y.c)return y.toString();if(T=y.c[0],S=y.e,v==null)L=Ze(y.c),L=A==1||A==2&&(S<=C||S>=x)?wn(L,S):mt(L,S,"0");else if(y=K(new q(y),v,E),M=y.e,L=Ze(y.c),k=L.length,A==1||A==2&&(v<=M||M<=C)){for(;k<v;L+="0",k++);L=wn(L,M)}else if(v-=S,L=mt(L,M,"0"),M+1>k){if(--v>0)for(L+=".";v--;L+="0");}else if(v+=M-k,v>0)for(M+1==k&&(L+=".");v--;L+="0");return y.s<0&&T?"-"+L:L}function j(y,v){for(var E,A,T=1,M=new q(y[0]);T<y.length;T++)A=new q(y[T]),(!A.s||(E=Lt(M,A))===v||E===0&&M.s===v)&&(M=A);return M}function W(y,v,E){for(var A=1,T=v.length;!v[--T];v.pop());for(T=v[0];T>=10;T/=10,A++);return(E=A+E*fe-1)>N?y.c=y.e=null:E<w?y.c=[y.e=0]:(y.e=E,y.c=v),y}c=function(){var y=/^(-?)0([xbo])(?=\w[\w.]*$)/i,v=/^([^.]+)\.$/,E=/^\.([^.]+)$/,A=/^-?(Infinity|NaN)$/,T=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(M,S,k,L){var O,R=k?S:S.replace(T,"");if(A.test(R))M.s=isNaN(R)?null:R<0?-1:1;else{if(!k&&(R=R.replace(y,function(Y,z,X){return O=(X=X.toLowerCase())=="x"?16:X=="b"?2:8,!L||L==O?z:Y}),L&&(O=L,R=R.replace(v,"$1").replace(E,"0.$1")),S!=R))return new q(R,O);if(q.DEBUG)throw Error(qe+"Not a"+(L?" base "+L:"")+" number: "+S);M.s=null}M.c=M.e=null}}();function K(y,v,E,A){var T,M,S,k,L,O,R,Y=y.c,z=hi;if(Y){e:{for(T=1,k=Y[0];k>=10;k/=10,T++);if(M=v-T,M<0)M+=fe,S=v,L=Y[O=0],R=We(L/z[T-S-1]%10);else if(O=li((M+1)/fe),O>=Y.length)if(A){for(;Y.length<=O;Y.push(0));L=R=0,T=1,M%=fe,S=M-fe+1}else break e;else{for(L=k=Y[O],T=1;k>=10;k/=10,T++);M%=fe,S=M-fe+T,R=S<0?0:We(L/z[T-S-1]%10)}if(A=A||v<0||Y[O+1]!=null||(S<0?L:L%z[T-S-1]),A=E<4?(R||A)&&(E==0||E==(y.s<0?3:2)):R>5||R==5&&(E==4||A||E==6&&(M>0?S>0?L/z[T-S]:0:Y[O-1])%10&1||E==(y.s<0?8:7)),v<1||!Y[0])return Y.length=0,A?(v-=y.e+1,Y[0]=z[(fe-v%fe)%fe],y.e=-v||0):Y[0]=y.e=0,y;if(M==0?(Y.length=O,k=1,O--):(Y.length=O+1,k=z[fe-M],Y[O]=S>0?We(L/z[T-S]%z[S])*k:0),A)for(;;)if(O==0){for(M=1,S=Y[0];S>=10;S/=10,M++);for(S=Y[0]+=k,k=1;S>=10;S/=10,k++);M!=k&&(y.e++,Y[0]==tt&&(Y[0]=1));break}else{if(Y[O]+=k,Y[O]!=tt)break;Y[O--]=0,k=1}for(M=Y.length;Y[--M]===0;Y.pop());}y.e>N?y.c=y.e=null:y.e<w&&(y.c=[y.e=0])}return y}function ie(y){var v,E=y.e;return E===null?y.toString():(v=Ze(y.c),v=E<=C||E>=x?wn(v,E):mt(v,E,"0"),y.s<0?"-"+v:v)}return o.absoluteValue=o.abs=function(){var y=new q(this);return y.s<0&&(y.s=1),y},o.comparedTo=function(y,v){return Lt(this,new q(y,v))},o.decimalPlaces=o.dp=function(y,v){var E,A,T,M=this;if(y!=null)return Se(y,0,Ue),v==null?v=g:Se(v,0,8),K(new q(M),y+M.e+1,v);if(!(E=M.c))return null;if(A=((T=E.length-1)-Je(this.e/fe))*fe,T=E[T])for(;T%10==0;T/=10,A--);return A<0&&(A=0),A},o.dividedBy=o.div=function(y,v){return a(this,new q(y,v),p,g)},o.dividedToIntegerBy=o.idiv=function(y,v){return a(this,new q(y,v),0,1)},o.exponentiatedBy=o.pow=function(y,v){var E,A,T,M,S,k,L,O,R,Y=this;if(y=new q(y),y.c&&!y.isInteger())throw Error(qe+"Exponent not an integer: "+ie(y));if(v!=null&&(v=new q(v)),k=y.e>14,!Y.c||!Y.c[0]||Y.c[0]==1&&!Y.e&&Y.c.length==1||!y.c||!y.c[0])return R=new q(Math.pow(+ie(Y),k?y.s*(2-Nn(y)):+ie(y))),v?R.mod(v):R;if(L=y.s<0,v){if(v.c?!v.c[0]:!v.s)return new q(NaN);A=!L&&Y.isInteger()&&v.isInteger(),A&&(Y=Y.mod(v))}else{if(y.e>9&&(Y.e>0||Y.e<-1||(Y.e==0?Y.c[0]>1||k&&Y.c[1]>=24e7:Y.c[0]<8e13||k&&Y.c[0]<=9999975e7)))return M=Y.s<0&&Nn(y)?-0:0,Y.e>-1&&(M=1/M),new q(L?1/M:M);b&&(M=li(b/fe+2))}for(k?(E=new q(.5),L&&(y.s=1),O=Nn(y)):(T=Math.abs(+ie(y)),O=T%2),R=new q(d);;){if(O){if(R=R.times(Y),!R.c)break;M?R.c.length>M&&(R.c.length=M):A&&(R=R.mod(v))}if(T){if(T=We(T/2),T===0)break;O=T%2}else if(y=y.times(E),K(y,y.e+1,1),y.e>14)O=Nn(y);else{if(T=+ie(y),T===0)break;O=T%2}Y=Y.times(Y),M?Y.c&&Y.c.length>M&&(Y.c.length=M):A&&(Y=Y.mod(v))}return A?R:(L&&(R=d.div(R)),v?R.mod(v):M?K(R,b,g,S):R)},o.integerValue=function(y){var v=new q(this);return y==null?y=g:Se(y,0,8),K(v,v.e+1,y)},o.isEqualTo=o.eq=function(y,v){return Lt(this,new q(y,v))===0},o.isFinite=function(){return!!this.c},o.isGreaterThan=o.gt=function(y,v){return Lt(this,new q(y,v))>0},o.isGreaterThanOrEqualTo=o.gte=function(y,v){return(v=Lt(this,new q(y,v)))===1||v===0},o.isInteger=function(){return!!this.c&&Je(this.e/fe)>this.c.length-2},o.isLessThan=o.lt=function(y,v){return Lt(this,new q(y,v))<0},o.isLessThanOrEqualTo=o.lte=function(y,v){return(v=Lt(this,new q(y,v)))===-1||v===0},o.isNaN=function(){return!this.s},o.isNegative=function(){return this.s<0},o.isPositive=function(){return this.s>0},o.isZero=function(){return!!this.c&&this.c[0]==0},o.minus=function(y,v){var E,A,T,M,S=this,k=S.s;if(y=new q(y,v),v=y.s,!k||!v)return new q(NaN);if(k!=v)return y.s=-v,S.plus(y);var L=S.e/fe,O=y.e/fe,R=S.c,Y=y.c;if(!L||!O){if(!R||!Y)return R?(y.s=-v,y):new q(Y?S:NaN);if(!R[0]||!Y[0])return Y[0]?(y.s=-v,y):new q(R[0]?S:g==3?-0:0)}if(L=Je(L),O=Je(O),R=R.slice(),k=L-O){for((M=k<0)?(k=-k,T=R):(O=L,T=Y),T.reverse(),v=k;v--;T.push(0));T.reverse()}else for(A=(M=(k=R.length)<(v=Y.length))?k:v,k=v=0;v<A;v++)if(R[v]!=Y[v]){M=R[v]<Y[v];break}if(M&&(T=R,R=Y,Y=T,y.s=-y.s),v=(A=Y.length)-(E=R.length),v>0)for(;v--;R[E++]=0);for(v=tt-1;A>k;){if(R[--A]<Y[A]){for(E=A;E&&!R[--E];R[E]=v);--R[E],R[A]+=tt}R[A]-=Y[A]}for(;R[0]==0;R.splice(0,1),--O);return R[0]?W(y,R,O):(y.s=g==3?-1:1,y.c=[y.e=0],y)},o.modulo=o.mod=function(y,v){var E,A,T=this;return y=new q(y,v),!T.c||!y.s||y.c&&!y.c[0]?new q(NaN):!y.c||T.c&&!T.c[0]?new q(T):(B==9?(A=y.s,y.s=1,E=a(T,y,0,3),y.s=A,E.s*=A):E=a(T,y,0,B),y=T.minus(E.times(y)),!y.c[0]&&B==1&&(y.s=T.s),y)},o.multipliedBy=o.times=function(y,v){var E,A,T,M,S,k,L,O,R,Y,z,X,te,oe,ne,ce=this,xe=ce.c,Oe=(y=new q(y,v)).c;if(!xe||!Oe||!xe[0]||!Oe[0])return!ce.s||!y.s||xe&&!xe[0]&&!Oe||Oe&&!Oe[0]&&!xe?y.c=y.e=y.s=null:(y.s*=ce.s,!xe||!Oe?y.c=y.e=null:(y.c=[0],y.e=0)),y;for(A=Je(ce.e/fe)+Je(y.e/fe),y.s*=ce.s,L=xe.length,Y=Oe.length,L<Y&&(te=xe,xe=Oe,Oe=te,T=L,L=Y,Y=T),T=L+Y,te=[];T--;te.push(0));for(oe=tt,ne=pt,T=Y;--T>=0;){for(E=0,z=Oe[T]%ne,X=Oe[T]/ne|0,S=L,M=T+S;M>T;)O=xe[--S]%ne,R=xe[S]/ne|0,k=X*O+R*z,O=z*O+k%ne*ne+te[M]+E,E=(O/oe|0)+(k/ne|0)+X*R,te[M--]=O%oe;te[M]=E}return E?++A:te.splice(0,1),W(y,te,A)},o.negated=function(){var y=new q(this);return y.s=-y.s||null,y},o.plus=function(y,v){var E,A=this,T=A.s;if(y=new q(y,v),v=y.s,!T||!v)return new q(NaN);if(T!=v)return y.s=-v,A.minus(y);var M=A.e/fe,S=y.e/fe,k=A.c,L=y.c;if(!M||!S){if(!k||!L)return new q(T/0);if(!k[0]||!L[0])return L[0]?y:new q(k[0]?A:T*0)}if(M=Je(M),S=Je(S),k=k.slice(),T=M-S){for(T>0?(S=M,E=L):(T=-T,E=k),E.reverse();T--;E.push(0));E.reverse()}for(T=k.length,v=L.length,T-v<0&&(E=L,L=k,k=E,v=T),T=0;v;)T=(k[--v]=k[v]+L[v]+T)/tt|0,k[v]=tt===k[v]?0:k[v]%tt;return T&&(k=[T].concat(k),++S),W(y,k,S)},o.precision=o.sd=function(y,v){var E,A,T,M=this;if(y!=null&&y!==!!y)return Se(y,1,Ue),v==null?v=g:Se(v,0,8),K(new q(M),y,v);if(!(E=M.c))return null;if(T=E.length-1,A=T*fe+1,T=E[T]){for(;T%10==0;T/=10,A--);for(T=E[0];T>=10;T/=10,A++);}return y&&M.e+1>A&&(A=M.e+1),A},o.shiftedBy=function(y){return Se(y,-9007199254740991,qr),this.times("1e"+y)},o.squareRoot=o.sqrt=function(){var y,v,E,A,T,M=this,S=M.c,k=M.s,L=M.e,O=p+4,R=new q("0.5");if(k!==1||!S||!S[0])return new q(!k||k<0&&(!S||S[0])?NaN:S?M:1/0);if(k=Math.sqrt(+ie(M)),k==0||k==1/0?(v=Ze(S),(v.length+L)%2==0&&(v+="0"),k=Math.sqrt(+v),L=Je((L+1)/2)-(L<0||L%2),k==1/0?v="5e"+L:(v=k.toExponential(),v=v.slice(0,v.indexOf("e")+1)+L),E=new q(v)):E=new q(k+""),E.c[0]){for(L=E.e,k=L+O,k<3&&(k=0);;)if(T=E,E=R.times(T.plus(a(M,T,O,1))),Ze(T.c).slice(0,k)===(v=Ze(E.c)).slice(0,k))if(E.e<L&&--k,v=v.slice(k-3,k+1),v=="9999"||!A&&v=="4999"){if(!A&&(K(T,T.e+p+2,0),T.times(T).eq(M))){E=T;break}O+=4,k+=4,A=1}else{(!+v||!+v.slice(1)&&v.charAt(0)=="5")&&(K(E,E.e+p+2,1),y=!E.times(E).eq(M));break}}return K(E,E.e+p+1,g,y)},o.toExponential=function(y,v){return y!=null&&(Se(y,0,Ue),y++),U(this,y,v,1)},o.toFixed=function(y,v){return y!=null&&(Se(y,0,Ue),y=y+this.e+1),U(this,y,v)},o.toFormat=function(y,v,E){var A,T=this;if(E==null)y!=null&&v&&typeof v=="object"?(E=v,v=null):y&&typeof y=="object"?(E=y,y=v=null):E=Z;else if(typeof E!="object")throw Error(qe+"Argument not an object: "+E);if(A=T.toFixed(y,v),T.c){var M,S=A.split("."),k=+E.groupSize,L=+E.secondaryGroupSize,O=E.groupSeparator||"",R=S[0],Y=S[1],z=T.s<0,X=z?R.slice(1):R,te=X.length;if(L&&(M=k,k=L,L=M,te-=M),k>0&&te>0){for(M=te%k||k,R=X.substr(0,M);M<te;M+=k)R+=O+X.substr(M,k);L>0&&(R+=O+X.slice(M)),z&&(R="-"+R)}A=Y?R+(E.decimalSeparator||"")+((L=+E.fractionGroupSize)?Y.replace(new RegExp("\\d{"+L+"}\\B","g"),"$&"+(E.fractionGroupSeparator||"")):Y):R}return(E.prefix||"")+A+(E.suffix||"")},o.toFraction=function(y){var v,E,A,T,M,S,k,L,O,R,Y,z,X=this,te=X.c;if(y!=null&&(k=new q(y),!k.isInteger()&&(k.c||k.s!==1)||k.lt(d)))throw Error(qe+"Argument "+(k.isInteger()?"out of range: ":"not an integer: ")+ie(k));if(!te)return new q(X);for(v=new q(d),O=E=new q(d),A=L=new q(d),z=Ze(te),M=v.e=z.length-X.e-1,v.c[0]=hi[(S=M%fe)<0?fe+S:S],y=!y||k.comparedTo(v)>0?M>0?v:O:k,S=N,N=1/0,k=new q(z),L.c[0]=0;R=a(k,v,0,1),T=E.plus(R.times(A)),T.comparedTo(y)!=1;)E=A,A=T,O=L.plus(R.times(T=O)),L=T,v=k.minus(R.times(T=v)),k=T;return T=a(y.minus(E),A,0,1),L=L.plus(T.times(O)),E=E.plus(T.times(A)),L.s=O.s=X.s,M=M*2,Y=a(O,A,M,g).minus(X).abs().comparedTo(a(L,E,M,g).minus(X).abs())<1?[O,A]:[L,E],N=S,Y},o.toNumber=function(){return+ie(this)},o.toPrecision=function(y,v){return y!=null&&Se(y,1,Ue),U(this,y,v,2)},o.toString=function(y){var v,E=this,A=E.s,T=E.e;return T===null?A?(v="Infinity",A<0&&(v="-"+v)):v="NaN":(y==null?v=T<=C||T>=x?wn(Ze(E.c),T):mt(Ze(E.c),T,"0"):y===10&&ee?(E=K(new q(E),p+T+1,g),v=mt(Ze(E.c),E.e,"0")):(Se(y,2,V.length,"Base"),v=l(mt(Ze(E.c),T,"0"),10,y,A,!0)),A<0&&E.c[0]&&(v="-"+v)),v},o.valueOf=o.toJSON=function(){return ie(this)},o._isBigNumber=!0,o[Symbol.toStringTag]="BigNumber",o[Symbol.for("nodejs.util.inspect.custom")]=o.valueOf,u!=null&&q.set(u),q}function Je(u){var a=u|0;return u>0||u===a?a:a-1}function Ze(u){for(var a,l,c=1,o=u.length,d=u[0]+"";c<o;){for(a=u[c++]+"",l=fe-a.length;l--;a="0"+a);d+=a}for(o=d.length;d.charCodeAt(--o)===48;);return d.slice(0,o+1||1)}function Lt(u,a){var l,c,o=u.c,d=a.c,p=u.s,g=a.s,C=u.e,x=a.e;if(!p||!g)return null;if(l=o&&!o[0],c=d&&!d[0],l||c)return l?c?0:-g:p;if(p!=g)return p;if(l=p<0,c=C==x,!o||!d)return c?0:!o^l?1:-1;if(!c)return C>x^l?1:-1;for(g=(C=o.length)<(x=d.length)?C:x,p=0;p<g;p++)if(o[p]!=d[p])return o[p]>d[p]^l?1:-1;return C==x?0:C>x^l?1:-1}function Se(u,a,l,c){if(u<a||u>l||u!==We(u))throw Error(qe+(c||"Argument")+(typeof u=="number"?u<a||u>l?" out of range: ":" not an integer: ":" not a primitive number: ")+String(u))}function Nn(u){var a=u.c.length-1;return Je(u.e/fe)==a&&u.c[a]%2!=0}function wn(u,a){return(u.length>1?u.charAt(0)+"."+u.slice(1):u)+(a<0?"e":"e+")+a}function mt(u,a,l){var c,o;if(a<0){for(o=l+".";++a;o+=l);u=o+u}else if(c=u.length,++a>c){for(o=l,a-=c;--a;o+=l);u+=o}else a<c&&(u=u.slice(0,a)+"."+u.slice(a));return u}var lt=cs(),po=class{key;left=null;right=null;constructor(u){this.key=u}},Qt=class extends po{constructor(u){super(u)}},_o=class{size=0;modificationCount=0;splayCount=0;splay(u){const a=this.root;if(a==null)return this.compare(u,u),-1;let l=null,c=null,o=null,d=null,p=a;const g=this.compare;let C;for(;;)if(C=g(p.key,u),C>0){let x=p.left;if(x==null||(C=g(x.key,u),C>0&&(p.left=x.right,x.right=p,p=x,x=p.left,x==null)))break;l==null?c=p:l.left=p,l=p,p=x}else if(C<0){let x=p.right;if(x==null||(C=g(x.key,u),C<0&&(p.right=x.left,x.left=p,p=x,x=p.right,x==null)))break;o==null?d=p:o.right=p,o=p,p=x}else break;return o!=null&&(o.right=p.left,p.left=d),l!=null&&(l.left=p.right,p.right=c),this.root!==p&&(this.root=p,this.splayCount++),C}splayMin(u){let a=u,l=a.left;for(;l!=null;){const c=l;a.left=c.right,c.right=a,a=c,l=a.left}return a}splayMax(u){let a=u,l=a.right;for(;l!=null;){const c=l;a.right=c.left,c.left=a,a=c,l=a.right}return a}_delete(u){if(this.root==null||this.splay(u)!=0)return null;let l=this.root;const c=l,o=l.left;if(this.size--,o==null)this.root=l.right;else{const d=l.right;l=this.splayMax(o),l.right=d,this.root=l}return this.modificationCount++,c}addNewRoot(u,a){this.size++,this.modificationCount++;const l=this.root;if(l==null){this.root=u;return}a<0?(u.left=l,u.right=l.right,l.right=null):(u.right=l,u.left=l.left,l.left=null),this.root=u}_first(){const u=this.root;return u==null?null:(this.root=this.splayMin(u),this.root)}_last(){const u=this.root;return u==null?null:(this.root=this.splayMax(u),this.root)}clear(){this.root=null,this.size=0,this.modificationCount++}has(u){return this.validKey(u)&&this.splay(u)==0}defaultCompare(){return(u,a)=>u<a?-1:u>a?1:0}wrap(){return{getRoot:()=>this.root,setRoot:u=>{this.root=u},getSize:()=>this.size,getModificationCount:()=>this.modificationCount,getSplayCount:()=>this.splayCount,setSplayCount:u=>{this.splayCount=u},splay:u=>this.splay(u),has:u=>this.has(u)}}},Fn=class nn extends _o{root=null;compare;validKey;constructor(a,l){super(),this.compare=a??this.defaultCompare(),this.validKey=l??(c=>c!=null&&c!=null)}delete(a){return this.validKey(a)?this._delete(a)!=null:!1}deleteAll(a){for(const l of a)this.delete(l)}forEach(a){const l=this[Symbol.iterator]();let c;for(;c=l.next(),!c.done;)a(c.value,c.value,this)}add(a){const l=this.splay(a);return l!=0&&this.addNewRoot(new Qt(a),l),this}addAndReturn(a){const l=this.splay(a);return l!=0&&this.addNewRoot(new Qt(a),l),this.root.key}addAll(a){for(const l of a)this.add(l)}isEmpty(){return this.root==null}isNotEmpty(){return this.root!=null}single(){if(this.size==0)throw"Bad state: No element";if(this.size>1)throw"Bad state: Too many element";return this.root.key}first(){if(this.size==0)throw"Bad state: No element";return this._first().key}last(){if(this.size==0)throw"Bad state: No element";return this._last().key}lastBefore(a){if(a==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(a)<0)return this.root.key;let c=this.root.left;if(c==null)return null;let o=c.right;for(;o!=null;)c=o,o=c.right;return c.key}firstAfter(a){if(a==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(a)>0)return this.root.key;let c=this.root.right;if(c==null)return null;let o=c.left;for(;o!=null;)c=o,o=c.left;return c.key}retainAll(a){const l=new nn(this.compare,this.validKey),c=this.modificationCount;for(const o of a){if(c!=this.modificationCount)throw"Concurrent modification during iteration.";this.validKey(o)&&this.splay(o)==0&&l.add(this.root.key)}l.size!=this.size&&(this.root=l.root,this.size=l.size,this.modificationCount++)}lookup(a){return!this.validKey(a)||this.splay(a)!=0?null:this.root.key}intersection(a){const l=new nn(this.compare,this.validKey);for(const c of this)a.has(c)&&l.add(c);return l}difference(a){const l=new nn(this.compare,this.validKey);for(const c of this)a.has(c)||l.add(c);return l}union(a){const l=this.clone();return l.addAll(a),l}clone(){const a=new nn(this.compare,this.validKey);return a.size=this.size,a.root=this.copyNode(this.root),a}copyNode(a){if(a==null)return null;function l(o,d){let p,g;do{if(p=o.left,g=o.right,p!=null){const C=new Qt(p.key);d.left=C,l(p,C)}if(g!=null){const C=new Qt(g.key);d.right=C,o=g,d=C}}while(g!=null)}const c=new Qt(a.key);return l(a,c),c}toSet(){return this.clone()}entries(){return new Eo(this.wrap())}keys(){return this[Symbol.iterator]()}values(){return this[Symbol.iterator]()}[Symbol.iterator](){return new xo(this.wrap())}[Symbol.toStringTag]="[object Set]"},fs=class{tree;path=new Array;modificationCount=null;splayCount;constructor(u){this.tree=u,this.splayCount=u.getSplayCount()}[Symbol.iterator](){return this}next(){return this.moveNext()?{done:!1,value:this.current()}:{done:!0,value:null}}current(){if(!this.path.length)return null;const u=this.path[this.path.length-1];return this.getValue(u)}rebuildPath(u){this.path.splice(0,this.path.length),this.tree.splay(u),this.path.push(this.tree.getRoot()),this.splayCount=this.tree.getSplayCount()}findLeftMostDescendent(u){for(;u!=null;)this.path.push(u),u=u.left}moveNext(){if(this.modificationCount!=this.tree.getModificationCount()){if(this.modificationCount==null){this.modificationCount=this.tree.getModificationCount();let l=this.tree.getRoot();for(;l!=null;)this.path.push(l),l=l.left;return this.path.length>0}throw"Concurrent modification during iteration."}if(!this.path.length)return!1;this.splayCount!=this.tree.getSplayCount()&&this.rebuildPath(this.path[this.path.length-1].key);let u=this.path[this.path.length-1],a=u.right;if(a!=null){for(;a!=null;)this.path.push(a),a=a.left;return!0}for(this.path.pop();this.path.length&&this.path[this.path.length-1].right===u;)u=this.path.pop();return this.path.length>0}},xo=class extends fs{getValue(u){return u.key}},Eo=class extends fs{getValue(u){return[u.key,u.key]}},gs=u=>()=>u,vi=u=>{const a=u?(l,c)=>c.minus(l).abs().isLessThanOrEqualTo(u):gs(!1);return(l,c)=>a(l,c)?0:l.comparedTo(c)};function ko(u){const a=u?(l,c,o,d,p)=>l.exponentiatedBy(2).isLessThanOrEqualTo(d.minus(c).exponentiatedBy(2).plus(p.minus(o).exponentiatedBy(2)).times(u)):gs(!1);return(l,c,o)=>{const d=l.x,p=l.y,g=o.x,C=o.y,x=p.minus(C).times(c.x.minus(g)).minus(d.minus(g).times(c.y.minus(C)));return a(x,d,p,g,C)?0:x.comparedTo(0)}}var Io=u=>u,No=u=>{if(u){const a=new Fn(vi(u)),l=new Fn(vi(u)),c=(d,p)=>p.addAndReturn(d),o=d=>({x:c(d.x,a),y:c(d.y,l)});return o({x:new lt(0),y:new lt(0)}),o}return Io},pi=u=>({set:a=>{yt=pi(a)},reset:()=>pi(u),compare:vi(u),snap:No(u),orient:ko(u)}),yt=pi(),en=(u,a)=>u.ll.x.isLessThanOrEqualTo(a.x)&&a.x.isLessThanOrEqualTo(u.ur.x)&&u.ll.y.isLessThanOrEqualTo(a.y)&&a.y.isLessThanOrEqualTo(u.ur.y),_i=(u,a)=>{if(a.ur.x.isLessThan(u.ll.x)||u.ur.x.isLessThan(a.ll.x)||a.ur.y.isLessThan(u.ll.y)||u.ur.y.isLessThan(a.ll.y))return null;const l=u.ll.x.isLessThan(a.ll.x)?a.ll.x:u.ll.x,c=u.ur.x.isLessThan(a.ur.x)?u.ur.x:a.ur.x,o=u.ll.y.isLessThan(a.ll.y)?a.ll.y:u.ll.y,d=u.ur.y.isLessThan(a.ur.y)?u.ur.y:a.ur.y;return{ll:{x:l,y:o},ur:{x:c,y:d}}},Rn=(u,a)=>u.x.times(a.y).minus(u.y.times(a.x)),ms=(u,a)=>u.x.times(a.x).plus(u.y.times(a.y)),Gn=u=>ms(u,u).sqrt(),wo=(u,a,l)=>{const c={x:a.x.minus(u.x),y:a.y.minus(u.y)},o={x:l.x.minus(u.x),y:l.y.minus(u.y)};return Rn(o,c).div(Gn(o)).div(Gn(c))},So=(u,a,l)=>{const c={x:a.x.minus(u.x),y:a.y.minus(u.y)},o={x:l.x.minus(u.x),y:l.y.minus(u.y)};return ms(o,c).div(Gn(o)).div(Gn(c))},Br=(u,a,l)=>a.y.isZero()?null:{x:u.x.plus(a.x.div(a.y).times(l.minus(u.y))),y:l},zr=(u,a,l)=>a.x.isZero()?null:{x:l,y:u.y.plus(a.y.div(a.x).times(l.minus(u.x)))},To=(u,a,l,c)=>{if(a.x.isZero())return zr(l,c,u.x);if(c.x.isZero())return zr(u,a,l.x);if(a.y.isZero())return Br(l,c,u.y);if(c.y.isZero())return Br(u,a,l.y);const o=Rn(a,c);if(o.isZero())return null;const d={x:l.x.minus(u.x),y:l.y.minus(u.y)},p=Rn(d,a).div(o),g=Rn(d,c).div(o),C=u.x.plus(g.times(a.x)),x=l.x.plus(p.times(c.x)),w=u.y.plus(g.times(a.y)),N=l.y.plus(p.times(c.y)),D=C.plus(x).div(2),B=w.plus(N).div(2);return{x:D,y:B}},ot=class ys{point;isLeft;segment;otherSE;consumedBy;static compare(a,l){const c=ys.comparePoints(a.point,l.point);return c!==0?c:(a.point!==l.point&&a.link(l),a.isLeft!==l.isLeft?a.isLeft?1:-1:qn.compare(a.segment,l.segment))}static comparePoints(a,l){return a.x.isLessThan(l.x)?-1:a.x.isGreaterThan(l.x)?1:a.y.isLessThan(l.y)?-1:a.y.isGreaterThan(l.y)?1:0}constructor(a,l){a.events===void 0?a.events=[this]:a.events.push(this),this.point=a,this.isLeft=l}link(a){if(a.point===this.point)throw new Error("Tried to link already linked events");const l=a.point.events;for(let c=0,o=l.length;c<o;c++){const d=l[c];this.point.events.push(d),d.point=this.point}this.checkForConsuming()}checkForConsuming(){const a=this.point.events.length;for(let l=0;l<a;l++){const c=this.point.events[l];if(c.segment.consumedBy===void 0)for(let o=l+1;o<a;o++){const d=this.point.events[o];d.consumedBy===void 0&&c.otherSE.point.events===d.otherSE.point.events&&c.segment.consume(d.segment)}}}getAvailableLinkedEvents(){const a=[];for(let l=0,c=this.point.events.length;l<c;l++){const o=this.point.events[l];o!==this&&!o.segment.ringOut&&o.segment.isInResult()&&a.push(o)}return a}getLeftmostComparator(a){const l=new Map,c=o=>{const d=o.otherSE;l.set(o,{sine:wo(this.point,a.point,d.point),cosine:So(this.point,a.point,d.point)})};return(o,d)=>{l.has(o)||c(o),l.has(d)||c(d);const{sine:p,cosine:g}=l.get(o),{sine:C,cosine:x}=l.get(d);return p.isGreaterThanOrEqualTo(0)&&C.isGreaterThanOrEqualTo(0)?g.isLessThan(x)?1:g.isGreaterThan(x)?-1:0:p.isLessThan(0)&&C.isLessThan(0)?g.isLessThan(x)?-1:g.isGreaterThan(x)?1:0:C.isLessThan(p)?-1:C.isGreaterThan(p)?1:0}}},Lo=class xi{events;poly;_isExteriorRing;_enclosingRing;static factory(a){const l=[];for(let c=0,o=a.length;c<o;c++){const d=a[c];if(!d.isInResult()||d.ringOut)continue;let p=null,g=d.leftSE,C=d.rightSE;const x=[g],w=g.point,N=[];for(;p=g,g=C,x.push(g),g.point!==w;)for(;;){const D=g.getAvailableLinkedEvents();if(D.length===0){const Z=x[0].point,V=x[x.length-1].point;throw new Error(`Unable to complete output ring starting at [${Z.x}, ${Z.y}]. Last matching segment found ends at [${V.x}, ${V.y}].`)}if(D.length===1){C=D[0].otherSE;break}let B=null;for(let Z=0,V=N.length;Z<V;Z++)if(N[Z].point===g.point){B=Z;break}if(B!==null){const Z=N.splice(B)[0],V=x.splice(Z.index);V.unshift(V[0].otherSE),l.push(new xi(V.reverse()));continue}N.push({index:x.length,point:g.point});const b=g.getLeftmostComparator(p);C=D.sort(b)[0].otherSE;break}l.push(new xi(x))}return l}constructor(a){this.events=a;for(let l=0,c=a.length;l<c;l++)a[l].segment.ringOut=this;this.poly=null}getGeom(){let a=this.events[0].point;const l=[a];for(let x=1,w=this.events.length-1;x<w;x++){const N=this.events[x].point,D=this.events[x+1].point;yt.orient(N,a,D)!==0&&(l.push(N),a=N)}if(l.length===1)return null;const c=l[0],o=l[1];yt.orient(c,a,o)===0&&l.shift(),l.push(l[0]);const d=this.isExteriorRing()?1:-1,p=this.isExteriorRing()?0:l.length-1,g=this.isExteriorRing()?l.length:-1,C=[];for(let x=p;x!=g;x+=d)C.push([l[x].x.toNumber(),l[x].y.toNumber()]);return C}isExteriorRing(){if(this._isExteriorRing===void 0){const a=this.enclosingRing();this._isExteriorRing=a?!a.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){let a=this.events[0];for(let o=1,d=this.events.length;o<d;o++){const p=this.events[o];ot.compare(a,p)>0&&(a=p)}let l=a.segment.prevInResult(),c=l?l.prevInResult():null;for(;;){if(!l)return null;if(!c)return l.ringOut;if(c.ringOut!==l.ringOut)return c.ringOut?.enclosingRing()!==l.ringOut?l.ringOut:l.ringOut?.enclosingRing();l=c.prevInResult(),c=l?l.prevInResult():null}}},Yr=class{exteriorRing;interiorRings;constructor(u){this.exteriorRing=u,u.poly=this,this.interiorRings=[]}addInterior(u){this.interiorRings.push(u),u.poly=this}getGeom(){const u=this.exteriorRing.getGeom();if(u===null)return null;const a=[u];for(let l=0,c=this.interiorRings.length;l<c;l++){const o=this.interiorRings[l].getGeom();o!==null&&a.push(o)}return a}},Co=class{rings;polys;constructor(u){this.rings=u,this.polys=this._composePolys(u)}getGeom(){const u=[];for(let a=0,l=this.polys.length;a<l;a++){const c=this.polys[a].getGeom();c!==null&&u.push(c)}return u}_composePolys(u){const a=[];for(let l=0,c=u.length;l<c;l++){const o=u[l];if(!o.poly)if(o.isExteriorRing())a.push(new Yr(o));else{const d=o.enclosingRing();d?.poly||a.push(new Yr(d)),d?.poly?.addInterior(o)}}return a}},Ro=class{queue;tree;segments;constructor(u,a=qn.compare){this.queue=u,this.tree=new Fn(a),this.segments=[]}process(u){const a=u.segment,l=[];if(u.consumedBy)return u.isLeft?this.queue.delete(u.otherSE):this.tree.delete(a),l;u.isLeft&&this.tree.add(a);let c=a,o=a;do c=this.tree.lastBefore(c);while(c!=null&&c.consumedBy!=null);do o=this.tree.firstAfter(o);while(o!=null&&o.consumedBy!=null);if(u.isLeft){let d=null;if(c){const g=c.getIntersection(a);if(g!==null&&(a.isAnEndpoint(g)||(d=g),!c.isAnEndpoint(g))){const C=this._splitSafely(c,g);for(let x=0,w=C.length;x<w;x++)l.push(C[x])}}let p=null;if(o){const g=o.getIntersection(a);if(g!==null&&(a.isAnEndpoint(g)||(p=g),!o.isAnEndpoint(g))){const C=this._splitSafely(o,g);for(let x=0,w=C.length;x<w;x++)l.push(C[x])}}if(d!==null||p!==null){let g=null;d===null?g=p:p===null?g=d:g=ot.comparePoints(d,p)<=0?d:p,this.queue.delete(a.rightSE),l.push(a.rightSE);const C=a.split(g);for(let x=0,w=C.length;x<w;x++)l.push(C[x])}l.length>0?(this.tree.delete(a),l.push(u)):(this.segments.push(a),a.prev=c)}else{if(c&&o){const d=c.getIntersection(o);if(d!==null){if(!c.isAnEndpoint(d)){const p=this._splitSafely(c,d);for(let g=0,C=p.length;g<C;g++)l.push(p[g])}if(!o.isAnEndpoint(d)){const p=this._splitSafely(o,d);for(let g=0,C=p.length;g<C;g++)l.push(p[g])}}}this.tree.delete(a)}return l}_splitSafely(u,a){this.tree.delete(u);const l=u.rightSE;this.queue.delete(l);const c=u.split(a);return c.push(l),u.consumedBy===void 0&&this.tree.add(u),c}},Oo=class{type;numMultiPolys;run(u,a,l){rn.type=u;const c=[new Xr(a,!0)];for(let x=0,w=l.length;x<w;x++)c.push(new Xr(l[x],!1));if(rn.numMultiPolys=c.length,rn.type==="difference"){const x=c[0];let w=1;for(;w<c.length;)_i(c[w].bbox,x.bbox)!==null?w++:c.splice(w,1)}if(rn.type==="intersection")for(let x=0,w=c.length;x<w;x++){const N=c[x];for(let D=x+1,B=c.length;D<B;D++)if(_i(N.bbox,c[D].bbox)===null)return[]}const o=new Fn(ot.compare);for(let x=0,w=c.length;x<w;x++){const N=c[x].getSweepEvents();for(let D=0,B=N.length;D<B;D++)o.add(N[D])}const d=new Ro(o);let p=null;for(o.size!=0&&(p=o.first(),o.delete(p));p;){const x=d.process(p);for(let w=0,N=x.length;w<N;w++){const D=x[w];D.consumedBy===void 0&&o.add(D)}o.size!=0?(p=o.first(),o.delete(p)):p=null}yt.reset();const g=Lo.factory(d.segments);return new Co(g).getGeom()}},rn=new Oo,Ei=rn,bo=0,qn=class On{id;leftSE;rightSE;rings;windings;ringOut;consumedBy;prev;_prevInResult;_beforeState;_afterState;_isInResult;static compare(a,l){const c=a.leftSE.point.x,o=l.leftSE.point.x,d=a.rightSE.point.x,p=l.rightSE.point.x;if(p.isLessThan(c))return 1;if(d.isLessThan(o))return-1;const g=a.leftSE.point.y,C=l.leftSE.point.y,x=a.rightSE.point.y,w=l.rightSE.point.y;if(c.isLessThan(o)){if(C.isLessThan(g)&&C.isLessThan(x))return 1;if(C.isGreaterThan(g)&&C.isGreaterThan(x))return-1;const N=a.comparePoint(l.leftSE.point);if(N<0)return 1;if(N>0)return-1;const D=l.comparePoint(a.rightSE.point);return D!==0?D:-1}if(c.isGreaterThan(o)){if(g.isLessThan(C)&&g.isLessThan(w))return-1;if(g.isGreaterThan(C)&&g.isGreaterThan(w))return 1;const N=l.comparePoint(a.leftSE.point);if(N!==0)return N;const D=a.comparePoint(l.rightSE.point);return D<0?1:D>0?-1:1}if(g.isLessThan(C))return-1;if(g.isGreaterThan(C))return 1;if(d.isLessThan(p)){const N=l.comparePoint(a.rightSE.point);if(N!==0)return N}if(d.isGreaterThan(p)){const N=a.comparePoint(l.rightSE.point);if(N<0)return 1;if(N>0)return-1}if(!d.eq(p)){const N=x.minus(g),D=d.minus(c),B=w.minus(C),b=p.minus(o);if(N.isGreaterThan(D)&&B.isLessThan(b))return 1;if(N.isLessThan(D)&&B.isGreaterThan(b))return-1}return d.isGreaterThan(p)?1:d.isLessThan(p)||x.isLessThan(w)?-1:x.isGreaterThan(w)?1:a.id<l.id?-1:a.id>l.id?1:0}constructor(a,l,c,o){this.id=++bo,this.leftSE=a,a.segment=this,a.otherSE=l,this.rightSE=l,l.segment=this,l.otherSE=a,this.rings=c,this.windings=o}static fromRing(a,l,c){let o,d,p;const g=ot.comparePoints(a,l);if(g<0)o=a,d=l,p=1;else if(g>0)o=l,d=a,p=-1;else throw new Error(`Tried to create degenerate segment at [${a.x}, ${a.y}]`);const C=new ot(o,!0),x=new ot(d,!1);return new On(C,x,[c],[p])}replaceRightSE(a){this.rightSE=a,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){const a=this.leftSE.point.y,l=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:a.isLessThan(l)?a:l},ur:{x:this.rightSE.point.x,y:a.isGreaterThan(l)?a:l}}}vector(){return{x:this.rightSE.point.x.minus(this.leftSE.point.x),y:this.rightSE.point.y.minus(this.leftSE.point.y)}}isAnEndpoint(a){return a.x.eq(this.leftSE.point.x)&&a.y.eq(this.leftSE.point.y)||a.x.eq(this.rightSE.point.x)&&a.y.eq(this.rightSE.point.y)}comparePoint(a){return yt.orient(this.leftSE.point,a,this.rightSE.point)}getIntersection(a){const l=this.bbox(),c=a.bbox(),o=_i(l,c);if(o===null)return null;const d=this.leftSE.point,p=this.rightSE.point,g=a.leftSE.point,C=a.rightSE.point,x=en(l,g)&&this.comparePoint(g)===0,w=en(c,d)&&a.comparePoint(d)===0,N=en(l,C)&&this.comparePoint(C)===0,D=en(c,p)&&a.comparePoint(p)===0;if(w&&x)return D&&!N?p:!D&&N?C:null;if(w)return N&&d.x.eq(C.x)&&d.y.eq(C.y)?null:d;if(x)return D&&p.x.eq(g.x)&&p.y.eq(g.y)?null:g;if(D&&N)return null;if(D)return p;if(N)return C;const B=To(d,this.vector(),g,a.vector());return B===null||!en(o,B)?null:yt.snap(B)}split(a){const l=[],c=a.events!==void 0,o=new ot(a,!0),d=new ot(a,!1),p=this.rightSE;this.replaceRightSE(d),l.push(d),l.push(o);const g=new On(o,p,this.rings.slice(),this.windings.slice());return ot.comparePoints(g.leftSE.point,g.rightSE.point)>0&&g.swapEvents(),ot.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),c&&(o.checkForConsuming(),d.checkForConsuming()),l}swapEvents(){const a=this.rightSE;this.rightSE=this.leftSE,this.leftSE=a,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let l=0,c=this.windings.length;l<c;l++)this.windings[l]*=-1}consume(a){let l=this,c=a;for(;l.consumedBy;)l=l.consumedBy;for(;c.consumedBy;)c=c.consumedBy;const o=On.compare(l,c);if(o!==0){if(o>0){const d=l;l=c,c=d}if(l.prev===c){const d=l;l=c,c=d}for(let d=0,p=c.rings.length;d<p;d++){const g=c.rings[d],C=c.windings[d],x=l.rings.indexOf(g);x===-1?(l.rings.push(g),l.windings.push(C)):l.windings[x]+=C}c.rings=null,c.windings=null,c.consumedBy=l,c.leftSE.consumedBy=l.leftSE,c.rightSE.consumedBy=l.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{const a=this.prev.consumedBy||this.prev;this._beforeState=a.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;const a=this.beforeState();this._afterState={rings:a.rings.slice(0),windings:a.windings.slice(0),multiPolys:[]};const l=this._afterState.rings,c=this._afterState.windings,o=this._afterState.multiPolys;for(let g=0,C=this.rings.length;g<C;g++){const x=this.rings[g],w=this.windings[g],N=l.indexOf(x);N===-1?(l.push(x),c.push(w)):c[N]+=w}const d=[],p=[];for(let g=0,C=l.length;g<C;g++){if(c[g]===0)continue;const x=l[g],w=x.poly;if(p.indexOf(w)===-1)if(x.isExterior)d.push(w);else{p.indexOf(w)===-1&&p.push(w);const N=d.indexOf(x.poly);N!==-1&&d.splice(N,1)}}for(let g=0,C=d.length;g<C;g++){const x=d[g].multiPoly;o.indexOf(x)===-1&&o.push(x)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;const a=this.beforeState().multiPolys,l=this.afterState().multiPolys;switch(Ei.type){case"union":{const c=a.length===0,o=l.length===0;this._isInResult=c!==o;break}case"intersection":{let c,o;a.length<l.length?(c=a.length,o=l.length):(c=l.length,o=a.length),this._isInResult=o===Ei.numMultiPolys&&c<o;break}case"xor":{const c=Math.abs(a.length-l.length);this._isInResult=c%2===1;break}case"difference":{const c=o=>o.length===1&&o[0].isSubject;this._isInResult=c(a)!==c(l);break}}return this._isInResult}},Ur=class{poly;isExterior;segments;bbox;constructor(u,a,l){if(!Array.isArray(u)||u.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=a,this.isExterior=l,this.segments=[],typeof u[0][0]!="number"||typeof u[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const c=yt.snap({x:new lt(u[0][0]),y:new lt(u[0][1])});this.bbox={ll:{x:c.x,y:c.y},ur:{x:c.x,y:c.y}};let o=c;for(let d=1,p=u.length;d<p;d++){if(typeof u[d][0]!="number"||typeof u[d][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const g=yt.snap({x:new lt(u[d][0]),y:new lt(u[d][1])});g.x.eq(o.x)&&g.y.eq(o.y)||(this.segments.push(qn.fromRing(o,g,this)),g.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=g.x),g.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=g.y),g.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=g.x),g.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=g.y),o=g)}(!c.x.eq(o.x)||!c.y.eq(o.y))&&this.segments.push(qn.fromRing(o,c,this))}getSweepEvents(){const u=[];for(let a=0,l=this.segments.length;a<l;a++){const c=this.segments[a];u.push(c.leftSE),u.push(c.rightSE)}return u}},Mo=class{multiPoly;exteriorRing;interiorRings;bbox;constructor(u,a){if(!Array.isArray(u))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new Ur(u[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let l=1,c=u.length;l<c;l++){const o=new Ur(u[l],this,!1);o.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=o.bbox.ll.x),o.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=o.bbox.ll.y),o.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=o.bbox.ur.x),o.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=o.bbox.ur.y),this.interiorRings.push(o)}this.multiPoly=a}getSweepEvents(){const u=this.exteriorRing.getSweepEvents();for(let a=0,l=this.interiorRings.length;a<l;a++){const c=this.interiorRings[a].getSweepEvents();for(let o=0,d=c.length;o<d;o++)u.push(c[o])}return u}},Xr=class{isSubject;polys;bbox;constructor(u,a){if(!Array.isArray(u))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof u[0][0][0]=="number"&&(u=[u])}catch{}this.polys=[],this.bbox={ll:{x:new lt(Number.POSITIVE_INFINITY),y:new lt(Number.POSITIVE_INFINITY)},ur:{x:new lt(Number.NEGATIVE_INFINITY),y:new lt(Number.NEGATIVE_INFINITY)}};for(let l=0,c=u.length;l<c;l++){const o=new Mo(u[l],this);o.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=o.bbox.ll.x),o.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=o.bbox.ll.y),o.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=o.bbox.ur.x),o.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=o.bbox.ur.y),this.polys.push(o)}this.isSubject=a}getSweepEvents(){const u=[];for(let a=0,l=this.polys.length;a<l;a++){const c=this.polys[a].getSweepEvents();for(let o=0,d=c.length;o<d;o++)u.push(c[o])}return u}},Po=(u,...a)=>Ei.run("union",u,a);yt.set;function ds(u,a={}){const l=[];if(ki(u,o=>{l.push(o.coordinates)}),l.length<2)throw new Error("Must have at least 2 geometries");const c=Po(l[0],...l.slice(1));return c.length===0?null:c.length===1?Ra(c[0],a.properties):ba(c,a.properties)}const De={mapInstance:null,mapInitialized:!1,geojsonData:null,deckOverlay:null,tooltipElement:null,tooltips:{}},vs=Re.createContext({mapInstance:null,setMapInstance:()=>{},mapInitialized:!1,setMapInitialized:()=>{},geojsonData:null,setGeojsonData:()=>{},deckOverlay:null,setDeckOverlay:()=>{},tooltipRef:{current:null},registerTooltip:()=>{},getTooltip:()=>null}),Ao=({children:u})=>{const[a,l]=Re.useState(De.mapInstance),[c,o]=Re.useState(De.mapInitialized),[d,p]=Re.useState(De.geojsonData),[g,C]=Re.useState(De.deckOverlay),x=Re.useRef(De.tooltipElement),w=V=>{De.mapInstance=V,l(V)},N=V=>{De.mapInitialized=V,o(V)},D=V=>{if(De.geojsonData=V,p(V),V&&Array.isArray(V.features)&&typeof window<"u")try{sessionStorage.setItem("bid-geojson-data",JSON.stringify(V))}catch(ee){console.warn("Error caching GeoJSON data:",ee)}},B=V=>{De.deckOverlay=V,C(V)},b=(V,ee)=>{V&&(console.log(`Registering tooltip for map: ${V}`),De.tooltips[V]=ee,V==="default-map"&&(De.tooltipElement=ee,x.current=ee),typeof window<"u"&&(window.mapTooltips||(window.mapTooltips={}),window.mapTooltips[V]=ee,window.getMapTooltip||(window.getMapTooltip=q=>{const U=`deck-tooltip-${q}`;return document.getElementById(U)})))},Z=V=>{if(typeof document<"u"){if(!document.getElementById(`map-container-${V}`))return console.log(`Map container for ${V} no longer exists, skipping tooltip retrieval`),null;const U=`deck-tooltip-${V}`,j=document.getElementById(U);if(j)return j}const ee=De.tooltips[V];return ee||(De.tooltipElement?De.tooltipElement:(typeof window<"u"&&console.warn(`No tooltip found for map: ${V}`),null))};return Re.useEffect(()=>{typeof window<"u"&&(window.BIDMapContext={getTooltip:Z,registerTooltip:b})},[]),Re.useEffect(()=>{if(!De.geojsonData&&typeof window<"u")try{const V=sessionStorage.getItem("bid-geojson-data");if(V){const ee=JSON.parse(V);ee&&Array.isArray(ee.features)&&(console.log("Using cached GeoJSON data"),De.geojsonData=ee,p(ee))}}catch(V){console.warn("Error retrieving cached GeoJSON:",V)}},[]),nt.jsx(vs.Provider,{value:{mapInstance:a,setMapInstance:w,mapInitialized:c,setMapInitialized:N,geojsonData:d,setGeojsonData:D,deckOverlay:g,setDeckOverlay:B,tooltipRef:x,registerTooltip:b,getTooltip:Z},children:u})},Do=()=>Re.useContext(vs);class Fo{constructor(){this.maps=new Map,this.overlays=new Map,this.destroyedMaps=new Set,this.setupCleanupHooks(),this.isScrolling=!1,this.scrollTimeout=null,this.lastCleanupTime=0,this.cleanupThrottleTime=1e3,this.inCleanupProcess=!1,this.isFullscreenActive=!1}setupCleanupHooks(){typeof window>"u"||(window.addEventListener("scroll",()=>{if(this.isFullscreenActive){console.log("Ignoring scroll event during fullscreen mode");return}this.isScrolling=!0,this.scrollTimeout&&clearTimeout(this.scrollTimeout),this.scrollTimeout=setTimeout(()=>{this.isScrolling=!1},250)},{passive:!0}),this.setupFullscreenObserver(),"navigation"in window&&window.navigation.addEventListener("navigate",a=>{if(this.isScrolling||this.inCleanupProcess){console.log("Ignoring navigation event during scrolling or cleanup");return}const l=window.location.pathname,c=new URL(a.destination.url).pathname;l!==c?(console.log(`Navigation detected from ${l} to ${c}, cleaning up maps`),this.safeCleanupAll()):console.log("Same-page navigation detected, skipping cleanup")}),window.addEventListener("beforeunload",()=>{if(this.isFullscreenActive){console.log("Page unloading during fullscreen, deferring cleanup");return}console.log("Page unloading, cleaning up maps"),this.safeCleanupAll()}),document.addEventListener("astro:before-swap",()=>{if(this.isFullscreenActive){console.log("Ignoring astro:before-swap event during fullscreen");return}if(this.isScrolling||this.inCleanupProcess){console.log("Ignoring astro:before-swap event during scrolling or cleanup");return}if(this.shouldThrottleCleanup()){console.log("Throttling map cleanup to prevent multiple rapid cleanups");return}console.log("Astro navigation: cleaning up maps"),this.safeCleanupAll()}),document.addEventListener("viewtransitionstart",()=>{if(this.isScrolling||this.inCleanupProcess){console.log("Ignoring view transition event during scrolling or cleanup");return}console.log("View transition starting: preparing maps"),this.prepareForTransition()}))}setupFullscreenObserver(){if(typeof MutationObserver<"u"){const a=new MutationObserver(l=>{for(const c of l)c.type==="attributes"&&c.attributeName==="class"&&(document.body.classList.contains("fullscreen-active")?(this.isFullscreenActive=!0,console.log("Fullscreen mode detected, pausing map cleanup")):this.isFullscreenActive&&(this.isFullscreenActive=!1,console.log("Fullscreen mode exited, resuming normal operation"),setTimeout(()=>{this.isFullscreenActive=!1},500)))});typeof document<"u"&&a.observe(document.body,{attributes:!0})}}shouldThrottleCleanup(){const a=Date.now();return a-this.lastCleanupTime<this.cleanupThrottleTime?!0:(this.lastCleanupTime=a,!1)}registerMap(a,l){return this.destroyedMaps.has(a)&&this.destroyedMaps.delete(a),this.maps.set(a,l),console.log(`Registered map: ${a}`),this}registerOverlay(a,l){return this.overlays.set(a,l),console.log(`Registered overlay: ${a}`),this}prepareForTransition(){document.querySelectorAll(".map-tooltip").forEach(a=>{a instanceof HTMLElement&&(a.style.display="none")})}safeCleanupAll(){if(this.isScrolling)return console.log("Ignoring cleanup request during scrolling"),!1;if(this.inCleanupProcess)return console.log("Already in cleanup process, ignoring duplicate request"),!1;if(this.isFullscreenActive)return console.log("Ignoring cleanup request during fullscreen mode"),!1;try{return this.inCleanupProcess=!0,this.cleanupAll()}catch(a){return console.error("Error in safeCleanupAll:",a),!1}finally{this.inCleanupProcess=!1}}cleanupMap(a){try{if(this.destroyedMaps.has(a))return console.log(`Map ${a} was already cleaned up, skipping`),!0;const l=this.maps.get(a),c=this.overlays.get(a);if(!l)return console.log(`No map found with ID: ${a}`),!1;if(console.log(`Cleaning up map: ${a}`),!l._container||!l.style)return console.warn(`Map ${a} appears to be in an invalid state, marking as destroyed`),this.destroyedMaps.add(a),this.maps.delete(a),this.overlays.delete(a),!0;if(c){try{l._controls&&l._controls.includes(c)&&(l.removeControl(c),console.log(`Removed overlay from map: ${a}`))}catch(p){console.warn(`Failed to remove overlay from map ${a}:`,p)}this.overlays.delete(a)}try{l.off()}catch(p){console.warn(`Failed to remove map event listeners for ${a}:`,p)}const o=document.getElementById(`map-container-${a}`),d=document.getElementById(`maplibre-map-${a}`);if(!o)console.log(`Map container for ${a} not found, skipping remove()`);else try{const p=l.getContainer();l._canvas&&l._canvas.parentNode?(l.remove(),console.log(`Map ${a} removed`)):console.warn(`Map ${a} has invalid internal state, cleaning up references only`)}catch(p){console.warn(`Failed to call remove() on map ${a}:`,p)}return this.destroyedMaps.add(a),this.maps.delete(a),!0}catch(l){return console.error(`Error cleaning up map ${a}:`,l),this.destroyedMaps.add(a),this.maps.delete(a),this.overlays.delete(a),!1}}cleanupAll(){let a=!0;const l=Array.from(this.maps.keys());for(const c of l){const o=this.cleanupMap(c);a=a&&o}return a}}const Sn=new Fo;function ps(u){if(!u||!Array.isArray(u.features))return console.error("Invalid GeoJSON data structure"),[];const a={};u.features.forEach(c=>{if(!c||!c.properties)return;const o=c.properties.F_ALL_BI_2;o&&(a[o]||(a[o]=[]),a[o].push(c))});const l=[];return Object.entries(a).forEach(([c,o])=>{try{if(!o||o.length===0)return;if(!o[0]||!o[0].geometry){console.warn(`Invalid feature for BID ${c}`);return}const d=o.filter(x=>x&&x.geometry);if(d.length===0)return;const p=d.map(x=>{try{return os(x,.015,{units:"kilometers"})}catch(w){return console.warn(`Error buffering feature for BID ${c}:`,w),null}}).filter(Boolean);if(p.length===0)return;let g=p[0];for(let x=1;x<p.length;x++)try{g=ds(g,p[x])}catch(w){console.warn(`Error unioning features for BID ${c}:`,w)}if(!g||!g.geometry)return;let C;try{if(g.geometry.type==="Polygon"){const x=g.geometry.coordinates[0];if(!Array.isArray(x))return;C=pr(x)}else if(g.geometry.type==="MultiPolygon"){const x=g.geometry.coordinates.filter(N=>Array.isArray(N)&&N.length>0&&Array.isArray(N[0]));if(x.length===0)return;const w=x.map(N=>pr(N[0]));C=Oa(w.map(N=>N.geometry.coordinates))}else return;C.properties={bidName:c},l.push(C)}catch(x){console.error(`Error creating perimeter for BID ${c}:`,x)}}catch(d){console.error(`Error processing perimeter for BID ${c}:`,d)}}),l}function _s(u){if(!u||!Array.isArray(u.features))return[];const a={};u.features.forEach(c=>{const o=c.properties?.F_ALL_BI_2;o&&(a[o]||(a[o]=[]),a[o].push(c))});const l=[];return Object.entries(a).forEach(([c,o])=>{try{const d=o.map(g=>os(g,.015,{units:"kilometers"}));let p=d[0];for(let g=1;g<d.length;g++)p=ds(p,d[g]);p.properties={bidName:c},l.push(p)}catch(d){console.error(`Error processing polygon for BID ${c}:`,d)}}),l}function Vr(u){let a=1/0,l=1/0,c=-1/0,o=-1/0;const d=p=>{Array.isArray(p[0])&&typeof p[0][0]!="number"?p.forEach(d):Array.isArray(p[0])&&p.forEach(g=>{a=Math.min(a,g[0]),c=Math.max(c,g[0]),l=Math.min(l,g[1]),o=Math.max(o,g[1])})};return d(u.geometry.coordinates),{minLng:a,minLat:l,maxLng:c,maxLat:o}}class Go{constructor(){this.handlers={},this.setupGlobalHandler()}setupGlobalHandler(){typeof window<"u"&&window.removeEventListener("map-navigate-to-bid",this._navigationHandler),this._navigationHandler=a=>{const{mapId:l,bidName:c}=a.detail||{};if(l&&typeof document<"u"&&!document.getElementById(`map-container-${l}`)){console.log(`MapEventManager: Ignoring event for non-existent map: ${l}`);return}l&&c&&this.handlers[l]?(console.log(`MapEventManager: Navigation to BID ${c} on map ${l}`),this.handlers[l](c)):(l||console.warn("MapEventManager: Missing mapId in event"),c||console.warn("MapEventManager: Missing bidName in event"),l&&!this.handlers[l]&&console.warn(`MapEventManager: No handler for ${l}`))},typeof window<"u"&&(window.addEventListener("map-navigate-to-bid",this._navigationHandler),window.MapEventManager=this,document.addEventListener("DOMContentLoaded",()=>{console.log("MapEventManager: Ready to handle map navigation events"),this._isReady=!0}))}registerNavigationHandler(a,l){return typeof l=="function"?(this.handlers[a]=l,console.log(`MapEventManager: Registered handler for ${a}`),!0):!1}unregisterHandler(a){return this.handlers[a]?(delete this.handlers[a],!0):!1}navigateToBid(a,l){if(typeof window<"u"){console.log(`MapEventManager: Manually triggering navigation to ${l} on ${a}`);const c=new CustomEvent("map-navigate-to-bid",{detail:{mapId:a,bidName:l}});return window.dispatchEvent(c),!0}return!1}navigateToBidProject(a,l){if(!a||!l||!l[a])return console.warn(`MapEventManager: Cannot navigate to BID project: missing slug for ${a}`),!1;try{const c=l[a],d=(()=>{if(typeof import.meta<"u")return"/";if(typeof document<"u"){const p=document.querySelector("base");if(p&&p.href)try{const x=new URL(p.href).pathname.split("/").filter(Boolean);if(x.length>0)return`/${x.join("/")}`}catch(C){console.warn("Error parsing base URL:",C)}const g=document.querySelector("script[data-astro-repo-base]");if(g&&g.dataset.astroRepoBase)return g.dataset.astroRepoBase}return"/"})();return console.log(`MapEventManager: Navigating to BID project ${a} (${c}) at ${d}/projects/${c}`),window.location.href=`${d}/projects/${c}`,!0}catch(c){return console.error(`MapEventManager: Error navigating to BID project ${a}:`,c),!1}}}const $r=new Go;function $o({projectBids:u=[],focusBid:a=null,height:l="500px",initialZoom:c=14,mapId:o="default-map",bidToSlugMap:d={}}){const p=Re.useRef(c),[g,C]=Re.useState(!0),x=Z=>{p.current=Z},w=`map-container-${o}`,N=`maplibre-map-${o}`,D=`deck-tooltip-${o}`,B=o==="home-page-map"?"55vh":l,b=()=>{setTimeout(()=>{C(!1)},300)};return nt.jsx(Ao,{children:nt.jsxs("div",{className:"relative",children:[nt.jsx("div",{className:`absolute inset-0 bg-card rounded-lg border flex items-center justify-center z-10 transition-opacity duration-500 ${g?"opacity-100":"opacity-0 pointer-events-none"}`,style:{height:B},"aria-hidden":!g,children:nt.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[nt.jsx("div",{className:"w-10 h-10 border-4 border-primary/30 border-t-primary rounded-full animate-spin"}),nt.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading map visualization..."})]})}),nt.jsx("div",{id:w,className:`w-full bg-card rounded-lg border relative transition-opacity duration-500 ${g?"opacity-0":"opacity-100"}`,style:{height:B}}),nt.jsxs("p",{className:`text-center text-sm text-muted-foreground ${o==="home-page-map"?"mt-2":"mt-4"} ${g?"opacity-0":"opacity-100"} transition-opacity duration-500`,children:["Interactive map of NYC Business Improvement Districts",a&&nt.jsxs("span",{className:"font-medium",children:["  Focused on: ",a]})]}),nt.jsx(qo,{projectBids:u,focusBid:a,initialZoom:c,onZoomChange:x,mapId:o,mapContainerId:w,mapLibreId:N,tooltipId:D,bidToSlugMap:d,onMapLoaded:b})]})})}function qo({projectBids:u,focusBid:a,initialZoom:l,onZoomChange:c,mapId:o,mapContainerId:d,mapLibreId:p,tooltipId:g,bidToSlugMap:C,onMapLoaded:x}){if(typeof window>"u")return null;const{mapInstance:w,setMapInstance:N,mapInitialized:D,setMapInitialized:B,geojsonData:b,setGeojsonData:Z,deckOverlay:V,setDeckOverlay:ee,tooltipRef:q,registerTooltip:U,getTooltip:j}=Do(),W=Re.useRef(!0),K=Re.useRef(!1),ie=Re.useRef(!1),y=Re.useRef(null),v=Re.useRef(null),E=Re.useRef(!1);return Re.useEffect(()=>{window.mapFunctions=window.mapFunctions||{},window.mapFunctions[o]={};const A=(S,k)=>{try{if(!S||!y.current)return;console.log(`Navigation requested to BID: ${S} on map: ${o}`),ie.current=!0,typeof document<"u"&&v.current&&(document.body.classList.add("map-navigating"),setTimeout(()=>{document.body.classList.remove("map-navigating"),ie.current=!1},1500)),!b&&typeof window<"u"?(console.log("GeoJSON data not loaded yet, attempting to load"),fetch("/data/bids.geojson").then(L=>{if(!L.ok)throw new Error(`Failed to fetch: ${L.status}`);return L.json()}).then(L=>{Z(L),T(L,S,k)}).catch(L=>console.error("Error loading BID data:",L))):T(b,S,k)}catch(L){console.error("Error handling BID navigation:",L),ie.current=!1}},T=(S,k,L)=>{if(!S||!k||!y.current)return;const O=S.features.find(R=>R.properties?.F_ALL_BI_2===k);if(O&&O.geometry){const R=Vr(O);let Y=14;if(L?.dynamicZoom===!0){const X=Math.abs(R.maxLat-R.minLat),te=Math.abs(R.maxLng-R.minLng);Math.max(X,te)>.03?Y=13:Math.max(X,te)>.015?Y=14:Y=15,console.log(`Calculated dynamic zoom for ${k}: ${Y}`)}y.current.flyTo({center:[(R.minLng+R.maxLng)/2,(R.minLat+R.maxLat)/2],zoom:Y,duration:1500,essential:!0,curve:1.5,easing(X){return X<.5?4*X*X*X:1-Math.pow(-2*X+2,3)/2},animate:!0}),typeof window<"u"&&window.dispatchEvent(new CustomEvent("map-navigation-started",{detail:{bidName:k,mapId:o}})),o==="home-page-map"&&setTimeout(()=>{const X=`.map-nav-pill[data-bid="${k}"]`,te=document.querySelector(X);te&&(document.querySelectorAll(".map-nav-pill").forEach(oe=>oe.classList.remove("active")),te.classList.add("active"))},0)}},M=$r.registerNavigationHandler(o,A);return console.log(`Registered navigation handler for map: ${o}, success: ${M}`),window.addEventListener("map-navigate-to-bid",S=>{S.detail?.mapId===o&&A(S.detail.bidName,{dynamicZoom:S.detail.dynamicZoom===!0})}),()=>{window.mapFunctions&&window.mapFunctions[o]&&delete window.mapFunctions[o],$r.unregisterHandler(o),console.log(`Unregistered navigation handler for map: ${o}`)}},[o,g,u]),Re.useEffect(()=>()=>{y.current&&Sn.registerMap(o,y.current),v.current&&Sn.registerOverlay(o,v.current)},[o]),Re.useEffect(()=>((async()=>{try{const{GeoJsonLayer:T}=await vn(async()=>{const{GeoJsonLayer:X}=await import("./index.BnauiKoP.js");return{GeoJsonLayer:X}},__vite__mapDeps([0,1,2])),{MapboxOverlay:M}=await vn(async()=>{const{MapboxOverlay:X}=await import("./index.Bg-cVQ5Q.js");return{MapboxOverlay:X}},__vite__mapDeps([3,1])),{default:S}=await vn(async()=>{const{default:X}=await import("./maplibre-gl.BIyHGNM8.js").then(te=>te.m);return{default:X}},__vite__mapDeps([4,2]));if(!W.current)return;const k=document.getElementById(d);if(!k){console.error(`Map container not found: ${d}`);return}let L=null;try{const X=`map-state-${o}`;if(typeof sessionStorage<"u"){const te=sessionStorage.getItem(X);te&&(L=JSON.parse(te),console.log(`Restored map state for ${o}`,L))}}catch(X){console.warn("Error accessing sessionStorage:",X)}let O=document.getElementById(g);O||(O=document.createElement("div"),O.id=g,O.style.display="none",O.style.position="absolute",O.style.zIndex="1000",O.style.pointerEvents="none",k.appendChild(O),U(o,O),q&&!q.current&&(q.current=O),O.classList.add("map-tooltip"),O.setAttribute("data-map-id",o));let R=L?.viewState||{latitude:40.7128,longitude:-74.006,zoom:l,pitch:0,bearing:0},Y=b;if(!Y){const X=await fetch("/data/bids.geojson");if(!X.ok)throw new Error(`Failed to fetch GeoJSON: ${X.status} ${X.statusText}`);Y=await X.json(),Z(Y)}if(a&&Y){const X=Y.features.find(te=>te.properties?.F_ALL_BI_2===a);if(X&&X.geometry&&(X.geometry.type==="Polygon"||X.geometry.type==="MultiPolygon")){const te=Vr(X);R={...R,latitude:(te.maxLat+te.minLat)/2,longitude:(te.maxLng+te.minLng)/2,zoom:l}}}let z=y.current;if(z){if(z.loaded()&&(z.flyTo({center:[R.longitude,R.latitude],zoom:z.getZoom(),duration:1e3,curve:1.5,easing(X){return X<.5?4*X*X*X:1-Math.pow(-2*X+2,3)/2}}),v.current&&Y)){const{GeoJsonLayer:X}=await vn(async()=>{const{GeoJsonLayer:te}=await import("./index.BnauiKoP.js");return{GeoJsonLayer:te}},__vite__mapDeps([0,1,2]));zo(v.current,Y,u,a,X,O,o,g,C)}}else{for(;k.firstChild;)k.removeChild(k.firstChild);const X=document.createElement("div");X.id=p,X.style.width="100%",X.style.height="100%",X.style.borderRadius="0.5rem",k.appendChild(X),k.appendChild(O),z=new S.Map({container:p,style:"https://basemaps.cartocdn.com/gl/positron-gl-style/style.json",center:[R.longitude,R.latitude],zoom:R.zoom,bearing:R.bearing,pitch:R.pitch,minZoom:9,renderWorldCopies:!1,fadeDuration:0}),y.current=z,o==="default-map"&&N(z),Sn.registerMap(o,z),z.on("movestart",()=>{K.current=!0,O&&(O.style.display="none")}),z.on("moveend",()=>{if(K.current=!1,z){const oe=z.getZoom();c(oe);try{if(typeof sessionStorage<"u"){const ne=z.getCenter(),ce={viewState:{latitude:ne.lat,longitude:ne.lng,zoom:oe,pitch:z.getPitch(),bearing:z.getBearing()},timestamp:Date.now()};sessionStorage.setItem(`map-state-${o}`,JSON.stringify(ce))}}catch(ne){console.warn("Error saving map state:",ne)}}}),z.on("load",()=>{E.current=!0,x&&typeof x=="function"&&x(),typeof window<"u"&&window.dispatchEvent(new CustomEvent("map-loaded",{detail:{mapId:o}}))});const te=oe=>{oe.detail?.mapId===o&&oe.detail?.zoom&&z&&z.flyTo({center:[R.longitude,R.latitude],zoom:oe.detail.zoom,duration:1500,curve:1.5,easing(ne){return ne<.5?4*ne*ne*ne:1-Math.pow(-2*ne+2,3)/2}})};window.addEventListener("map-zoom-request",te),z.on("style.load",()=>{Y&&(o==="default-map"&&B(!0),Bo(z,Y,u,a,M,T,O,oe=>{v.current=oe,o==="default-map"&&ee(oe)},o,g,C),v.current&&Sn.registerOverlay(o,v.current))})}}catch(T){console.error("Error initializing Deck.gl map:",T)}})(),()=>{if(y.current)try{if(v.current){try{y.current.removeControl(v.current)}catch(M){console.warn(`Error removing deck overlay for map ${o}:`,M)}v.current=null}const T=y.current;T.off(),document.getElementById(d)&&T.remove(),y.current=null}catch(T){console.warn(`Error cleaning up map ${o}:`,T)}}),[u,a,d,p,g,o]),null}async function Bo(u,a,l,c,o,d,p,g,C,x,w){try{if(!u||!a){console.error("Missing required parameters for setupMapLayers");return}if(typeof document<"u"&&!document.getElementById(`map-container-${C}`)){console.log(`Map container for ${C} no longer exists, aborting layer setup`);return}const N=u.getStyle();if(!N||!N.layers){console.error("Map style or layers not available");return}const B=N.layers.find(U=>U&&(U.type==="symbol"||U.id&&(U.id.includes("label")||U.id.includes("place"))))?.id;if(!Array.isArray(a.features)){console.error("Invalid geojsonData structure - features array missing");return}let b,Z;try{b=ps(a),Z=_s(a)}catch(U){console.error("Error processing BID geometries:",U),b=[],Z=[]}(!b||!Z||b.length===0||Z.length===0)&&(console.warn("Failed to process BID geometries or empty results"),b=b||[],Z=Z||[]);const V=`${C}-${Date.now()}-`,ee=[];if(a.features.length>0&&ee.push(new d({id:`${V}bid-layer`,data:a,pickable:!1,stroked:!0,filled:!0,extruded:!1,beforeId:B,getFillColor:U=>{const j=U.properties?.F_ALL_BI_2,W=j&&l.includes(j);return j&&c===j?[5,150,105,180]:W?[16,185,129,150]:[59,130,246,150]},getLineColor:[0,0,0,0],getLineWidth:0,parameters:{depthTest:!1,zIndex:1},updateTriggers:{getFillColor:[l.join(","),c]},transitions:{getFillColor:{duration:300,easing:U=>U*(2-U)}}})),b.length>0&&ee.push(new d({id:`${V}bid-perimeter-layer`,data:b,pickable:!1,stroked:!1,filled:!1,lineWidthUnits:"pixels",getLineColor:U=>{const j=U.properties?.bidName,W=j&&l.includes(j);return j&&c===j?[4,120,87,255]:W?[16,185,129,255]:[30,64,175,255]},getLineWidth:U=>{const j=U.properties?.bidName,W=j&&l.includes(j);return j&&c===j?4:W?3:2},parameters:{depthTest:!1,zIndex:2},updateTriggers:{getLineColor:[l.join(","),c],getLineWidth:[l.join(","),c]},transitions:{getLineColor:{duration:500,easing:U=>U*(2-U)},getLineWidth:{duration:300,easing:U=>U*(2-U)}}})),Z.length>0&&ee.push(new d({id:`${V}bid-interaction-layer`,data:Z,pickable:!0,stroked:!1,filled:!0,getFillColor:[0,0,0,0],parameters:{depthTest:!1,zIndex:3}})),ee.length===0){console.warn("No valid layers to render");return}const q=new o({interleaved:!0,layers:ee,onError:U=>{console.error(`Deck.gl error in map ${C}:`,U)},onClick:U=>{if(!U||!U.object)return;const j=U.object.properties?.bidName;if(!j)return;const W=l.includes(j);if(typeof document<"u"&&(document.body.classList.add("map-interaction"),setTimeout(()=>{document.body.classList.remove("map-interaction")},500)),W&&w&&w[j]){const K=w[j];window.location.href=`/projects/${K}`}},onHover:U=>{if(!document.getElementById(x))return;if(!U||!U.object||!p){p&&(p.style.display="none");return}const j=U.object.properties?.bidName;if(!j){p.style.display="none";return}const W=l.includes(j);p.style.display="block",p.style.left=`${U.x}px`,p.style.top=`${U.y}px`,p.style.transform="translate(-50%, -100%) translateY(-10px)",p.style.marginTop="-10px",p.style.opacity="0",p.style.transition="transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1), opacity 0.3s ease-out",requestAnimationFrame(()=>{p.style.opacity="1",p.style.transform="translate(-50%, -100%) translateY(0)"}),p.innerHTML=`
          <div class="tooltip-content" style="
            font-family: system-ui, sans-serif; 
            padding: 10px 14px; 
            background: white; 
            border-radius: 8px; 
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border: ${W?"1px solid rgba(16, 185, 129, 0.2)":"1px solid rgba(0,0,0,0.05)"};
            transition: all 0.2s ease;
          ">
            <strong>${j}</strong>
            ${W?`<p style="
                color: #10B981; 
                margin-top: 4px; 
                margin-bottom: 0;
                display: flex;
                align-items: center;
              ">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" style="width: 14px; height: 14px; margin-right: 4px;">
                  <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z" clip-rule="evenodd" />
                </svg>
                Has project analysis
                ${w&&w[j]?'<span style="font-size: 12px; margin-left: 4px; opacity: 0.8;">(click to view)</span>':""}
              </p>`:`<p style="
                color: #6B7280; 
                margin-top: 4px; 
                margin-bottom: 0;
                display: flex;
                align-items: center;
              ">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" style="width: 14px; height: 14px; margin-right: 4px; opacity: 0.5;">
                  <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.28 7.22a.75.75 0 00-1.06 1.06L8.94 10l-1.72 1.72a.75.75 0 101.06 1.06L10 11.06l1.72 1.72a.75.75 0 101.06-1.06L11.06 10l1.72-1.72a.75.75 0 00-1.06-1.06L10 8.94 8.28 7.22z" clip-rule="evenodd" />
                </svg>
                No analysis yet
              </p>`}
          </div>
        `},onMouseLeave:()=>{document.getElementById(x)&&p&&(p.style.opacity="0",p.style.transform="translate(-50%, -100%) translateY(-5px)",setTimeout(()=>{p&&(p.style.display="none")},200))}});g(q),q._createdAt=Date.now(),q._mapId=C;try{if(typeof document<"u"&&!document.getElementById(`maplibre-map-${C}`)){console.warn(`Map element ${C} no longer exists, skipping overlay`);return}u.addControl(q),console.log(`Created ${ee.length} layers for map ${C}`)}catch(U){console.error("Error adding deck overlay to map:",U)}}catch(N){console.error("Error setting up map layers:",N)}}function zo(u,a,l,c,o,d,p,g,C){try{if(typeof document<"u"&&!document.getElementById(`map-container-${p}`)){console.log(`Map container for ${p} no longer exists, aborting update`);return}if(!u||!a||!Array.isArray(a.features)){console.error("Invalid params for updateMapLayers");return}let x,w;try{x=ps(a),w=_s(a)}catch(B){console.error("Error processing BID geometries for update:",B),x=[],w=[]}(!x||!w||x.length===0||w.length===0)&&(console.warn("Failed to process BID geometries for update or empty results"),x=x||[],w=w||[]);const N=`${p}-${Date.now()}-`,D=[];if(a.features.length>0&&D.push(new o({id:`${N}bid-layer`,data:a,pickable:!1,stroked:!0,filled:!0,extruded:!1,getFillColor:B=>{const b=B.properties?.F_ALL_BI_2,Z=b&&l.includes(b);return b&&c===b?[5,150,105,180]:Z?[16,185,129,150]:[59,130,246,150]},getLineColor:[0,0,0,0],getLineWidth:0,parameters:{depthTest:!1,zIndex:1},updateTriggers:{getFillColor:[l.join(","),c]}})),x.length>0&&D.push(new o({id:`${N}bid-perimeter-layer`,data:x,pickable:!1,stroked:!1,filled:!1,lineWidthUnits:"pixels",getLineColor:B=>{const b=B.properties?.bidName,Z=b&&l.includes(b);return b&&c===b?[4,120,87,255]:Z?[16,185,129,255]:[30,64,175,255]},getLineWidth:B=>{const b=B.properties?.bidName,Z=b&&l.includes(b);return b&&c===b?4:Z?3:2},parameters:{depthTest:!1,zIndex:2},updateTriggers:{getLineColor:[l.join(","),c],getLineWidth:[l.join(","),c]}})),w.length>0&&D.push(new o({id:`${N}bid-interaction-layer`,data:w,pickable:!0,stroked:!1,filled:!0,getFillColor:[0,0,0,0],parameters:{depthTest:!1,zIndex:3}})),D.length===0){console.warn("No valid layers to update");return}try{if(!u._mapId||u._mapId!==p){console.warn("Overlay appears to be stale or from different map, aborting update");return}u.setProps({layers:D,onError:B=>{console.error(`Deck.gl error in map ${p}:`,B)},onClick:B=>{if(!B||!B.object)return;const b=B.object.properties?.bidName;if(!b)return;if(l.includes(b)&&C&&C[b]){const V=C[b];window.location.href=`/projects/${V}`}},onHover:B=>{if(!document.getElementById(g))return;if(!B||!B.object||!d){d&&(d.style.display="none");return}const b=B.object.properties?.bidName;if(!b){d.style.display="none";return}const Z=l.includes(b);d.style.display="block",d.style.left=`${B.x}px`,d.style.top=`${B.y}px`,d.style.transform="translate(-50%, -100%)",d.style.marginTop="-20px",d.style.opacity="1",d.style.transition="transform 0.2s ease-out, opacity 0.2s ease-out",d.innerHTML=`
            <div class="tooltip-content" style="font-family: system-ui, sans-serif; padding: 8px; background: white; border-radius: 4px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
              <strong>${b}</strong>
              ${Z?`<p style="color: #10B981; margin-top: 4px; margin-bottom: 0;">
                  Has project analysis
                  ${C&&C[b]?'<span style="font-size: 12px; margin-left: 4px;">(click to view)</span>':""}
                </p>`:'<p style="color: #6B7280; margin-top: 4px; margin-bottom: 0;">No analysis yet</p>'}
            </div>
          `},onMouseLeave:()=>{document.getElementById(g)&&d&&(d.style.display="none")}}),console.log(`Updated ${D.length} layers for map ${p}`)}catch(B){console.error("Error updating deck overlay props:",B)}}catch(x){console.error("Error updating map layers:",x)}}export{$o as default};
